THREE={},THREE.Math={clamp:function(E,n,t){return E>t?t:E<n?n:E}};
THREE.Vector3=function(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(){var t;return function(i){return i instanceof THREE.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromEuler(i))}}(),applyAxisAngle:function(){var t;return function(i,s){return void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromAxisAngle(i,s))}}(),applyMatrix3:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[3]*s+r[6]*n,this.y=r[1]*i+r[4]*s+r[7]*n,this.z=r[2]*i+r[5]*s+r[8]*n,this},applyMatrix4:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n+r[12],this.y=r[1]*i+r[5]*s+r[9]*n+r[13],this.z=r[2]*i+r[6]*s+r[10]*n+r[14],this},applyProjection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements,h=1/(r[3]*i+r[7]*s+r[11]*n+r[15]);return this.x=(r[0]*i+r[4]*s+r[8]*n+r[12])*h,this.y=(r[1]*i+r[5]*s+r[9]*n+r[13])*h,this.z=(r[2]*i+r[6]*s+r[10]*n+r[14])*h,this},applyQuaternion:function(t){var i=this.x,s=this.y,n=this.z,r=t.x,h=t.y,e=t.z,o=t.w,a=o*i+h*n-e*s,u=o*s+e*i-r*n,c=o*n+r*s-h*i,y=-r*i-h*s-e*n;return this.x=a*o+y*-r+u*-e-c*-h,this.y=u*o+y*-h+c*-r-a*-e,this.z=c*o+y*-e+a*-h-u*-r,this},project:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.projectionMatrix,t.getInverse(i.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.matrixWorld,t.getInverse(i.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n,this.y=r[1]*i+r[5]*s+r[9]*n,this.z=r[2]*i+r[6]*s+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(){var t,i;return function(s,n){return void 0===t&&(t=new THREE.Vector3,i=new THREE.Vector3),t.set(s,s,s),i.set(n,n,n),this.clamp(t,i)}}(),clampLength:function(t,i){var s=this.length();return this.multiplyScalar(Math.max(t,Math.min(i,s))/s)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t)},cross:function(t,i){if(void 0!==i)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i);var s=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-s*t.z,this.z=s*t.y-n*t.x,this},crossVectors:function(t,i){var s=t.x,n=t.y,r=t.z,h=i.x,e=i.y,o=i.z;return this.x=n*o-r*e,this.y=r*h-s*o,this.z=s*e-n*h,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),t.copy(this).projectOnVector(i),this.sub(t)}}(),reflect:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),this.sub(t.copy(i).multiplyScalar(2*this.dot(i)))}}(),angleTo:function(t){var i=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(THREE.Math.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y,n=this.z-t.z;return i*i+s*s+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var i=Math.sin(t.phi)*t.radius;return this.x=i*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=i*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=s,this.z=n,this},setFromMatrixColumn:function(t,i){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var s=t;t=i,i=s}return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromAttribute:function(t,i,s){return void 0===s&&(s=0),i=i*t.itemSize+s,this.x=t.array[i],this.y=t.array[i+1],this.z=t.array[i+2],this}};
THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,r,n,i,s,o,a,u,l,h,c,m,f,v,y){var E=this.elements;return E[0]=t,E[4]=e,E[8]=r,E[12]=n,E[1]=i,E[5]=s,E[9]=o,E[13]=a,E[2]=u,E[6]=l,E[10]=h,E[14]=c,E[3]=m,E[7]=f,E[11]=v,E[15]=y,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},extractBasis:function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new THREE.Vector3);var r=this.elements,n=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),s=1/t.setFromMatrixColumn(e,1).length(),o=1/t.setFromMatrixColumn(e,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*s,r[5]=n[5]*s,r[6]=n[6]*s,r[8]=n[8]*o,r[9]=n[9]*o,r[10]=n[10]*o,this}}(),makeRotationFromEuler:function(t){t instanceof THREE.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,r=t.x,n=t.y,i=t.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(n),u=Math.sin(n),l=Math.cos(i),h=Math.sin(i);if("XYZ"===t.order){var c=s*l,m=s*h,f=o*l,v=o*h;e[0]=a*l,e[4]=-a*h,e[8]=u,e[1]=m+f*u,e[5]=c-v*u,e[9]=-o*a,e[2]=v-c*u,e[6]=f+m*u,e[10]=s*a}else if("YXZ"===t.order){var y=a*l,E=a*h,M=u*l,x=u*h;e[0]=y+x*o,e[4]=M*o-E,e[8]=s*u,e[1]=s*h,e[5]=s*l,e[9]=-o,e[2]=E*o-M,e[6]=x+y*o,e[10]=s*a}else if("ZXY"===t.order){var y=a*l,E=a*h,M=u*l,x=u*h;e[0]=y-x*o,e[4]=-s*h,e[8]=M+E*o,e[1]=E+M*o,e[5]=s*l,e[9]=x-y*o,e[2]=-s*u,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){var c=s*l,m=s*h,f=o*l,v=o*h;e[0]=a*l,e[4]=f*u-m,e[8]=c*u+v,e[1]=a*h,e[5]=v*u+c,e[9]=m*u-f,e[2]=-u,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){var d=s*a,p=s*u,R=o*a,T=o*u;e[0]=a*l,e[4]=T-d*h,e[8]=R*h+p,e[1]=h,e[5]=s*l,e[9]=-o*l,e[2]=-u*l,e[6]=p*h+R,e[10]=d-T*h}else if("XZY"===t.order){var d=s*a,p=s*u,R=o*a,T=o*u;e[0]=a*l,e[4]=-h,e[8]=u*l,e[1]=d*h+T,e[5]=s*l,e[9]=p*h-R,e[2]=R*h-p,e[6]=o*l,e[10]=T*h+d}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,s=t.w,o=r+r,a=n+n,u=i+i,l=r*o,h=r*a,c=r*u,m=n*a,f=n*u,v=i*u,y=s*o,E=s*a,M=s*u;return e[0]=1-(m+v),e[4]=h-M,e[8]=c+E,e[1]=h+M,e[5]=1-(l+v),e[9]=f-y,e[2]=c-E,e[6]=f+y,e[10]=1-(l+m),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t,e,r;return function(n,i,s){void 0===t&&(t=new THREE.Vector3,e=new THREE.Vector3,r=new THREE.Vector3);var o=this.elements;return r.subVectors(n,i).normalize(),0===r.lengthSq()&&(r.z=1),t.crossVectors(s,r).normalize(),0===t.lengthSq()&&(r.z+=1e-4,t.crossVectors(s,r).normalize()),e.crossVectors(r,t),o[0]=t.x,o[4]=e.x,o[8]=r.x,o[1]=t.y,o[5]=e.y,o[9]=r.y,o[2]=t.z,o[6]=e.z,o[10]=r.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,s=r[0],o=r[4],a=r[8],u=r[12],l=r[1],h=r[5],c=r[9],m=r[13],f=r[2],v=r[6],y=r[10],E=r[14],M=r[3],x=r[7],d=r[11],p=r[15],R=n[0],T=n[4],g=n[8],z=n[12],H=n[1],w=n[5],k=n[9],A=n[13],F=n[2],V=n[6],X=n[10],Y=n[14],Z=n[3],C=n[7],P=n[11],S=n[15];return i[0]=s*R+o*H+a*F+u*Z,i[4]=s*T+o*w+a*V+u*C,i[8]=s*g+o*k+a*X+u*P,i[12]=s*z+o*A+a*Y+u*S,i[1]=l*R+h*H+c*F+m*Z,i[5]=l*T+h*w+c*V+m*C,i[9]=l*g+h*k+c*X+m*P,i[13]=l*z+h*A+c*Y+m*S,i[2]=f*R+v*H+y*F+E*Z,i[6]=f*T+v*w+y*V+E*C,i[10]=f*g+v*k+y*X+E*P,i[14]=f*z+v*A+y*Y+E*S,i[3]=M*R+x*H+d*F+p*Z,i[7]=M*T+x*w+d*V+p*C,i[11]=M*g+x*k+d*X+p*P,i[15]=M*z+x*A+d*Y+p*S,this},multiplyToArray:function(t,e,r){var n=this.elements;return this.multiplyMatrices(t,e),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,r,n){void 0===t&&(t=new THREE.Vector3),void 0===r&&(r=0),void 0===n&&(n=e.length);for(var i=0,s=r;i<n;i+=3,s+=3)t.fromArray(e,s),t.applyMatrix4(this),t.toArray(e,s);return e}}(),applyToBuffer:function(){var t;return function(e,r,n){void 0===t&&(t=new THREE.Vector3),void 0===r&&(r=0),void 0===n&&(n=e.length/e.itemSize);for(var i=0,s=r;i<n;i++,s++)t.x=e.getX(s),t.y=e.getY(s),t.z=e.getZ(s),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],s=t[1],o=t[5],a=t[9],u=t[13],l=t[2],h=t[6],c=t[10],m=t[14],f=t[3],v=t[7],y=t[11],E=t[15];return f*(+i*a*h-n*u*h-i*o*c+r*u*c+n*o*m-r*a*m)+v*(+e*a*m-e*u*c+i*s*c-n*s*m+n*u*l-i*a*l)+y*(+e*u*h-e*o*m-i*s*h+r*s*m+i*o*l-r*u*l)+E*(-n*o*l-e*a*h+e*o*c+n*s*h-r*s*c+r*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new THREE.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var r=this.elements,n=t.elements,i=n[0],s=n[1],o=n[2],a=n[3],u=n[4],l=n[5],h=n[6],c=n[7],m=n[8],f=n[9],v=n[10],y=n[11],E=n[12],M=n[13],x=n[14],d=n[15],p=f*x*c-M*v*c+M*h*y-l*x*y-f*h*d+l*v*d,R=E*v*c-m*x*c-E*h*y+u*x*y+m*h*d-u*v*d,T=m*M*c-E*f*c+E*l*y-u*M*y-m*l*d+u*f*d,g=E*f*h-m*M*h-E*l*v+u*M*v+m*l*x-u*f*x,z=i*p+s*R+o*T+a*g;if(0===z){var H="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(H);return console.warn(H),this.identity()}var w=1/z;return r[0]=p*w,r[1]=(M*v*a-f*x*a-M*o*y+s*x*y+f*o*d-s*v*d)*w,r[2]=(l*x*a-M*h*a+M*o*c-s*x*c-l*o*d+s*h*d)*w,r[3]=(f*h*a-l*v*a-f*o*c+s*v*c+l*o*y-s*h*y)*w,r[4]=R*w,r[5]=(m*x*a-E*v*a+E*o*y-i*x*y-m*o*d+i*v*d)*w,r[6]=(E*h*a-u*x*a-E*o*c+i*x*c+u*o*d-i*h*d)*w,r[7]=(u*v*a-m*h*a+m*o*c-i*v*c-u*o*y+i*h*y)*w,r[8]=T*w,r[9]=(E*f*a-m*M*a-E*s*y+i*M*y+m*s*d-i*f*d)*w,r[10]=(u*M*a-E*l*a+E*s*c-i*M*c-u*s*d+i*l*d)*w,r[11]=(m*l*a-u*f*a-m*s*c+i*f*c+u*s*y-i*l*y)*w,r[12]=g*w,r[13]=(m*M*o-E*f*o+E*s*v-i*M*v-m*s*x+i*f*x)*w,r[14]=(E*l*o-u*M*o-E*s*h+i*M*h+u*s*x-i*l*x)*w,r[15]=(u*f*o-m*l*o+m*s*h-i*f*h-u*s*v+i*l*v)*w,this},scale:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,s=t.x,o=t.y,a=t.z,u=i*s,l=i*o;return this.set(u*s+r,u*o-n*a,u*a+n*o,0,u*o+n*a,l*o+r,l*a-n*s,0,u*a-n*o,l*a+n*s,i*a*a+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},compose:function(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this},decompose:function(){var t,e;return function(r,n,i){void 0===t&&(t=new THREE.Vector3,e=new THREE.Matrix4);var s=this.elements,o=t.set(s[0],s[1],s[2]).length(),a=t.set(s[4],s[5],s[6]).length(),u=t.set(s[8],s[9],s[10]).length(),l=this.determinant();l<0&&(o=-o),r.x=s[12],r.y=s[13],r.z=s[14],e.elements.set(this.elements);var h=1/o,c=1/a,m=1/u;return e.elements[0]*=h,e.elements[1]*=h,e.elements[2]*=h,e.elements[4]*=c,e.elements[5]*=c,e.elements[6]*=c,e.elements[8]*=m,e.elements[9]*=m,e.elements[10]*=m,n.setFromRotationMatrix(e),i.x=o,i.y=a,i.z=u,this}}(),makeFrustum:function(t,e,r,n,i,s){var o=this.elements,a=2*i/(e-t),u=2*i/(n-r),l=(e+t)/(e-t),h=(n+r)/(n-r),c=-(s+i)/(s-i),m=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=c,o[14]=m,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(t,e,r,n){var i=r*Math.tan(THREE.Math.DEG2RAD*t*.5),s=-i,o=s*e,a=i*e;return this.makeFrustum(o,a,s,i,r,n)},makeOrthographic:function(t,e,r,n,i,s){var o=this.elements,a=1/(e-t),u=1/(r-n),l=1/(s-i),h=(e+t)*a,c=(r+n)*u,m=(s+i)*l;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-c,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-m,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;n<16;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}};
THREE.Quaternion=function(t,i,s,h){this._x=t||0,this._y=i||0,this._z=s||0,this._w=void 0!==h?h:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,i,s,h){return this._x=t,this._y=i,this._z=s,this._w=h,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,i){if(t instanceof THREE.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var s=Math.cos(t._x/2),h=Math.cos(t._y/2),n=Math.cos(t._z/2),_=Math.sin(t._x/2),r=Math.sin(t._y/2),e=Math.sin(t._z/2),a=t.order;return"XYZ"===a?(this._x=_*h*n+s*r*e,this._y=s*r*n-_*h*e,this._z=s*h*e+_*r*n,this._w=s*h*n-_*r*e):"YXZ"===a?(this._x=_*h*n+s*r*e,this._y=s*r*n-_*h*e,this._z=s*h*e-_*r*n,this._w=s*h*n+_*r*e):"ZXY"===a?(this._x=_*h*n-s*r*e,this._y=s*r*n+_*h*e,this._z=s*h*e+_*r*n,this._w=s*h*n-_*r*e):"ZYX"===a?(this._x=_*h*n-s*r*e,this._y=s*r*n+_*h*e,this._z=s*h*e-_*r*n,this._w=s*h*n+_*r*e):"YZX"===a?(this._x=_*h*n+s*r*e,this._y=s*r*n+_*h*e,this._z=s*h*e-_*r*n,this._w=s*h*n-_*r*e):"XZY"===a&&(this._x=_*h*n-s*r*e,this._y=s*r*n-_*h*e,this._z=s*h*e+_*r*n,this._w=s*h*n+_*r*e),i!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,i){var s=i/2,h=Math.sin(s);return this._x=t.x*h,this._y=t.y*h,this._z=t.z*h,this._w=Math.cos(s),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var i,s=t.elements,h=s[0],n=s[4],_=s[8],r=s[1],e=s[5],a=s[9],o=s[2],u=s[6],c=s[10],l=h+e+c;return l>0?(i=.5/Math.sqrt(l+1),this._w=.25/i,this._x=(u-a)*i,this._y=(_-o)*i,this._z=(r-n)*i):h>e&&h>c?(i=2*Math.sqrt(1+h-e-c),this._w=(u-a)/i,this._x=.25*i,this._y=(n+r)/i,this._z=(_+o)/i):e>c?(i=2*Math.sqrt(1+e-h-c),this._w=(_-o)/i,this._x=(n+r)/i,this._y=.25*i,this._z=(a+u)/i):(i=2*Math.sqrt(1+c-h-e),this._w=(r-n)/i,this._x=(_+o)/i,this._y=(a+u)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,i,s=1e-6;return function(h,n){return void 0===t&&(t=new THREE.Vector3),i=h.dot(n)+1,i<s?(i=0,Math.abs(h.x)>Math.abs(h.z)?t.set(-h.y,h.x,0):t.set(0,-h.z,h.y)):t.crossVectors(h,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=i,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var s=t._x,h=t._y,n=t._z,_=t._w,r=i._x,e=i._y,a=i._z,o=i._w;return this._x=s*o+_*r+h*a-n*e,this._y=h*o+_*e+n*r-s*a,this._z=n*o+_*a+s*e-h*r,this._w=_*o-s*r-h*e-n*a,this.onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var s=this._x,h=this._y,n=this._z,_=this._w,r=_*t._w+s*t._x+h*t._y+n*t._z;if(r<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,r=-r):this.copy(t),r>=1)return this._w=_,this._x=s,this._y=h,this._z=n,this;var e=Math.sqrt(1-r*r);if(Math.abs(e)<.001)return this._w=.5*(_+this._w),this._x=.5*(s+this._x),this._y=.5*(h+this._y),this._z=.5*(n+this._z),this;var a=Math.atan2(e,r),o=Math.sin((1-i)*a)/e,u=Math.sin(i*a)/e;return this._w=_*o+this._w*u,this._x=s*o+this._x*u,this._y=h*o+this._y*u,this._z=n*o+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(THREE.Quaternion,{slerp:function(t,i,s,h){return s.copy(t).slerp(i,h)},slerpFlat:function(t,i,s,h,n,_,r){var e=s[h+0],a=s[h+1],o=s[h+2],u=s[h+3],c=n[_+0],l=n[_+1],y=n[_+2],x=n[_+3];if(u!==x||e!==c||a!==l||o!==y){var z=1-r,w=e*c+a*l+o*y+u*x,f=w>=0?1:-1,b=1-w*w;if(b>Number.EPSILON){var C=Math.sqrt(b),g=Math.atan2(C,w*f);z=Math.sin(z*g)/C,r=Math.sin(r*g)/C}var M=r*f;if(e=e*z+c*M,a=a*z+l*M,o=o*z+y*M,u=u*z+x*M,z===1-r){var E=1/Math.sqrt(e*e+a*a+o*o+u*u);e*=E,a*=E,o*=E,u*=E}}t[i]=e,t[i+1]=a,t[i+2]=o,t[i+3]=u}});
THREE.Euler=function(t,i,h,n){this._x=t||0,this._y=i||0,this._z=h||0,this._order=n||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,i,h,n){return this._x=t,this._y=i,this._z=h,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,i,h){var n=THREE.Math.clamp,a=t.elements,s=a[0],r=a[4],e=a[8],o=a[1],_=a[5],c=a[9],u=a[2],l=a[6],M=a[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(n(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(-c,M),this._z=Math.atan2(-r,s)):(this._x=Math.atan2(l,_),this._z=0)):"YXZ"===i?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(e,M),this._z=Math.atan2(o,_)):(this._y=Math.atan2(-u,s),this._z=0)):"ZXY"===i?(this._x=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(-u,M),this._z=Math.atan2(-r,_)):(this._y=0,this._z=Math.atan2(o,s))):"ZYX"===i?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(l,M),this._z=Math.atan2(o,s)):(this._x=0,this._z=Math.atan2(-r,_))):"YZX"===i?(this._z=Math.asin(n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-c,_),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(e,M))):"XZY"===i?(this._z=Math.asin(-n(r,-1,1)),Math.abs(r)<.99999?(this._x=Math.atan2(l,_),this._y=Math.atan2(e,s)):(this._x=Math.atan2(-c,M),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,h!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(i,h,n){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationFromQuaternion(i),this.setFromRotationMatrix(t,h,n)}}(),setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(){var t=new THREE.Quaternion;return function(i){return t.setFromEuler(this),this.setFromQuaternion(t,i)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}};


/*!art-template - Template Engine | http://aui.github.com/artTemplate/*/
!function(){function a(a){return a.replace(t,"").replace(u,",").replace(v,"").replace(w,"").replace(x,"").split(y)}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function c(c,d){function e(a){return m+=a.split(/\n/).length-1,k&&(a=a.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),a&&(a=s[1]+b(a)+s[2]+"\n"),a}function f(b){var c=m;if(j?b=j(b,d):g&&(b=b.replace(/\n/g,function(){return m++,"$line="+m+";"})),0===b.indexOf("=")){var e=l&&!/^=[=#]/.test(b);if(b=b.replace(/^=[=#]?|[\s;]*$/g,""),e){var f=b.replace(/\s*\([^\)]+\)/,"");n[f]||/^(include|print)$/.test(f)||(b="$escape("+b+")")}else b="$string("+b+")";b=s[1]+b+s[2]}return g&&(b="$line="+c+";"+b),r(a(b),function(a){if(a&&!p[a]){var b;b="print"===a?u:"include"===a?v:n[a]?"$utils."+a:o[a]?"$helpers."+a:"$data."+a,w+=a+"="+b+",",p[a]=!0}}),b+"\n"}var g=d.debug,h=d.openTag,i=d.closeTag,j=d.parser,k=d.compress,l=d.escape,m=1,p={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,s=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],t=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+t+"}",v="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+t+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(g?"$line=0,":""),x=s[0],y="return new String("+s[3]+");";r(c.split(h),function(a){a=a.split(i);var b=a[0],c=a[1];1===a.length?x+=e(b):(x+=f(b),c&&(x+=e(c)))});var z=w+x+y;g&&(z="try{"+z+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+b(c)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var A=new Function("$data","$filename",z);return A.prototype=n,A}catch(B){throw B.temp="function anonymous($data,$filename) {"+z+"}",B}}var d=function(a,b){return"string"==typeof b?q(b,{filename:a}):g(a,b)};d.version="3.0.0",d.config=function(a,b){e[a]=b};var e=d.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},f=d.cache={};d.render=function(a,b){return q(a,b)};var g=d.renderFile=function(a,b){var c=d.get(a)||p({filename:a,name:"Render Error",message:"Template not found"});return b?c(b):c};d.get=function(a){var b;if(f[a])b=f[a];else if("object"==typeof document){var c=document.getElementById(a);if(c){var d=(c.value||c.innerHTML).replace(/^\s*|\s*$/g,"");b=q(d,{filename:a})}}return b};var h=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?h(a.call(a)):""),a},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},j=function(a){return i[a]},k=function(a){return h(a).replace(/&(?![\w#]+;)|[<>"']/g,j)},l=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},m=function(a,b){var c,d;if(l(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)},n=d.utils={$helpers:{},$include:g,$string:h,$escape:k,$each:m};d.helper=function(a,b){o[a]=b};var o=d.helpers=n.$helpers;d.onerror=function(a){var b="Template Error\n\n";for(var c in a)b+="<"+c+">\n"+a[c]+"\n\n";"object"==typeof console&&console.error(b)};var p=function(a){return d.onerror(a),function(){return"{Template Error}"}},q=d.compile=function(a,b){function d(c){try{return new i(c,h)+""}catch(d){return b.debug?p(d)():(b.debug=!0,q(a,b)(c))}}b=b||{};for(var g in e)void 0===b[g]&&(b[g]=e[g]);var h=b.filename;try{var i=c(a,b)}catch(j){return j.filename=h||"anonymous",j.name="Syntax Error",p(j)}return d.prototype=i.prototype,d.toString=function(){return i.toString()},h&&b.cache&&(f[h]=d),d},r=n.$each,s="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",t=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,u=/[^\w$]+/g,v=new RegExp(["\\b"+s.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g,y=/^$|,+/;"function"==typeof define?define(function(){return d}):"undefined"!=typeof exports?module.exports=d:this.template=d}();
!function(global) {

  if (global.template) {
    global.template.config('openTag','<#');
    global.template.config('closeTag','#>');
  }

  global.snot = {};

  global.snot.util = {
    left_pos: left_pos,
    top_pos: top_pos,
    is_mobile: is_mobile,
    is_wechat_login: is_wechat_login,
    get_window_width: get_window_width,
    get_window_height: get_window_height,
    position_to_rotation: position_to_rotation,
    distance2D: distance2D,
    distance3D: distance3D,
    epsilon: epsilon,
    css_text_to_matrix: css_text_to_matrix,
    matrix_to_css_text: matrix_to_css_text,
    webgl_check: webgl_check,
    load_js: load_js,
    rotation_to_position: rotation_to_position
  };

  function top_pos(elem) {
    var curtop = 0;
    if (elem.offsetParent) {
      do { 
          curtop += elem.offsetTop; 
      } while (elem = elem.offsetParent);
    }
    return curtop;
  };

  function left_pos(elem) {
    var curleft = 0;
    if (elem.offsetParent) {
        do { 
            curleft += elem.offsetLeft; 
        } while (elem = elem.offsetParent);
    }
    return curleft;
  };
  
  function is_mobile() {
    return get_window_width() < 500;
  }
  
  function is_wechat_login() {
    return window.navigator.userAgent.indexOf('MicroMessenger') >= 0 ? true : false;
  }
  
  function get_window_width() {
    return document.documentElement.clientWidth;
  }
  
  function get_window_height() {
    return document.documentElement.clientHeight;
  }
  
  function position_to_rotation(x, y, z) {
    var r = distance3D(x, y, z, 0, 0, 0);
    var rx = Math.asin(z / r);
    var ry = Math.asin(y / r / Math.cos(rx));
    if (x < 0) {
        ry = ry > 0 ? Math.PI - ry : - Math.PI - ry;
    }
  
    return {
      rx: - rx * 180 / Math.PI,
      ry: (ry < 0 ? ry + Math.PI * 2 : ry) * 180 / Math.PI
    };
  }
  
  function distance2D(a, b, c, d) {
    return Math.pow((a - c) * (a - c) + (b - d) * (b - d), 0.5);
  }
  
  function distance3D(a, b, c, d, e, f) {
    return Math.pow((a - d) * (a - d) + (b - e) * (b - e) + (c - f) * (c - f), 0.5);
  }
  
  function epsilon(value) {
    return Math.abs(value) < 0.000001 ? 0 : value.toFixed(5);
  };
  
  function css_text_to_matrix(t) {
    var m = new WebKitCSSMatrix(t);
    return [
      epsilon(m.m11), epsilon(m.m12), epsilon(m.m13), epsilon(m.m14),
      epsilon(m.m21), epsilon(m.m22), epsilon(m.m23), epsilon(m.m24),
      epsilon(m.m31), epsilon(m.m32), epsilon(m.m33), epsilon(m.m34),
      epsilon(m.m41), epsilon(m.m42), epsilon(m.m43), epsilon(m.m44)
    ];
  }
  
  function matrix_to_css_text(a, b, c, d,
                              e, f, g, h,
                              i, j, k, l,
                              m, n, o, p) {
      if (typeof(a) == 'object') {
          return 'matrix3d(' + (a.join(',')) + ')';
      }
      return 'matrix3d(' + a + ',' + b + ',' + c + ',' + d+',' + e + ',' + f + ',' + g + ',' + h + ',' + i + ',' + j + ',' + k + ',' + l + ',' + m + ',' + n + ',' + o+ ',' + p + ')';
  }
  
  window.requestAnimationFrame= (function () { 
    return window.requestAnimationFrame || 
    window.webkitRequestAnimationFrame || 
    window.mozRequestAnimationFrame || 
    window.oRequestAnimationFrame || 
    // if all else fails, use setTimeout 
    function (callback) { 
      return window.setTimeout(callback, 1000 / 60); // shoot for 60 fps 
    }; 
  })(); 
  
  function webgl_check(return_context) {
    if (!!window.WebGLRenderingContext) {
      var canvas = document.createElement("canvas");
      var names = ['webgl', 'experimental-webgl', 'moz-webgl', 'webkit-3d'];
      var context = false;
  
      for (var i = 0;i < 4; i++) {
        try {
          context = canvas.getContext(names[i]);
          if (context && typeof context.getParameter == 'function') {
            // WebGL is enabled
            if (return_context) {
              // return WebGL object if the function's argument is present
              return {
                name: names[i],
                gl: context
              };
            }
            // else, return just true
            return true;
          }
        } catch(e) {}
      }
  
      // WebGL is supported, but disabled
      return false;
    }
  
    // WebGL not supported
    return false;
  }
  
  function load_js(file, callback) {
    var _doc = document.getElementsByTagName('head')[0];
    var js = document.createElement('script');
    js.setAttribute('type', 'text/javascript');
    js.setAttribute('src', file);
    _doc.appendChild(js);
    if (!/*@cc_on!@*/0) { //if not ie
      //firefox2、firefox3、safari3.1+、opera9.6+ support js.onload
      js.onload = function () {
        callback();
      }
    } else {
      //ie6、ie7 support js.onreadystatechange
      js.onReadyStateChange = function () {
        if (js.readyState == 'loaded' || js.readyState == 'complete') {
          callback();
        }
      }
    }
  }
  
  function rotation_to_position(z, rx, ry, rz) {
    z = - z;
    rx = - rx;
  
    var x = snot.bg_size / 2;
    var y = snot.bg_size / 2;
  
    var transform = css_text_to_matrix('translate3d(' + x + 'px,' + y + 'px,0) rotateY(' + (0) + 'deg) rotateX(' + (0) + 'deg) rotateY(' + (ry ? - ry : 0) + 'deg) rotateX(' + (rx ? - rx : 0) + 'deg) rotateZ(' + (rz ? rz : 0) +'deg) translateZ(' + z + 'px)' );
    return [ - transform[12] + snot.bg_size / 2, transform[13] - snot.bg_size / 2, - transform[14]];
  }
}(window);

!function(global) {

  var dom_offset_top;
  var dom_offset_left;
  var snot = {

    camera_look_at: {
      x: 0,
      y: 0,
      z: 1,
    },
    mouse_sensitivity: 0.3,
    auto_rotation: 0,
    frames: 0,
    bg_rotation: [0, 0, 0, 0, 0, 0],

    pause_animation: false,

    dom      : document.getElementById('snot-wrap'),
    camera   : document.getElementById('snot-camera'),
    container: document.getElementById('snot-container'),

    bg_size: 1024,

    generator: {},
    gyro: false,
    ry: 0,        // Rotate * degree around y axis
    rx: 0,        // Rotate * degree around x axis
    max_fov: 120, // Max field of view (degree)
    min_fov: 60,   // Min field of view (degree)
    fov: 90,      // Default field of view
    smooth: 0.17,
    min_detect_distance: 20,
    on_click: function() {},
    on_sprite_click: function() {},
  }
  var prev_gyro;

  var PI = Math.PI;
  var sin = Math.sin;
  var cos = Math.cos;
  var tan = Math.tan;
  var acos = Math.acos;
  var atan = Math.atan;
  var pow = Math.pow;
  var floor = Math.floor;
  var sqrt = Math.sqrt;

  var dist_rx;
  var dist_ry;
  var previous_quat = new THREE.Quaternion();
  var screen_orientation = 0;
  var vars = {
    alpha: 0,
    beta: 90 * PI / 180,
    gamma: 0
  };

  var varsDest = {
    alpha: 0,
    beta: 0,
    gamma: 0
  };


  function _pointStandardlization(x, y, z) {
    var ratio = 200 / distance3D(x, y, z, 0, 0, 0);
    return [x * ratio, y * ratio, z * ratio];
  }

  if (global.snot) {
    for (var i in snot) {
      global.snot[i] = snot[i];
    }
    snot = global.snot;
  } else {
    console.error('snot-utils.js is missing');
    return;
  }
  var util = global.snot.util;
  var epsilon = util.epsilon;
  var distance3D = util.distance3D;
  var distance2D = util.distance2D;

  var set_fov = function (degree) {
    if (degree < snot.min_fov || degree > snot.max_fov) {
      return;
    }
    snot.fov = degree;
    snot.container.style['-webkit-transform'] = 'scale(' + tan(snot.max_fov / 2 * PI / 180) / tan(snot.fov / 2 * PI / 180) + ')';
  }

  function reset() {
    var sprites = document.getElementsByClassName('sprite');
    for (var i = 0; i < sprites.length; ++ i) {
      sprites[i].remove();
    }
  }

  var _init = function(config, ajax) {
    reset();

    cancelAnimationFrame(snot._animateId);

    for (var i in config) {
      if (i == 'generator') {
        merge_json(snot.generator, config.generator);
      }
      snot[i] = config[i];
    }
    prev_gyro = snot.gyro;

    dom_offset_left = util.left_pos(snot.dom);
    dom_offset_top = util.top_pos(snot.dom);

    dist_rx = snot.rx + 0.1; //unknown bug for mobile safari
    dist_ry = snot.ry;

    //First init
    if (!ajax) {

      snot.width = snot.dom.offsetWidth;
      snot.height = snot.dom.offsetHeight;

      //compute the max Horizontal Field of view
      //perspective= projectiveScreenWidth/2
      //           = width/2/tan(max_fov/2)
      snot.perspective = snot.width / 2 / tan(snot.max_fov / 2 * PI / 180);

      snot.container.style['-webkit-perspective'] = snot.perspective + 'px';

      //camera offset
      // Z is depth(front) Y is height X is right
      //
      // translateZ setFOV
      // rotateX rotate around X axis
      // rotateY rotate around Y axis
      // translateX translate the Camera to center
      // translateY
      snot.cameraBaseTransform = 'translateX(' + epsilon(- (snot.bg_size - snot.width) / 2) + 'px) translateY(' + epsilon(- (snot.bg_size - snot.height) / 2) + 'px)';
      snot.camera.style['-webkit-transform'] = 'translateZ(-' + snot.perspective + 'px) rotateX(' + snot.rx + 'deg) rotateY(' + snot.ry + 'deg)' + snot.cameraBaseTransform;
    }
    set_fov(snot.fov);

    if (config.bg_imgs) {
      load_bg_imgs(config.bg_imgs, config.bg_rotation || snot.bg_rotation);
    }

    if (config) {
      _load_sprites(config.sprites);
    }

    if (util.is_mobile()) {
      snot.container.addEventListener('touchstart', mouseDown, false);
      snot.container.addEventListener('touchmove' , mouseMove, false);
      snot.container.addEventListener('touchend'  , mouseUp  , false);
    } else {
      snot.container.addEventListener('mousedown' , mouseDown , false);
      snot.container.addEventListener('mousemove' , mouseMove , false);
      snot.container.addEventListener('mouseup'   , mouseUp   , false);
      snot.container.addEventListener('mousewheel', mouseWheel, false);
    }

    if (config.callback) {
      config.callback();
    }
  }

  function load_bg_imgs(bg_imgs, bg_rotation) {
    var bg_config = {
      front : 'rotateY(90deg)' + '                rotateZ(' + bg_rotation[0] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px)',
      bottom: 'rotateY(90deg)' + 'rotateX(90deg)  rotateZ(' + bg_rotation[1] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px) rotateZ(90deg)',
      left  : 'rotateY(90deg)' + 'rotateY(90deg)  rotateZ(' + bg_rotation[2] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px)',
      back  : 'rotateY(90deg)' + 'rotateY(180deg) rotateZ(' + bg_rotation[3] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px)',
      top   : 'rotateY(90deg)' + 'rotateX(-90deg) rotateZ(' + bg_rotation[4] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px) rotateZ(-90deg)',
      right : 'rotateY(90deg)' + 'rotateY(-90deg) rotateZ(' + bg_rotation[5] + 'deg)  translateZ(-' + (snot.bg_size / 2) + 'px)'
    };

    var bg_dom;
    var count = 0;
    for (var i in bg_config) {
      bg_dom = document.getElementsByClassName('snot-bg ' + i)[0];
      bg_dom.style['-webkit-transform'] = bg_config[i];
      bg_dom.style['width'] = snot.bg_size + 2 + 'px';        // 2 more pixels for overlapping gaps ( chrome's bug )
      bg_dom.style['height'] = snot.bg_size + 2 + 'px';        // 2 more pixels for overlapping gaps ( chrome's bug )

      bg_dom.setAttribute('src', bg_imgs[count]);
      bg_dom.setAttribute('data-index', count);
      ++count;
    }
  }

  var touches = {
    fx:0,   // First  finger x
    fy:0,   // First  finger y
    sx:0,   // Second finger x
    sy:0    // Second finger y
  };

  var _load_sprites = function(sprites) {
    for (var i in sprites) {
      var t = sprites[i];
      if (t.standardlization) {
        var standard = _pointStandardlization(t.x,t.y,t.z);
        t.x=standard[0];
        t.y=standard[1];
        t.z=standard[2];
      }

      var temp_wrapper = document.createElement('div');
      temp_wrapper.innerHTML = template(snot.generator[t.generator], t);
      var element = temp_wrapper.firstChild;
      element.data = sprites[i];
      add_sprite_by_position(element, t);
    }
  }

  function m_make_rotation_axis(point, rotation) {
    return new THREE.Matrix4().makeRotationAxis(point, rotation);
  }

  function m_multiply() {
    var mats = arguments;

    var l = mats.length;
    while (l > 1) {
      var last2 = mats[l - 2];
      var last1 = mats[l - 1];
      mats[l - 2] = new THREE.Matrix4().multiplyMatrices(
        last2,
        last1
      );
      l--;
    }
    return mats[0];
  }

  function v_set_from_matrix_position(mat4) {
    return new THREE.Vector3().setFromMatrixPosition(mat4);
  }

  function m_set_position(p) {
    return new THREE.Matrix4().setPosition(p);
  }

  function add_sprite_by_position(element, p) {

    var x = p.x;
    var z = - p.z;
    var y = - p.y;

    var spriteContainer = document.createElement('div');
    spriteContainer.style.display = 'inline-block';
    spriteContainer.style.position = 'absolute';
    spriteContainer.className = 'sprite-container';
    spriteContainer.id = element.data.id;

    spriteContainer.style['-webkit-transform-origin-x'] = '0';
    spriteContainer.style['-webkit-transform-origin-y'] = '0';

    var arc = x == 0 && z == 0 ? 0 : acos( z / pow(x * x + z * z, 0.5));

    arc = x < 0 ? 2 * PI - arc : arc;
    arc = arc * 180 / PI;

    var r = distance3D(x, y, z, 0, 0, 0);
    x += snot.bg_size / 2;
    y += snot.bg_size / 2;

    spriteContainer.style['-webkit-transform'] = 'translate3d(' + epsilon(x) + 'px,' + epsilon(y) + 'px,' + epsilon(z) + 'px) rotateY(' + epsilon(arc) + 'deg) rotateX(' + epsilon(- (y - snot.bg_size / 2) / r * 90)+'deg) rotateY(180deg)';

    var spriteWrap = document.createElement('div');
    spriteWrap.className='sprite-wrap';
    spriteWrap.appendChild(element);
    spriteWrap.setAttribute('data-visible', element.data.visible == false ? false : true);

    spriteContainer.appendChild(spriteWrap);
    snot.camera.appendChild(spriteContainer);
  }

  var update_sprite_visibility = function(id) {
    var visible = snot.sprites[id].visible;
    var spriteContainer = document.getElementById(id);
    spriteContainer.firstChild.setAttribute('data-visible', visible ? true : false);
  }

  var update_sprite_position = function(id) {
    var x = snot.sprites[id].x;
    var y = snot.sprites[id].y;
    var z = snot.sprites[id].z;
    z=-z;
    y=-y;
    var arc = x == 0 && z == 0 ? 0 : acos( z / pow(x * x + z * z, 0.5));

    arc = x < 0 ? 2 * PI - arc : arc;
    arc = arc * 180/ PI;

    var r = distance3D(x, y, z, 0, 0, 0);
    x += snot.bg_size / 2;
    y += snot.bg_size / 2;

    var spriteContainer = document.getElementById(id);

    spriteContainer.style['-webkit-transform'] = 'translate3d(' + epsilon(x) + 'px,' + epsilon(y) + 'px,' + epsilon(z) + 'px) rotateY(' + epsilon(arc) + 'deg) rotateX(' + epsilon(- (y - snot.bg_size / 2) / r * 90) + 'deg) rotateY(180deg)';
  }

  var mouseMove = function(event) {

    event.preventDefault();
    event.stopPropagation();

    var x = Math.floor(event.clientX >= 0 ? event.clientX : event.touches[0].pageX);
    var y = Math.floor(event.clientY >= 0 ? event.clientY : event.touches[0].pageY);
    x -= dom_offset_left;
    y -= dom_offset_top;

    touches.click = false;

    if (!touches.onTouching) {
      return false;
    }

    if (event.touches && event.touches.length > 1) {

      var cfx = x;                          // Current frist  finger x
      var cfy = y;                          // Current first  finger y
      var csx = event.touches[1].pageX;     // Current second finger x
      var csy = event.touches[1].pageY;     // Current second finger y

      var dis = distance2D(touches.fx, touches.fy, touches.sx, touches.sy) - distance2D(cfx, cfy, csx, csy);

      var ratio = 0.12;
      snot.setFov(snot.fov + dis * ratio);

      touches.fx = cfx;
      touches.fy = cfy;
      touches.sx = csx;
      touches.sy = csy;

      return false;
    }

    var ratio = snot.mouse_sensitivity;

    dist_ry = dist_ry + (touches.fx - x) * ratio;
    dist_rx = dist_rx - (touches.fy - y) * ratio;

    touches.fx = x;
    touches.fy = y;

    dist_rx = dist_rx > 90 ? 90 : dist_rx;
    dist_rx = dist_rx < -90 ? -90 : dist_rx;

  };

  var mouseDownX;
  var mouseDownY;
  var mouseDown = function (event) {

    event.preventDefault();
    event.stopPropagation();

    var x = floor(event.clientX >= 0 ? event.clientX : event.touches[0].clientX);
    var y = floor(event.clientY >= 0 ? event.clientY : event.touches[0].clientY);
    x -= dom_offset_left;
    y -= dom_offset_top;

    mouseDownX = x;
    mouseDownY = y;

    touches.fx = x;
    touches.fy = y;
    touches.click = true;

    if (event.touches && event.touches.length > 1) {

      touches.sx = event.touches[1].pageX;
      touches.sy = event.touches[1].pageY;

    }

    touches.onTouching = true;
  }

  var mouseWheel = function (event) {

    event.preventDefault();
    event.stopPropagation();

    var offset = event.deltaY;
    snot.setFov(snot.fov + offset * 0.06);

  }

  function on_click(x, y) {
    var R = 100;
    var fov = snot.fov;
    var bg_size = snot.bg_size;
    var arcFactor = Math.PI / 180;
    var rz = snot.rz * arcFactor;
    var width = snot.width;
    var height = snot.height;

    var ry = (x / width - 0.5) * fov;
    var rx = (y / height-0.5) * fov * height / width;
    var r = cos(fov / 2 * arcFactor) * bg_size;
    var ratiox = (x - width / 2) / width * 2;
    var ratioy = (y - height / 2) / width * 2;
    var P = sin(fov / 2 * arcFactor) * bg_size;

    ry = atan(ratiox * P / r);
    rx = atan(ratioy * P / r);

    ry *= 180 / PI;
    rx *= 180 / PI;

    var xyz2 = util.rotation_to_position(R, rx, 0);

    var rr = distance3D(- tan(ry * arcFactor) * xyz2[2], - xyz2[1], xyz2[2], 0, 0, 0);
    var ratio = R / rr;

    var new_x = - tan(ry * PI / 180) * xyz2[2] * ratio;
    var new_y = - xyz2[1] * ratio;
    var new_z = xyz2[2] * ratio;

    var pos = v_set_from_matrix_position(m_multiply(
      m_make_rotation_axis({x: 0, y: 1, z: 0}, - snot.ry * PI / 180),
      m_make_rotation_axis({x: 0, y: 0, z: 1}, - snot.rz * PI / 180),
      m_make_rotation_axis({x: 1, y: 0, z: 0}, - snot.rx * PI / 180),
      m_set_position({x: new_x, y: new_y, z: new_z})
    ));

    ax = - pos.x;
    ay = pos.y;
    az = pos.z;

    var min_offset = 0.4;
    var min_distance = snot.min_detect_distance;
    var nearest;

    var spriteContainers = document.getElementsByClassName('sprite-container');
    for (var i = 0 ;i < spriteContainers.length; ++i) {
      var self = spriteContainers[i];
      var matrix = util.css_text_to_matrix(self.style.webkitTransform);
      var rate_ = 100 / distance3D(0, 0, 0, snot.bg_size / 2 - matrix[12], matrix[13] - snot.bg_size / 2, - matrix[14]);

      var distance = distance3D(- ax, - ay, az, (snot.bg_size / 2 - matrix[12]) * rate_, rate_ * (matrix[13] - snot.bg_size / 2), rate_ * ( - matrix[14]));
      if (distance < min_distance) {
        min_distance = distance;
        nearest = self.children[0];
      }
    }

    var rotation = util.position_to_rotation(ax, az, ay);
    if (nearest) {
      snot.on_sprite_click(snot.sprites[nearest.parentElement.id], nearest);
    } else {
      snot.on_click(ax, ay, az, rotation[0], rotation[1]);
    }
  }

  var mouseUp = function (event) {
    event.preventDefault();
    event.stopPropagation();

    var x = floor(event.clientX >= 0 ? event.clientX : event.changedTouches[0].pageX);
    var y = floor(event.clientY >= 0 ? event.clientY : event.changedTouches[0].pageY);
    x -= dom_offset_left;
    y -= dom_offset_top;

    //Screen coordinate to Sphere 3d coordinate
    if (distance2D(mouseDownX, mouseDownY, x, y) < 5) {
      on_click(x, y);
    }
    touches.onTouching = false;
  }

  function _run() {
    snot._animateId = requestAnimationFrame(_run);
    if (!snot.pause_animation) {
      _update();
    }
  }

  function m_make_rotation_from_quaternion(q) {
    return new THREE.Matrix4().makeRotationFromQuaternion(q);
  }

  var camera_euler = new THREE.Euler();
  var target_quat = new THREE.Quaternion();
  var rotate_90_quat = new THREE.Quaternion(- sqrt( 0.5 ), 0, 0, sqrt( 0.5 ))
  var adjust_screen_quats = {
    0: new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 0, 1), 0),
    90: new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 0, 1), - 90),
    180: new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 0, 1), - 180),
    '-90': new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 0, 1), 90),
  };
  var look_at_euler = new THREE.Euler();

  function update_camera(x, y, z) {

    camera_euler.set(y, x, z, 'YXZ'); // 'ZXY' for the device, but 'YXZ' for us

    target_quat.setFromEuler(camera_euler); // orient the device

    target_quat.multiply(rotate_90_quat); // camera looks out the back of the device, not the top
                                          // - PI/2 around the x-axis
    target_quat.multiply(adjust_screen_quats[screen_orientation]); // adjust for screen orientation

    var slerp_quat = new THREE.Quaternion();
    THREE.Quaternion.slerp(target_quat, previous_quat, slerp_quat, 1 - snot.smooth);
    previous_quat = slerp_quat;
    var look_at_quat = slerp_quat.clone();
    look_at_quat.x *= -1;
    look_at_quat.z *= -1;
    var look_at_mat = m_make_rotation_from_quaternion(look_at_quat.normalize()).transpose();
    var look_at_rot = look_at_euler.setFromRotationMatrix(look_at_mat, 'XZY');

    snot.rx = look_at_rot._x * 180 / PI;
    snot.ry = look_at_rot._y * 180 / PI;
    snot.rz = look_at_rot._z * 180 / PI;

    snot.camera_look_at = v_set_from_matrix_position(m_multiply(
      m_make_rotation_axis({x: 0, y: 1, z: 0}, look_at_rot._y),
      m_make_rotation_axis({x: 0, y: 0, z: 1}, look_at_rot._z),
      m_make_rotation_axis({x: 1, y: 0, z: 0}, - look_at_rot._x),
      m_set_position({x: 0, y: 0, z: 1})
    )); // bad performance here

    snot.camera.style.transform = 'translateZ(' + epsilon(snot.perspective) + 'px)' + " matrix3d(" + look_at_mat.elements + ")"+ snot.cameraBaseTransform;
  }

  function _update() {
    snot.frames++;

    if (snot.gyro) {
      if (vars.alpha === -1 && vars.beta === -1 && vars.gamma === - 1) {
        return;
      }

      update_camera(vars.alpha, vars.beta, - vars.gamma);
    } else {
      if (prev_gyro) {
        dist_rx = 0;
        dist_ry = 0;
      }
      dist_ry += snot.auto_rotation;
      update_camera( - dist_ry * PI / 180, dist_rx * PI / 180 + PI / 2, 0);
    }
    prev_gyro = snot.gyro;

    for (var i in snot.sprites) {
      var sprite = snot.sprites[i];
      if (sprite.need_update_position) {
        sprite.need_update_position = false;
        update_sprite_position(sprite.id);
      }
      if (sprite.need_update_visibility) {
        sprite.need_update_visibility = false;
        update_sprite_visibility(sprite.id);
      }
    }
  }

  window.addEventListener('orientationchange', function(ev) {
    screen_orientation = window.orientation || 0;
  }, false );

  window.addEventListener('deviceorientation', function(ev) {
    if (ev.alpha !== null) {
      vars.beta = ev.beta  * Math.PI / 180 ;
      vars.gamma = ev.gamma  * Math.PI / 180;
      vars.alpha = ev.alpha  * Math.PI / 180;
    } else {
      vars.beta = vars.gamma = vars.alpha = -1;
    }
  }, true);


  var _setRx = function(rx, smooth) {
    //TODO
  }

  var _setRy=function(ry,smooth){
    //TODO
  }

  function merge_json(obj, json) {
    for (var i in json) {
      if (obj[i] == undefined) {
        obj[i] = json[i];
      }
    }
  }

  merge_json(snot, {
    setFov: set_fov,
    setRx: _setRx,
    setRy: _setRy,
    init: _init,
    run: _run,
    update: _update,
    load_sprites: _load_sprites,
  });
}(window);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRocmVlX21hdGguanMiLCJWZWN0b3IzLmpzIiwiTWF0cml4NC5qcyIsIlF1YXRlcm5pb24uanMiLCJFdWxlci5qcyIsInRlbXBsYXRlLW5hdGl2ZS5qcyIsInNub3RfdXRpbHMuanMiLCJzbm90X2Nzc19yZW5kZXJlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FDQUE7QUNBQTtBQ0FBOzs7QUNBQTtBQUNBO0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic25vdF9jc3NfcmVuZGVyZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiVEhSRUU9e30sVEhSRUUuTWF0aD17Y2xhbXA6ZnVuY3Rpb24oRSxuLHQpe3JldHVybiBFPnQ/dDpFPG4/bjpFfX07IiwiVEhSRUUuVmVjdG9yMz1mdW5jdGlvbih0LGkscyl7dGhpcy54PXR8fDAsdGhpcy55PWl8fDAsdGhpcy56PXN8fDB9LFRIUkVFLlZlY3RvcjMucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpUSFJFRS5WZWN0b3IzLHNldDpmdW5jdGlvbih0LGkscyl7cmV0dXJuIHRoaXMueD10LHRoaXMueT1pLHRoaXMuej1zLHRoaXN9LHNldFNjYWxhcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PXQsdGhpcy55PXQsdGhpcy56PXQsdGhpc30sc2V0WDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PXQsdGhpc30sc2V0WTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy55PXQsdGhpc30sc2V0WjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy56PXQsdGhpc30sc2V0Q29tcG9uZW50OmZ1bmN0aW9uKHQsaSl7c3dpdGNoKHQpe2Nhc2UgMDp0aGlzLng9aTticmVhaztjYXNlIDE6dGhpcy55PWk7YnJlYWs7Y2FzZSAyOnRoaXMuej1pO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiaW5kZXggaXMgb3V0IG9mIHJhbmdlOiBcIit0KX19LGdldENvbXBvbmVudDpmdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZSAwOnJldHVybiB0aGlzLng7Y2FzZSAxOnJldHVybiB0aGlzLnk7Y2FzZSAyOnJldHVybiB0aGlzLno7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJpbmRleCBpcyBvdXQgb2YgcmFuZ2U6IFwiK3QpfX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LHRoaXMueSx0aGlzLnopfSxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng9dC54LHRoaXMueT10LnksdGhpcy56PXQueix0aGlzfSxhZGQ6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwIT09aT8oY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmFkZCgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmFkZFZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLmFkZFZlY3RvcnModCxpKSk6KHRoaXMueCs9dC54LHRoaXMueSs9dC55LHRoaXMueis9dC56LHRoaXMpfSxhZGRTY2FsYXI6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueCs9dCx0aGlzLnkrPXQsdGhpcy56Kz10LHRoaXN9LGFkZFZlY3RvcnM6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdGhpcy54PXQueCtpLngsdGhpcy55PXQueStpLnksdGhpcy56PXQueitpLnosdGhpc30sYWRkU2NhbGVkVmVjdG9yOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMueCs9dC54KmksdGhpcy55Kz10LnkqaSx0aGlzLnorPXQueippLHRoaXN9LHN1YjpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDAhPT1pPyhjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IzOiAuc3ViKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuc3ViVmVjdG9ycyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMuc3ViVmVjdG9ycyh0LGkpKToodGhpcy54LT10LngsdGhpcy55LT10LnksdGhpcy56LT10LnosdGhpcyl9LHN1YlNjYWxhcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54LT10LHRoaXMueS09dCx0aGlzLnotPXQsdGhpc30sc3ViVmVjdG9yczpmdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLng9dC54LWkueCx0aGlzLnk9dC55LWkueSx0aGlzLno9dC56LWkueix0aGlzfSxtdWx0aXBseTpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDAhPT1pPyhjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IzOiAubXVsdGlwbHkoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5tdWx0aXBseVZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLm11bHRpcGx5VmVjdG9ycyh0LGkpKToodGhpcy54Kj10LngsdGhpcy55Kj10LnksdGhpcy56Kj10LnosdGhpcyl9LG11bHRpcGx5U2NhbGFyOmZ1bmN0aW9uKHQpe3JldHVybiBpc0Zpbml0ZSh0KT8odGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQpOih0aGlzLng9MCx0aGlzLnk9MCx0aGlzLno9MCksdGhpc30sbXVsdGlwbHlWZWN0b3JzOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMueD10LngqaS54LHRoaXMueT10LnkqaS55LHRoaXMuej10LnoqaS56LHRoaXN9LGFwcGx5RXVsZXI6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gZnVuY3Rpb24oaSl7cmV0dXJuIGkgaW5zdGFuY2VvZiBUSFJFRS5FdWxlcj09ITEmJmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5WZWN0b3IzOiAuYXBwbHlFdWxlcigpIG5vdyBleHBlY3RzIGFuIEV1bGVyIHJvdGF0aW9uIHJhdGhlciB0aGFuIGEgVmVjdG9yMyBhbmQgb3JkZXIuXCIpLHZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5RdWF0ZXJuaW9uKSx0aGlzLmFwcGx5UXVhdGVybmlvbih0LnNldEZyb21FdWxlcihpKSl9fSgpLGFwcGx5QXhpc0FuZ2xlOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIGZ1bmN0aW9uKGkscyl7cmV0dXJuIHZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5RdWF0ZXJuaW9uKSx0aGlzLmFwcGx5UXVhdGVybmlvbih0LnNldEZyb21BeGlzQW5nbGUoaSxzKSl9fSgpLGFwcGx5TWF0cml4MzpmdW5jdGlvbih0KXt2YXIgaT10aGlzLngscz10aGlzLnksbj10aGlzLnoscj10LmVsZW1lbnRzO3JldHVybiB0aGlzLng9clswXSppK3JbM10qcytyWzZdKm4sdGhpcy55PXJbMV0qaStyWzRdKnMrcls3XSpuLHRoaXMuej1yWzJdKmkrcls1XSpzK3JbOF0qbix0aGlzfSxhcHBseU1hdHJpeDQ6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy54LHM9dGhpcy55LG49dGhpcy56LHI9dC5lbGVtZW50cztyZXR1cm4gdGhpcy54PXJbMF0qaStyWzRdKnMrcls4XSpuK3JbMTJdLHRoaXMueT1yWzFdKmkrcls1XSpzK3JbOV0qbityWzEzXSx0aGlzLno9clsyXSppK3JbNl0qcytyWzEwXSpuK3JbMTRdLHRoaXN9LGFwcGx5UHJvamVjdGlvbjpmdW5jdGlvbih0KXt2YXIgaT10aGlzLngscz10aGlzLnksbj10aGlzLnoscj10LmVsZW1lbnRzLGg9MS8oclszXSppK3JbN10qcytyWzExXSpuK3JbMTVdKTtyZXR1cm4gdGhpcy54PShyWzBdKmkrcls0XSpzK3JbOF0qbityWzEyXSkqaCx0aGlzLnk9KHJbMV0qaStyWzVdKnMrcls5XSpuK3JbMTNdKSpoLHRoaXMuej0oclsyXSppK3JbNl0qcytyWzEwXSpuK3JbMTRdKSpoLHRoaXN9LGFwcGx5UXVhdGVybmlvbjpmdW5jdGlvbih0KXt2YXIgaT10aGlzLngscz10aGlzLnksbj10aGlzLnoscj10LngsaD10LnksZT10Lnosbz10LncsYT1vKmkraCpuLWUqcyx1PW8qcytlKmktcipuLGM9bypuK3Iqcy1oKmkseT0tcippLWgqcy1lKm47cmV0dXJuIHRoaXMueD1hKm8reSotcit1Ki1lLWMqLWgsdGhpcy55PXUqbyt5Ki1oK2MqLXItYSotZSx0aGlzLno9YypvK3kqLWUrYSotaC11Ki1yLHRoaXN9LHByb2plY3Q6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gZnVuY3Rpb24oaSl7cmV0dXJuIHZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5NYXRyaXg0KSx0Lm11bHRpcGx5TWF0cmljZXMoaS5wcm9qZWN0aW9uTWF0cml4LHQuZ2V0SW52ZXJzZShpLm1hdHJpeFdvcmxkKSksdGhpcy5hcHBseVByb2plY3Rpb24odCl9fSgpLHVucHJvamVjdDpmdW5jdGlvbigpe3ZhciB0O3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9bmV3IFRIUkVFLk1hdHJpeDQpLHQubXVsdGlwbHlNYXRyaWNlcyhpLm1hdHJpeFdvcmxkLHQuZ2V0SW52ZXJzZShpLnByb2plY3Rpb25NYXRyaXgpKSx0aGlzLmFwcGx5UHJvamVjdGlvbih0KX19KCksdHJhbnNmb3JtRGlyZWN0aW9uOmZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMueCxzPXRoaXMueSxuPXRoaXMueixyPXQuZWxlbWVudHM7cmV0dXJuIHRoaXMueD1yWzBdKmkrcls0XSpzK3JbOF0qbix0aGlzLnk9clsxXSppK3JbNV0qcytyWzldKm4sdGhpcy56PXJbMl0qaStyWzZdKnMrclsxMF0qbix0aGlzLm5vcm1hbGl6ZSgpfSxkaXZpZGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueC89dC54LHRoaXMueS89dC55LHRoaXMuei89dC56LHRoaXN9LGRpdmlkZVNjYWxhcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcigxL3QpfSxtaW46ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD1NYXRoLm1pbih0aGlzLngsdC54KSx0aGlzLnk9TWF0aC5taW4odGhpcy55LHQueSksdGhpcy56PU1hdGgubWluKHRoaXMueix0LnopLHRoaXN9LG1heDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHRoaXMueCx0LngpLHRoaXMueT1NYXRoLm1heCh0aGlzLnksdC55KSx0aGlzLno9TWF0aC5tYXgodGhpcy56LHQueiksdGhpc30sY2xhbXA6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHQueCxNYXRoLm1pbihpLngsdGhpcy54KSksdGhpcy55PU1hdGgubWF4KHQueSxNYXRoLm1pbihpLnksdGhpcy55KSksdGhpcy56PU1hdGgubWF4KHQueixNYXRoLm1pbihpLnosdGhpcy56KSksdGhpc30sY2xhbXBTY2FsYXI6ZnVuY3Rpb24oKXt2YXIgdCxpO3JldHVybiBmdW5jdGlvbihzLG4pe3JldHVybiB2b2lkIDA9PT10JiYodD1uZXcgVEhSRUUuVmVjdG9yMyxpPW5ldyBUSFJFRS5WZWN0b3IzKSx0LnNldChzLHMscyksaS5zZXQobixuLG4pLHRoaXMuY2xhbXAodCxpKX19KCksY2xhbXBMZW5ndGg6ZnVuY3Rpb24odCxpKXt2YXIgcz10aGlzLmxlbmd0aCgpO3JldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKE1hdGgubWF4KHQsTWF0aC5taW4oaSxzKSkvcyl9LGZsb29yOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueD1NYXRoLmZsb29yKHRoaXMueCksdGhpcy55PU1hdGguZmxvb3IodGhpcy55KSx0aGlzLno9TWF0aC5mbG9vcih0aGlzLnopLHRoaXN9LGNlaWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54PU1hdGguY2VpbCh0aGlzLngpLHRoaXMueT1NYXRoLmNlaWwodGhpcy55KSx0aGlzLno9TWF0aC5jZWlsKHRoaXMueiksdGhpc30scm91bmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54PU1hdGgucm91bmQodGhpcy54KSx0aGlzLnk9TWF0aC5yb3VuZCh0aGlzLnkpLHRoaXMuej1NYXRoLnJvdW5kKHRoaXMueiksdGhpc30scm91bmRUb1plcm86ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54PXRoaXMueDwwP01hdGguY2VpbCh0aGlzLngpOk1hdGguZmxvb3IodGhpcy54KSx0aGlzLnk9dGhpcy55PDA/TWF0aC5jZWlsKHRoaXMueSk6TWF0aC5mbG9vcih0aGlzLnkpLHRoaXMuej10aGlzLno8MD9NYXRoLmNlaWwodGhpcy56KTpNYXRoLmZsb29yKHRoaXMueiksdGhpc30sbmVnYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueD0tdGhpcy54LHRoaXMueT0tdGhpcy55LHRoaXMuej0tdGhpcy56LHRoaXN9LGRvdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55K3RoaXMueip0Lnp9LGxlbmd0aFNxOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56fSxsZW5ndGg6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56KX0sbGVuZ3RoTWFuaGF0dGFuOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguYWJzKHRoaXMueCkrTWF0aC5hYnModGhpcy55KStNYXRoLmFicyh0aGlzLnopfSxub3JtYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXZpZGVTY2FsYXIodGhpcy5sZW5ndGgoKSl9LHNldExlbmd0aDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcih0L3RoaXMubGVuZ3RoKCkpfSxsZXJwOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHRoaXMueCs9KHQueC10aGlzLngpKmksdGhpcy55Kz0odC55LXRoaXMueSkqaSx0aGlzLnorPSh0LnotdGhpcy56KSppLHRoaXN9LGxlcnBWZWN0b3JzOmZ1bmN0aW9uKHQsaSxzKXtyZXR1cm4gdGhpcy5zdWJWZWN0b3JzKGksdCkubXVsdGlwbHlTY2FsYXIocykuYWRkKHQpfSxjcm9zczpmdW5jdGlvbih0LGkpe2lmKHZvaWQgMCE9PWkpcmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IC5jcm9zcygpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmNyb3NzVmVjdG9ycyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMuY3Jvc3NWZWN0b3JzKHQsaSk7dmFyIHM9dGhpcy54LG49dGhpcy55LHI9dGhpcy56O3JldHVybiB0aGlzLng9bip0Lnotcip0LnksdGhpcy55PXIqdC54LXMqdC56LHRoaXMuej1zKnQueS1uKnQueCx0aGlzfSxjcm9zc1ZlY3RvcnM6ZnVuY3Rpb24odCxpKXt2YXIgcz10Lngsbj10Lnkscj10LnosaD1pLngsZT1pLnksbz1pLno7cmV0dXJuIHRoaXMueD1uKm8tciplLHRoaXMueT1yKmgtcypvLHRoaXMuej1zKmUtbipoLHRoaXN9LHByb2plY3RPblZlY3RvcjpmdW5jdGlvbih0KXt2YXIgaT10LmRvdCh0aGlzKS90Lmxlbmd0aFNxKCk7cmV0dXJuIHRoaXMuY29weSh0KS5tdWx0aXBseVNjYWxhcihpKX0scHJvamVjdE9uUGxhbmU6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gZnVuY3Rpb24oaSl7cmV0dXJuIHZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5WZWN0b3IzKSx0LmNvcHkodGhpcykucHJvamVjdE9uVmVjdG9yKGkpLHRoaXMuc3ViKHQpfX0oKSxyZWZsZWN0OmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiB2b2lkIDA9PT10JiYodD1uZXcgVEhSRUUuVmVjdG9yMyksdGhpcy5zdWIodC5jb3B5KGkpLm11bHRpcGx5U2NhbGFyKDIqdGhpcy5kb3QoaSkpKX19KCksYW5nbGVUbzpmdW5jdGlvbih0KXt2YXIgaT10aGlzLmRvdCh0KS9NYXRoLnNxcnQodGhpcy5sZW5ndGhTcSgpKnQubGVuZ3RoU3EoKSk7cmV0dXJuIE1hdGguYWNvcyhUSFJFRS5NYXRoLmNsYW1wKGksLTEsMSkpfSxkaXN0YW5jZVRvOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVRvU3F1YXJlZCh0KSl9LGRpc3RhbmNlVG9TcXVhcmVkOmZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMueC10Lngscz10aGlzLnktdC55LG49dGhpcy56LXQuejtyZXR1cm4gaSppK3MqcytuKm59LGRpc3RhbmNlVG9NYW5oYXR0YW46ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguYWJzKHRoaXMueC10LngpK01hdGguYWJzKHRoaXMueS10LnkpK01hdGguYWJzKHRoaXMuei10LnopfSxzZXRGcm9tU3BoZXJpY2FsOmZ1bmN0aW9uKHQpe3ZhciBpPU1hdGguc2luKHQucGhpKSp0LnJhZGl1cztyZXR1cm4gdGhpcy54PWkqTWF0aC5zaW4odC50aGV0YSksdGhpcy55PU1hdGguY29zKHQucGhpKSp0LnJhZGl1cyx0aGlzLno9aSpNYXRoLmNvcyh0LnRoZXRhKSx0aGlzfSxzZXRGcm9tTWF0cml4UG9zaXRpb246ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0RnJvbU1hdHJpeENvbHVtbih0LDMpfSxzZXRGcm9tTWF0cml4U2NhbGU6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHQsMCkubGVuZ3RoKCkscz10aGlzLnNldEZyb21NYXRyaXhDb2x1bW4odCwxKS5sZW5ndGgoKSxuPXRoaXMuc2V0RnJvbU1hdHJpeENvbHVtbih0LDIpLmxlbmd0aCgpO3JldHVybiB0aGlzLng9aSx0aGlzLnk9cyx0aGlzLno9bix0aGlzfSxzZXRGcm9tTWF0cml4Q29sdW1uOmZ1bmN0aW9uKHQsaSl7aWYoXCJudW1iZXJcIj09dHlwZW9mIHQpe2NvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IHNldEZyb21NYXRyaXhDb2x1bW4gbm93IGV4cGVjdHMgKCBtYXRyaXgsIGluZGV4ICkuXCIpO3ZhciBzPXQ7dD1pLGk9c31yZXR1cm4gdGhpcy5mcm9tQXJyYXkodC5lbGVtZW50cyw0KmkpfSxlcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHQueD09PXRoaXMueCYmdC55PT09dGhpcy55JiZ0Lno9PT10aGlzLnp9LGZyb21BcnJheTpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDA9PT1pJiYoaT0wKSx0aGlzLng9dFtpXSx0aGlzLnk9dFtpKzFdLHRoaXMuej10W2krMl0sdGhpc30sdG9BcnJheTpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDA9PT10JiYodD1bXSksdm9pZCAwPT09aSYmKGk9MCksdFtpXT10aGlzLngsdFtpKzFdPXRoaXMueSx0W2krMl09dGhpcy56LHR9LGZyb21BdHRyaWJ1dGU6ZnVuY3Rpb24odCxpLHMpe3JldHVybiB2b2lkIDA9PT1zJiYocz0wKSxpPWkqdC5pdGVtU2l6ZStzLHRoaXMueD10LmFycmF5W2ldLHRoaXMueT10LmFycmF5W2krMV0sdGhpcy56PXQuYXJyYXlbaSsyXSx0aGlzfX07IiwiVEhSRUUuTWF0cml4ND1mdW5jdGlvbigpe3RoaXMuZWxlbWVudHM9bmV3IEZsb2F0MzJBcnJheShbMSwwLDAsMCwwLDEsMCwwLDAsMCwxLDAsMCwwLDAsMV0pLGFyZ3VtZW50cy5sZW5ndGg+MCYmY29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDQ6IHRoZSBjb25zdHJ1Y3RvciBubyBsb25nZXIgcmVhZHMgYXJndW1lbnRzLiB1c2UgLnNldCgpIGluc3RlYWQuXCIpfSxUSFJFRS5NYXRyaXg0LnByb3RvdHlwZT17Y29uc3RydWN0b3I6VEhSRUUuTWF0cml4NCxzZXQ6ZnVuY3Rpb24odCxlLHIsbixpLHMsbyxhLHUsbCxoLGMsbSxmLHYseSl7dmFyIEU9dGhpcy5lbGVtZW50cztyZXR1cm4gRVswXT10LEVbNF09ZSxFWzhdPXIsRVsxMl09bixFWzFdPWksRVs1XT1zLEVbOV09byxFWzEzXT1hLEVbMl09dSxFWzZdPWwsRVsxMF09aCxFWzE0XT1jLEVbM109bSxFWzddPWYsRVsxMV09dixFWzE1XT15LHRoaXN9LGlkZW50aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0KDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEpLHRoaXN9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBUSFJFRS5NYXRyaXg0KS5mcm9tQXJyYXkodGhpcy5lbGVtZW50cyl9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZWxlbWVudHMuc2V0KHQuZWxlbWVudHMpLHRoaXN9LGNvcHlQb3NpdGlvbjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmVsZW1lbnRzLHI9dC5lbGVtZW50cztyZXR1cm4gZVsxMl09clsxMl0sZVsxM109clsxM10sZVsxNF09clsxNF0sdGhpc30sZXh0cmFjdEJhc2lzOmZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdC5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMCksZS5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMSksci5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMiksdGhpc30sbWFrZUJhc2lzOmZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdGhpcy5zZXQodC54LGUueCxyLngsMCx0LnksZS55LHIueSwwLHQueixlLnosci56LDAsMCwwLDAsMSksdGhpc30sZXh0cmFjdFJvdGF0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5WZWN0b3IzKTt2YXIgcj10aGlzLmVsZW1lbnRzLG49ZS5lbGVtZW50cyxpPTEvdC5zZXRGcm9tTWF0cml4Q29sdW1uKGUsMCkubGVuZ3RoKCkscz0xL3Quc2V0RnJvbU1hdHJpeENvbHVtbihlLDEpLmxlbmd0aCgpLG89MS90LnNldEZyb21NYXRyaXhDb2x1bW4oZSwyKS5sZW5ndGgoKTtyZXR1cm4gclswXT1uWzBdKmksclsxXT1uWzFdKmksclsyXT1uWzJdKmkscls0XT1uWzRdKnMscls1XT1uWzVdKnMscls2XT1uWzZdKnMscls4XT1uWzhdKm8scls5XT1uWzldKm8sclsxMF09blsxMF0qbyx0aGlzfX0oKSxtYWtlUm90YXRpb25Gcm9tRXVsZXI6ZnVuY3Rpb24odCl7dCBpbnN0YW5jZW9mIFRIUkVFLkV1bGVyPT0hMSYmY29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDogLm1ha2VSb3RhdGlvbkZyb21FdWxlcigpIG5vdyBleHBlY3RzIGEgRXVsZXIgcm90YXRpb24gcmF0aGVyIHRoYW4gYSBWZWN0b3IzIGFuZCBvcmRlci5cIik7dmFyIGU9dGhpcy5lbGVtZW50cyxyPXQueCxuPXQueSxpPXQueixzPU1hdGguY29zKHIpLG89TWF0aC5zaW4ociksYT1NYXRoLmNvcyhuKSx1PU1hdGguc2luKG4pLGw9TWF0aC5jb3MoaSksaD1NYXRoLnNpbihpKTtpZihcIlhZWlwiPT09dC5vcmRlcil7dmFyIGM9cypsLG09cypoLGY9bypsLHY9bypoO2VbMF09YSpsLGVbNF09LWEqaCxlWzhdPXUsZVsxXT1tK2YqdSxlWzVdPWMtdip1LGVbOV09LW8qYSxlWzJdPXYtYyp1LGVbNl09ZittKnUsZVsxMF09cyphfWVsc2UgaWYoXCJZWFpcIj09PXQub3JkZXIpe3ZhciB5PWEqbCxFPWEqaCxNPXUqbCx4PXUqaDtlWzBdPXkreCpvLGVbNF09TSpvLUUsZVs4XT1zKnUsZVsxXT1zKmgsZVs1XT1zKmwsZVs5XT0tbyxlWzJdPUUqby1NLGVbNl09eCt5Km8sZVsxMF09cyphfWVsc2UgaWYoXCJaWFlcIj09PXQub3JkZXIpe3ZhciB5PWEqbCxFPWEqaCxNPXUqbCx4PXUqaDtlWzBdPXkteCpvLGVbNF09LXMqaCxlWzhdPU0rRSpvLGVbMV09RStNKm8sZVs1XT1zKmwsZVs5XT14LXkqbyxlWzJdPS1zKnUsZVs2XT1vLGVbMTBdPXMqYX1lbHNlIGlmKFwiWllYXCI9PT10Lm9yZGVyKXt2YXIgYz1zKmwsbT1zKmgsZj1vKmwsdj1vKmg7ZVswXT1hKmwsZVs0XT1mKnUtbSxlWzhdPWMqdSt2LGVbMV09YSpoLGVbNV09dip1K2MsZVs5XT1tKnUtZixlWzJdPS11LGVbNl09byphLGVbMTBdPXMqYX1lbHNlIGlmKFwiWVpYXCI9PT10Lm9yZGVyKXt2YXIgZD1zKmEscD1zKnUsUj1vKmEsVD1vKnU7ZVswXT1hKmwsZVs0XT1ULWQqaCxlWzhdPVIqaCtwLGVbMV09aCxlWzVdPXMqbCxlWzldPS1vKmwsZVsyXT0tdSpsLGVbNl09cCpoK1IsZVsxMF09ZC1UKmh9ZWxzZSBpZihcIlhaWVwiPT09dC5vcmRlcil7dmFyIGQ9cyphLHA9cyp1LFI9byphLFQ9byp1O2VbMF09YSpsLGVbNF09LWgsZVs4XT11KmwsZVsxXT1kKmgrVCxlWzVdPXMqbCxlWzldPXAqaC1SLGVbMl09UipoLXAsZVs2XT1vKmwsZVsxMF09VCpoK2R9cmV0dXJuIGVbM109MCxlWzddPTAsZVsxMV09MCxlWzEyXT0wLGVbMTNdPTAsZVsxNF09MCxlWzE1XT0xLHRoaXN9LG1ha2VSb3RhdGlvbkZyb21RdWF0ZXJuaW9uOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZWxlbWVudHMscj10Lngsbj10LnksaT10Lnoscz10Lncsbz1yK3IsYT1uK24sdT1pK2ksbD1yKm8saD1yKmEsYz1yKnUsbT1uKmEsZj1uKnUsdj1pKnUseT1zKm8sRT1zKmEsTT1zKnU7cmV0dXJuIGVbMF09MS0obSt2KSxlWzRdPWgtTSxlWzhdPWMrRSxlWzFdPWgrTSxlWzVdPTEtKGwrdiksZVs5XT1mLXksZVsyXT1jLUUsZVs2XT1mK3ksZVsxMF09MS0obCttKSxlWzNdPTAsZVs3XT0wLGVbMTFdPTAsZVsxMl09MCxlWzEzXT0wLGVbMTRdPTAsZVsxNV09MSx0aGlzfSxsb29rQXQ6ZnVuY3Rpb24oKXt2YXIgdCxlLHI7cmV0dXJuIGZ1bmN0aW9uKG4saSxzKXt2b2lkIDA9PT10JiYodD1uZXcgVEhSRUUuVmVjdG9yMyxlPW5ldyBUSFJFRS5WZWN0b3IzLHI9bmV3IFRIUkVFLlZlY3RvcjMpO3ZhciBvPXRoaXMuZWxlbWVudHM7cmV0dXJuIHIuc3ViVmVjdG9ycyhuLGkpLm5vcm1hbGl6ZSgpLDA9PT1yLmxlbmd0aFNxKCkmJihyLno9MSksdC5jcm9zc1ZlY3RvcnMocyxyKS5ub3JtYWxpemUoKSwwPT09dC5sZW5ndGhTcSgpJiYoci56Kz0xZS00LHQuY3Jvc3NWZWN0b3JzKHMscikubm9ybWFsaXplKCkpLGUuY3Jvc3NWZWN0b3JzKHIsdCksb1swXT10Lngsb1s0XT1lLngsb1s4XT1yLngsb1sxXT10Lnksb1s1XT1lLnksb1s5XT1yLnksb1syXT10Lnosb1s2XT1lLnosb1sxMF09ci56LHRoaXN9fSgpLG11bHRpcGx5OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMCE9PWU/KGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDQ6IC5tdWx0aXBseSgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLm11bHRpcGx5TWF0cmljZXMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLm11bHRpcGx5TWF0cmljZXModCxlKSk6dGhpcy5tdWx0aXBseU1hdHJpY2VzKHRoaXMsdCl9LHByZW11bHRpcGx5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXModCx0aGlzKX0sbXVsdGlwbHlNYXRyaWNlczpmdW5jdGlvbih0LGUpe3ZhciByPXQuZWxlbWVudHMsbj1lLmVsZW1lbnRzLGk9dGhpcy5lbGVtZW50cyxzPXJbMF0sbz1yWzRdLGE9cls4XSx1PXJbMTJdLGw9clsxXSxoPXJbNV0sYz1yWzldLG09clsxM10sZj1yWzJdLHY9cls2XSx5PXJbMTBdLEU9clsxNF0sTT1yWzNdLHg9cls3XSxkPXJbMTFdLHA9clsxNV0sUj1uWzBdLFQ9bls0XSxnPW5bOF0sej1uWzEyXSxIPW5bMV0sdz1uWzVdLGs9bls5XSxBPW5bMTNdLEY9blsyXSxWPW5bNl0sWD1uWzEwXSxZPW5bMTRdLFo9blszXSxDPW5bN10sUD1uWzExXSxTPW5bMTVdO3JldHVybiBpWzBdPXMqUitvKkgrYSpGK3UqWixpWzRdPXMqVCtvKncrYSpWK3UqQyxpWzhdPXMqZytvKmsrYSpYK3UqUCxpWzEyXT1zKnorbypBK2EqWSt1KlMsaVsxXT1sKlIraCpIK2MqRittKlosaVs1XT1sKlQraCp3K2MqVittKkMsaVs5XT1sKmcraCprK2MqWCttKlAsaVsxM109bCp6K2gqQStjKlkrbSpTLGlbMl09ZipSK3YqSCt5KkYrRSpaLGlbNl09ZipUK3Yqdyt5KlYrRSpDLGlbMTBdPWYqZyt2KmsreSpYK0UqUCxpWzE0XT1mKnordipBK3kqWStFKlMsaVszXT1NKlIreCpIK2QqRitwKlosaVs3XT1NKlQreCp3K2QqVitwKkMsaVsxMV09TSpnK3gqaytkKlgrcCpQLGlbMTVdPU0qeit4KkErZCpZK3AqUyx0aGlzfSxtdWx0aXBseVRvQXJyYXk6ZnVuY3Rpb24odCxlLHIpe3ZhciBuPXRoaXMuZWxlbWVudHM7cmV0dXJuIHRoaXMubXVsdGlwbHlNYXRyaWNlcyh0LGUpLHJbMF09blswXSxyWzFdPW5bMV0sclsyXT1uWzJdLHJbM109blszXSxyWzRdPW5bNF0scls1XT1uWzVdLHJbNl09bls2XSxyWzddPW5bN10scls4XT1uWzhdLHJbOV09bls5XSxyWzEwXT1uWzEwXSxyWzExXT1uWzExXSxyWzEyXT1uWzEyXSxyWzEzXT1uWzEzXSxyWzE0XT1uWzE0XSxyWzE1XT1uWzE1XSx0aGlzfSxtdWx0aXBseVNjYWxhcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmVsZW1lbnRzO3JldHVybiBlWzBdKj10LGVbNF0qPXQsZVs4XSo9dCxlWzEyXSo9dCxlWzFdKj10LGVbNV0qPXQsZVs5XSo9dCxlWzEzXSo9dCxlWzJdKj10LGVbNl0qPXQsZVsxMF0qPXQsZVsxNF0qPXQsZVszXSo9dCxlWzddKj10LGVbMTFdKj10LGVbMTVdKj10LHRoaXN9LGFwcGx5VG9WZWN0b3IzQXJyYXk6ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4gZnVuY3Rpb24oZSxyLG4pe3ZvaWQgMD09PXQmJih0PW5ldyBUSFJFRS5WZWN0b3IzKSx2b2lkIDA9PT1yJiYocj0wKSx2b2lkIDA9PT1uJiYobj1lLmxlbmd0aCk7Zm9yKHZhciBpPTAscz1yO2k8bjtpKz0zLHMrPTMpdC5mcm9tQXJyYXkoZSxzKSx0LmFwcGx5TWF0cml4NCh0aGlzKSx0LnRvQXJyYXkoZSxzKTtyZXR1cm4gZX19KCksYXBwbHlUb0J1ZmZlcjpmdW5jdGlvbigpe3ZhciB0O3JldHVybiBmdW5jdGlvbihlLHIsbil7dm9pZCAwPT09dCYmKHQ9bmV3IFRIUkVFLlZlY3RvcjMpLHZvaWQgMD09PXImJihyPTApLHZvaWQgMD09PW4mJihuPWUubGVuZ3RoL2UuaXRlbVNpemUpO2Zvcih2YXIgaT0wLHM9cjtpPG47aSsrLHMrKyl0Lng9ZS5nZXRYKHMpLHQueT1lLmdldFkocyksdC56PWUuZ2V0WihzKSx0LmFwcGx5TWF0cml4NCh0aGlzKSxlLnNldFhZWih0LngsdC55LHQueik7cmV0dXJuIGV9fSgpLGRldGVybWluYW50OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50cyxlPXRbMF0scj10WzRdLG49dFs4XSxpPXRbMTJdLHM9dFsxXSxvPXRbNV0sYT10WzldLHU9dFsxM10sbD10WzJdLGg9dFs2XSxjPXRbMTBdLG09dFsxNF0sZj10WzNdLHY9dFs3XSx5PXRbMTFdLEU9dFsxNV07cmV0dXJuIGYqKCtpKmEqaC1uKnUqaC1pKm8qYytyKnUqYytuKm8qbS1yKmEqbSkrdiooK2UqYSptLWUqdSpjK2kqcypjLW4qcyptK24qdSpsLWkqYSpsKSt5KigrZSp1KmgtZSpvKm0taSpzKmgrcipzKm0raSpvKmwtcip1KmwpK0UqKC1uKm8qbC1lKmEqaCtlKm8qYytuKnMqaC1yKnMqYytyKmEqbCl9LHRyYW5zcG9zZTpmdW5jdGlvbigpe3ZhciB0LGU9dGhpcy5lbGVtZW50cztyZXR1cm4gdD1lWzFdLGVbMV09ZVs0XSxlWzRdPXQsdD1lWzJdLGVbMl09ZVs4XSxlWzhdPXQsdD1lWzZdLGVbNl09ZVs5XSxlWzldPXQsdD1lWzNdLGVbM109ZVsxMl0sZVsxMl09dCx0PWVbN10sZVs3XT1lWzEzXSxlWzEzXT10LHQ9ZVsxMV0sZVsxMV09ZVsxNF0sZVsxNF09dCx0aGlzfSxmbGF0dGVuVG9BcnJheU9mZnNldDpmdW5jdGlvbih0LGUpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXgzOiAuZmxhdHRlblRvQXJyYXlPZmZzZXQgaXMgZGVwcmVjYXRlZCAtIGp1c3QgdXNlIC50b0FycmF5IGluc3RlYWQuXCIpLHRoaXMudG9BcnJheSh0LGUpfSxnZXRQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0O3JldHVybiBmdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT10JiYodD1uZXcgVEhSRUUuVmVjdG9yMyksY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4NDogLmdldFBvc2l0aW9uKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIFZlY3RvcjMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKCBtYXRyaXggKSBpbnN0ZWFkLlwiKSx0LnNldEZyb21NYXRyaXhDb2x1bW4odGhpcywzKX19KCksc2V0UG9zaXRpb246ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbGVtZW50cztyZXR1cm4gZVsxMl09dC54LGVbMTNdPXQueSxlWzE0XT10LnosdGhpc30sZ2V0SW52ZXJzZTpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuZWxlbWVudHMsbj10LmVsZW1lbnRzLGk9blswXSxzPW5bMV0sbz1uWzJdLGE9blszXSx1PW5bNF0sbD1uWzVdLGg9bls2XSxjPW5bN10sbT1uWzhdLGY9bls5XSx2PW5bMTBdLHk9blsxMV0sRT1uWzEyXSxNPW5bMTNdLHg9blsxNF0sZD1uWzE1XSxwPWYqeCpjLU0qdipjK00qaCp5LWwqeCp5LWYqaCpkK2wqdipkLFI9RSp2KmMtbSp4KmMtRSpoKnkrdSp4KnkrbSpoKmQtdSp2KmQsVD1tKk0qYy1FKmYqYytFKmwqeS11Kk0qeS1tKmwqZCt1KmYqZCxnPUUqZipoLW0qTSpoLUUqbCp2K3UqTSp2K20qbCp4LXUqZip4LHo9aSpwK3MqUitvKlQrYSpnO2lmKDA9PT16KXt2YXIgSD1cIlRIUkVFLk1hdHJpeDQuZ2V0SW52ZXJzZSgpOiBjYW4ndCBpbnZlcnQgbWF0cml4LCBkZXRlcm1pbmFudCBpcyAwXCI7aWYoZSl0aHJvdyBuZXcgRXJyb3IoSCk7cmV0dXJuIGNvbnNvbGUud2FybihIKSx0aGlzLmlkZW50aXR5KCl9dmFyIHc9MS96O3JldHVybiByWzBdPXAqdyxyWzFdPShNKnYqYS1mKngqYS1NKm8qeStzKngqeStmKm8qZC1zKnYqZCkqdyxyWzJdPShsKngqYS1NKmgqYStNKm8qYy1zKngqYy1sKm8qZCtzKmgqZCkqdyxyWzNdPShmKmgqYS1sKnYqYS1mKm8qYytzKnYqYytsKm8qeS1zKmgqeSkqdyxyWzRdPVIqdyxyWzVdPShtKngqYS1FKnYqYStFKm8qeS1pKngqeS1tKm8qZCtpKnYqZCkqdyxyWzZdPShFKmgqYS11KngqYS1FKm8qYytpKngqYyt1Km8qZC1pKmgqZCkqdyxyWzddPSh1KnYqYS1tKmgqYSttKm8qYy1pKnYqYy11Km8qeStpKmgqeSkqdyxyWzhdPVQqdyxyWzldPShFKmYqYS1tKk0qYS1FKnMqeStpKk0qeSttKnMqZC1pKmYqZCkqdyxyWzEwXT0odSpNKmEtRSpsKmErRSpzKmMtaSpNKmMtdSpzKmQraSpsKmQpKncsclsxMV09KG0qbCphLXUqZiphLW0qcypjK2kqZipjK3Uqcyp5LWkqbCp5KSp3LHJbMTJdPWcqdyxyWzEzXT0obSpNKm8tRSpmKm8rRSpzKnYtaSpNKnYtbSpzKngraSpmKngpKncsclsxNF09KEUqbCpvLXUqTSpvLUUqcypoK2kqTSpoK3Uqcyp4LWkqbCp4KSp3LHJbMTVdPSh1KmYqby1tKmwqbyttKnMqaC1pKmYqaC11KnMqditpKmwqdikqdyx0aGlzfSxzY2FsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmVsZW1lbnRzLHI9dC54LG49dC55LGk9dC56O3JldHVybiBlWzBdKj1yLGVbNF0qPW4sZVs4XSo9aSxlWzFdKj1yLGVbNV0qPW4sZVs5XSo9aSxlWzJdKj1yLGVbNl0qPW4sZVsxMF0qPWksZVszXSo9cixlWzddKj1uLGVbMTFdKj1pLHRoaXN9LGdldE1heFNjYWxlT25BeGlzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50cyxlPXRbMF0qdFswXSt0WzFdKnRbMV0rdFsyXSp0WzJdLHI9dFs0XSp0WzRdK3RbNV0qdFs1XSt0WzZdKnRbNl0sbj10WzhdKnRbOF0rdFs5XSp0WzldK3RbMTBdKnRbMTBdO3JldHVybiBNYXRoLnNxcnQoTWF0aC5tYXgoZSxyLG4pKX0sbWFrZVRyYW5zbGF0aW9uOmZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdGhpcy5zZXQoMSwwLDAsdCwwLDEsMCxlLDAsMCwxLHIsMCwwLDAsMSksdGhpc30sbWFrZVJvdGF0aW9uWDpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmNvcyh0KSxyPU1hdGguc2luKHQpO3JldHVybiB0aGlzLnNldCgxLDAsMCwwLDAsZSwtciwwLDAscixlLDAsMCwwLDAsMSksdGhpc30sbWFrZVJvdGF0aW9uWTpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmNvcyh0KSxyPU1hdGguc2luKHQpO3JldHVybiB0aGlzLnNldChlLDAsciwwLDAsMSwwLDAsLXIsMCxlLDAsMCwwLDAsMSksdGhpc30sbWFrZVJvdGF0aW9uWjpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmNvcyh0KSxyPU1hdGguc2luKHQpO3JldHVybiB0aGlzLnNldChlLC1yLDAsMCxyLGUsMCwwLDAsMCwxLDAsMCwwLDAsMSksdGhpc30sbWFrZVJvdGF0aW9uQXhpczpmdW5jdGlvbih0LGUpe3ZhciByPU1hdGguY29zKGUpLG49TWF0aC5zaW4oZSksaT0xLXIscz10Lngsbz10LnksYT10LnosdT1pKnMsbD1pKm87cmV0dXJuIHRoaXMuc2V0KHUqcytyLHUqby1uKmEsdSphK24qbywwLHUqbytuKmEsbCpvK3IsbCphLW4qcywwLHUqYS1uKm8sbCphK24qcyxpKmEqYStyLDAsMCwwLDAsMSksdGhpc30sbWFrZVNjYWxlOmZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gdGhpcy5zZXQodCwwLDAsMCwwLGUsMCwwLDAsMCxyLDAsMCwwLDAsMSksdGhpc30sY29tcG9zZTpmdW5jdGlvbih0LGUscil7cmV0dXJuIHRoaXMubWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24oZSksdGhpcy5zY2FsZShyKSx0aGlzLnNldFBvc2l0aW9uKHQpLHRoaXN9LGRlY29tcG9zZTpmdW5jdGlvbigpe3ZhciB0LGU7cmV0dXJuIGZ1bmN0aW9uKHIsbixpKXt2b2lkIDA9PT10JiYodD1uZXcgVEhSRUUuVmVjdG9yMyxlPW5ldyBUSFJFRS5NYXRyaXg0KTt2YXIgcz10aGlzLmVsZW1lbnRzLG89dC5zZXQoc1swXSxzWzFdLHNbMl0pLmxlbmd0aCgpLGE9dC5zZXQoc1s0XSxzWzVdLHNbNl0pLmxlbmd0aCgpLHU9dC5zZXQoc1s4XSxzWzldLHNbMTBdKS5sZW5ndGgoKSxsPXRoaXMuZGV0ZXJtaW5hbnQoKTtsPDAmJihvPS1vKSxyLng9c1sxMl0sci55PXNbMTNdLHIuej1zWzE0XSxlLmVsZW1lbnRzLnNldCh0aGlzLmVsZW1lbnRzKTt2YXIgaD0xL28sYz0xL2EsbT0xL3U7cmV0dXJuIGUuZWxlbWVudHNbMF0qPWgsZS5lbGVtZW50c1sxXSo9aCxlLmVsZW1lbnRzWzJdKj1oLGUuZWxlbWVudHNbNF0qPWMsZS5lbGVtZW50c1s1XSo9YyxlLmVsZW1lbnRzWzZdKj1jLGUuZWxlbWVudHNbOF0qPW0sZS5lbGVtZW50c1s5XSo9bSxlLmVsZW1lbnRzWzEwXSo9bSxuLnNldEZyb21Sb3RhdGlvbk1hdHJpeChlKSxpLng9byxpLnk9YSxpLno9dSx0aGlzfX0oKSxtYWtlRnJ1c3R1bTpmdW5jdGlvbih0LGUscixuLGkscyl7dmFyIG89dGhpcy5lbGVtZW50cyxhPTIqaS8oZS10KSx1PTIqaS8obi1yKSxsPShlK3QpLyhlLXQpLGg9KG4rcikvKG4tciksYz0tKHMraSkvKHMtaSksbT0tMipzKmkvKHMtaSk7cmV0dXJuIG9bMF09YSxvWzRdPTAsb1s4XT1sLG9bMTJdPTAsb1sxXT0wLG9bNV09dSxvWzldPWgsb1sxM109MCxvWzJdPTAsb1s2XT0wLG9bMTBdPWMsb1sxNF09bSxvWzNdPTAsb1s3XT0wLG9bMTFdPS0xLG9bMTVdPTAsdGhpc30sbWFrZVBlcnNwZWN0aXZlOmZ1bmN0aW9uKHQsZSxyLG4pe3ZhciBpPXIqTWF0aC50YW4oVEhSRUUuTWF0aC5ERUcyUkFEKnQqLjUpLHM9LWksbz1zKmUsYT1pKmU7cmV0dXJuIHRoaXMubWFrZUZydXN0dW0obyxhLHMsaSxyLG4pfSxtYWtlT3J0aG9ncmFwaGljOmZ1bmN0aW9uKHQsZSxyLG4saSxzKXt2YXIgbz10aGlzLmVsZW1lbnRzLGE9MS8oZS10KSx1PTEvKHItbiksbD0xLyhzLWkpLGg9KGUrdCkqYSxjPShyK24pKnUsbT0ocytpKSpsO3JldHVybiBvWzBdPTIqYSxvWzRdPTAsb1s4XT0wLG9bMTJdPS1oLG9bMV09MCxvWzVdPTIqdSxvWzldPTAsb1sxM109LWMsb1syXT0wLG9bNl09MCxvWzEwXT0tMipsLG9bMTRdPS1tLG9bM109MCxvWzddPTAsb1sxMV09MCxvWzE1XT0xLHRoaXN9LGVxdWFsczpmdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy5lbGVtZW50cyxyPXQuZWxlbWVudHMsbj0wO248MTY7bisrKWlmKGVbbl0hPT1yW25dKXJldHVybiExO3JldHVybiEwfSxmcm9tQXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZWxlbWVudHMuc2V0KHQpLHRoaXN9LHRvQXJyYXk6ZnVuY3Rpb24odCxlKXt2b2lkIDA9PT10JiYodD1bXSksdm9pZCAwPT09ZSYmKGU9MCk7dmFyIHI9dGhpcy5lbGVtZW50cztyZXR1cm4gdFtlXT1yWzBdLHRbZSsxXT1yWzFdLHRbZSsyXT1yWzJdLHRbZSszXT1yWzNdLHRbZSs0XT1yWzRdLHRbZSs1XT1yWzVdLHRbZSs2XT1yWzZdLHRbZSs3XT1yWzddLHRbZSs4XT1yWzhdLHRbZSs5XT1yWzldLHRbZSsxMF09clsxMF0sdFtlKzExXT1yWzExXSx0W2UrMTJdPXJbMTJdLHRbZSsxM109clsxM10sdFtlKzE0XT1yWzE0XSx0W2UrMTVdPXJbMTVdLHR9fTsiLCJUSFJFRS5RdWF0ZXJuaW9uPWZ1bmN0aW9uKHQsaSxzLGgpe3RoaXMuX3g9dHx8MCx0aGlzLl95PWl8fDAsdGhpcy5fej1zfHwwLHRoaXMuX3c9dm9pZCAwIT09aD9oOjF9LFRIUkVFLlF1YXRlcm5pb24ucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpUSFJFRS5RdWF0ZXJuaW9uLGdldCB4KCl7cmV0dXJuIHRoaXMuX3h9LHNldCB4KHQpe3RoaXMuX3g9dCx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKX0sZ2V0IHkoKXtyZXR1cm4gdGhpcy5feX0sc2V0IHkodCl7dGhpcy5feT10LHRoaXMub25DaGFuZ2VDYWxsYmFjaygpfSxnZXQgeigpe3JldHVybiB0aGlzLl96fSxzZXQgeih0KXt0aGlzLl96PXQsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCl9LGdldCB3KCl7cmV0dXJuIHRoaXMuX3d9LHNldCB3KHQpe3RoaXMuX3c9dCx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKX0sc2V0OmZ1bmN0aW9uKHQsaSxzLGgpe3JldHVybiB0aGlzLl94PXQsdGhpcy5feT1pLHRoaXMuX3o9cyx0aGlzLl93PWgsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCksdGhpc30sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCx0aGlzLl95LHRoaXMuX3osdGhpcy5fdyl9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3g9dC54LHRoaXMuX3k9dC55LHRoaXMuX3o9dC56LHRoaXMuX3c9dC53LHRoaXMub25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9LHNldEZyb21FdWxlcjpmdW5jdGlvbih0LGkpe2lmKHQgaW5zdGFuY2VvZiBUSFJFRS5FdWxlcj09ITEpdGhyb3cgbmV3IEVycm9yKFwiVEhSRUUuUXVhdGVybmlvbjogLnNldEZyb21FdWxlcigpIG5vdyBleHBlY3RzIGEgRXVsZXIgcm90YXRpb24gcmF0aGVyIHRoYW4gYSBWZWN0b3IzIGFuZCBvcmRlci5cIik7dmFyIHM9TWF0aC5jb3ModC5feC8yKSxoPU1hdGguY29zKHQuX3kvMiksbj1NYXRoLmNvcyh0Ll96LzIpLF89TWF0aC5zaW4odC5feC8yKSxyPU1hdGguc2luKHQuX3kvMiksZT1NYXRoLnNpbih0Ll96LzIpLGE9dC5vcmRlcjtyZXR1cm5cIlhZWlwiPT09YT8odGhpcy5feD1fKmgqbitzKnIqZSx0aGlzLl95PXMqcipuLV8qaCplLHRoaXMuX3o9cypoKmUrXypyKm4sdGhpcy5fdz1zKmgqbi1fKnIqZSk6XCJZWFpcIj09PWE/KHRoaXMuX3g9XypoKm4rcypyKmUsdGhpcy5feT1zKnIqbi1fKmgqZSx0aGlzLl96PXMqaCplLV8qcipuLHRoaXMuX3c9cypoKm4rXypyKmUpOlwiWlhZXCI9PT1hPyh0aGlzLl94PV8qaCpuLXMqciplLHRoaXMuX3k9cypyKm4rXypoKmUsdGhpcy5fej1zKmgqZStfKnIqbix0aGlzLl93PXMqaCpuLV8qciplKTpcIlpZWFwiPT09YT8odGhpcy5feD1fKmgqbi1zKnIqZSx0aGlzLl95PXMqcipuK18qaCplLHRoaXMuX3o9cypoKmUtXypyKm4sdGhpcy5fdz1zKmgqbitfKnIqZSk6XCJZWlhcIj09PWE/KHRoaXMuX3g9XypoKm4rcypyKmUsdGhpcy5feT1zKnIqbitfKmgqZSx0aGlzLl96PXMqaCplLV8qcipuLHRoaXMuX3c9cypoKm4tXypyKmUpOlwiWFpZXCI9PT1hJiYodGhpcy5feD1fKmgqbi1zKnIqZSx0aGlzLl95PXMqcipuLV8qaCplLHRoaXMuX3o9cypoKmUrXypyKm4sdGhpcy5fdz1zKmgqbitfKnIqZSksaSE9PSExJiZ0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfSxzZXRGcm9tQXhpc0FuZ2xlOmZ1bmN0aW9uKHQsaSl7dmFyIHM9aS8yLGg9TWF0aC5zaW4ocyk7cmV0dXJuIHRoaXMuX3g9dC54KmgsdGhpcy5feT10LnkqaCx0aGlzLl96PXQueipoLHRoaXMuX3c9TWF0aC5jb3MocyksdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCksdGhpc30sc2V0RnJvbVJvdGF0aW9uTWF0cml4OmZ1bmN0aW9uKHQpe3ZhciBpLHM9dC5lbGVtZW50cyxoPXNbMF0sbj1zWzRdLF89c1s4XSxyPXNbMV0sZT1zWzVdLGE9c1s5XSxvPXNbMl0sdT1zWzZdLGM9c1sxMF0sbD1oK2UrYztyZXR1cm4gbD4wPyhpPS41L01hdGguc3FydChsKzEpLHRoaXMuX3c9LjI1L2ksdGhpcy5feD0odS1hKSppLHRoaXMuX3k9KF8tbykqaSx0aGlzLl96PShyLW4pKmkpOmg+ZSYmaD5jPyhpPTIqTWF0aC5zcXJ0KDEraC1lLWMpLHRoaXMuX3c9KHUtYSkvaSx0aGlzLl94PS4yNSppLHRoaXMuX3k9KG4rcikvaSx0aGlzLl96PShfK28pL2kpOmU+Yz8oaT0yKk1hdGguc3FydCgxK2UtaC1jKSx0aGlzLl93PShfLW8pL2ksdGhpcy5feD0obityKS9pLHRoaXMuX3k9LjI1KmksdGhpcy5fej0oYSt1KS9pKTooaT0yKk1hdGguc3FydCgxK2MtaC1lKSx0aGlzLl93PShyLW4pL2ksdGhpcy5feD0oXytvKS9pLHRoaXMuX3k9KGErdSkvaSx0aGlzLl96PS4yNSppKSx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfSxzZXRGcm9tVW5pdFZlY3RvcnM6ZnVuY3Rpb24oKXt2YXIgdCxpLHM9MWUtNjtyZXR1cm4gZnVuY3Rpb24oaCxuKXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9bmV3IFRIUkVFLlZlY3RvcjMpLGk9aC5kb3QobikrMSxpPHM/KGk9MCxNYXRoLmFicyhoLngpPk1hdGguYWJzKGgueik/dC5zZXQoLWgueSxoLngsMCk6dC5zZXQoMCwtaC56LGgueSkpOnQuY3Jvc3NWZWN0b3JzKGgsbiksdGhpcy5feD10LngsdGhpcy5feT10LnksdGhpcy5fej10LnosdGhpcy5fdz1pLHRoaXMubm9ybWFsaXplKCl9fSgpLGludmVyc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb25qdWdhdGUoKS5ub3JtYWxpemUoKX0sY29uanVnYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3gqPS0xLHRoaXMuX3kqPS0xLHRoaXMuX3oqPS0xLHRoaXMub25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9LGRvdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5feCp0Ll94K3RoaXMuX3kqdC5feSt0aGlzLl96KnQuX3ordGhpcy5fdyp0Ll93fSxsZW5ndGhTcTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl94KnRoaXMuX3grdGhpcy5feSp0aGlzLl95K3RoaXMuX3oqdGhpcy5feit0aGlzLl93KnRoaXMuX3d9LGxlbmd0aDpmdW5jdGlvbigpe3JldHVybiBNYXRoLnNxcnQodGhpcy5feCp0aGlzLl94K3RoaXMuX3kqdGhpcy5feSt0aGlzLl96KnRoaXMuX3ordGhpcy5fdyp0aGlzLl93KX0sbm9ybWFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5sZW5ndGgoKTtyZXR1cm4gMD09PXQ/KHRoaXMuX3g9MCx0aGlzLl95PTAsdGhpcy5fej0wLHRoaXMuX3c9MSk6KHQ9MS90LHRoaXMuX3g9dGhpcy5feCp0LHRoaXMuX3k9dGhpcy5feSp0LHRoaXMuX3o9dGhpcy5feip0LHRoaXMuX3c9dGhpcy5fdyp0KSx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfSxtdWx0aXBseTpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDAhPT1pPyhjb25zb2xlLndhcm4oXCJUSFJFRS5RdWF0ZXJuaW9uOiAubXVsdGlwbHkoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5tdWx0aXBseVF1YXRlcm5pb25zKCBhLCBiICkgaW5zdGVhZC5cIiksdGhpcy5tdWx0aXBseVF1YXRlcm5pb25zKHQsaSkpOnRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyh0aGlzLHQpfSxwcmVtdWx0aXBseTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVF1YXRlcm5pb25zKHQsdGhpcyl9LG11bHRpcGx5UXVhdGVybmlvbnM6ZnVuY3Rpb24odCxpKXt2YXIgcz10Ll94LGg9dC5feSxuPXQuX3osXz10Ll93LHI9aS5feCxlPWkuX3ksYT1pLl96LG89aS5fdztyZXR1cm4gdGhpcy5feD1zKm8rXypyK2gqYS1uKmUsdGhpcy5feT1oKm8rXyplK24qci1zKmEsdGhpcy5fej1uKm8rXyphK3MqZS1oKnIsdGhpcy5fdz1fKm8tcypyLWgqZS1uKmEsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCksdGhpc30sc2xlcnA6ZnVuY3Rpb24odCxpKXtpZigwPT09aSlyZXR1cm4gdGhpcztpZigxPT09aSlyZXR1cm4gdGhpcy5jb3B5KHQpO3ZhciBzPXRoaXMuX3gsaD10aGlzLl95LG49dGhpcy5feixfPXRoaXMuX3cscj1fKnQuX3crcyp0Ll94K2gqdC5feStuKnQuX3o7aWYocjwwPyh0aGlzLl93PS10Ll93LHRoaXMuX3g9LXQuX3gsdGhpcy5feT0tdC5feSx0aGlzLl96PS10Ll96LHI9LXIpOnRoaXMuY29weSh0KSxyPj0xKXJldHVybiB0aGlzLl93PV8sdGhpcy5feD1zLHRoaXMuX3k9aCx0aGlzLl96PW4sdGhpczt2YXIgZT1NYXRoLnNxcnQoMS1yKnIpO2lmKE1hdGguYWJzKGUpPC4wMDEpcmV0dXJuIHRoaXMuX3c9LjUqKF8rdGhpcy5fdyksdGhpcy5feD0uNSoocyt0aGlzLl94KSx0aGlzLl95PS41KihoK3RoaXMuX3kpLHRoaXMuX3o9LjUqKG4rdGhpcy5feiksdGhpczt2YXIgYT1NYXRoLmF0YW4yKGUsciksbz1NYXRoLnNpbigoMS1pKSphKS9lLHU9TWF0aC5zaW4oaSphKS9lO3JldHVybiB0aGlzLl93PV8qbyt0aGlzLl93KnUsdGhpcy5feD1zKm8rdGhpcy5feCp1LHRoaXMuX3k9aCpvK3RoaXMuX3kqdSx0aGlzLl96PW4qbyt0aGlzLl96KnUsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCksdGhpc30sZXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0Ll94PT09dGhpcy5feCYmdC5feT09PXRoaXMuX3kmJnQuX3o9PT10aGlzLl96JiZ0Ll93PT09dGhpcy5fd30sZnJvbUFycmF5OmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHZvaWQgMD09PWkmJihpPTApLHRoaXMuX3g9dFtpXSx0aGlzLl95PXRbaSsxXSx0aGlzLl96PXRbaSsyXSx0aGlzLl93PXRbaSszXSx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfSx0b0FycmF5OmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHZvaWQgMD09PXQmJih0PVtdKSx2b2lkIDA9PT1pJiYoaT0wKSx0W2ldPXRoaXMuX3gsdFtpKzFdPXRoaXMuX3ksdFtpKzJdPXRoaXMuX3osdFtpKzNdPXRoaXMuX3csdH0sb25DaGFuZ2U6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub25DaGFuZ2VDYWxsYmFjaz10LHRoaXN9LG9uQ2hhbmdlQ2FsbGJhY2s6ZnVuY3Rpb24oKXt9fSxPYmplY3QuYXNzaWduKFRIUkVFLlF1YXRlcm5pb24se3NsZXJwOmZ1bmN0aW9uKHQsaSxzLGgpe3JldHVybiBzLmNvcHkodCkuc2xlcnAoaSxoKX0sc2xlcnBGbGF0OmZ1bmN0aW9uKHQsaSxzLGgsbixfLHIpe3ZhciBlPXNbaCswXSxhPXNbaCsxXSxvPXNbaCsyXSx1PXNbaCszXSxjPW5bXyswXSxsPW5bXysxXSx5PW5bXysyXSx4PW5bXyszXTtpZih1IT09eHx8ZSE9PWN8fGEhPT1sfHxvIT09eSl7dmFyIHo9MS1yLHc9ZSpjK2EqbCtvKnkrdSp4LGY9dz49MD8xOi0xLGI9MS13Knc7aWYoYj5OdW1iZXIuRVBTSUxPTil7dmFyIEM9TWF0aC5zcXJ0KGIpLGc9TWF0aC5hdGFuMihDLHcqZik7ej1NYXRoLnNpbih6KmcpL0Mscj1NYXRoLnNpbihyKmcpL0N9dmFyIE09cipmO2lmKGU9ZSp6K2MqTSxhPWEqeitsKk0sbz1vKnoreSpNLHU9dSp6K3gqTSx6PT09MS1yKXt2YXIgRT0xL01hdGguc3FydChlKmUrYSphK28qbyt1KnUpO2UqPUUsYSo9RSxvKj1FLHUqPUV9fXRbaV09ZSx0W2krMV09YSx0W2krMl09byx0W2krM109dX19KTsiLCJUSFJFRS5FdWxlcj1mdW5jdGlvbih0LGksaCxuKXt0aGlzLl94PXR8fDAsdGhpcy5feT1pfHwwLHRoaXMuX3o9aHx8MCx0aGlzLl9vcmRlcj1ufHxUSFJFRS5FdWxlci5EZWZhdWx0T3JkZXJ9LFRIUkVFLkV1bGVyLlJvdGF0aW9uT3JkZXJzPVtcIlhZWlwiLFwiWVpYXCIsXCJaWFlcIixcIlhaWVwiLFwiWVhaXCIsXCJaWVhcIl0sVEhSRUUuRXVsZXIuRGVmYXVsdE9yZGVyPVwiWFlaXCIsVEhSRUUuRXVsZXIucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpUSFJFRS5FdWxlcixnZXQgeCgpe3JldHVybiB0aGlzLl94fSxzZXQgeCh0KXt0aGlzLl94PXQsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCl9LGdldCB5KCl7cmV0dXJuIHRoaXMuX3l9LHNldCB5KHQpe3RoaXMuX3k9dCx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKX0sZ2V0IHooKXtyZXR1cm4gdGhpcy5fen0sc2V0IHoodCl7dGhpcy5fej10LHRoaXMub25DaGFuZ2VDYWxsYmFjaygpfSxnZXQgb3JkZXIoKXtyZXR1cm4gdGhpcy5fb3JkZXJ9LHNldCBvcmRlcih0KXt0aGlzLl9vcmRlcj10LHRoaXMub25DaGFuZ2VDYWxsYmFjaygpfSxzZXQ6ZnVuY3Rpb24odCxpLGgsbil7cmV0dXJuIHRoaXMuX3g9dCx0aGlzLl95PWksdGhpcy5fej1oLHRoaXMuX29yZGVyPW58fHRoaXMuX29yZGVyLHRoaXMub25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3gsdGhpcy5feSx0aGlzLl96LHRoaXMuX29yZGVyKX0sY29weTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5feD10Ll94LHRoaXMuX3k9dC5feSx0aGlzLl96PXQuX3osdGhpcy5fb3JkZXI9dC5fb3JkZXIsdGhpcy5vbkNoYW5nZUNhbGxiYWNrKCksdGhpc30sc2V0RnJvbVJvdGF0aW9uTWF0cml4OmZ1bmN0aW9uKHQsaSxoKXt2YXIgbj1USFJFRS5NYXRoLmNsYW1wLGE9dC5lbGVtZW50cyxzPWFbMF0scj1hWzRdLGU9YVs4XSxvPWFbMV0sXz1hWzVdLGM9YVs5XSx1PWFbMl0sbD1hWzZdLE09YVsxMF07cmV0dXJuIGk9aXx8dGhpcy5fb3JkZXIsXCJYWVpcIj09PWk/KHRoaXMuX3k9TWF0aC5hc2luKG4oZSwtMSwxKSksTWF0aC5hYnMoZSk8Ljk5OTk5Pyh0aGlzLl94PU1hdGguYXRhbjIoLWMsTSksdGhpcy5fej1NYXRoLmF0YW4yKC1yLHMpKToodGhpcy5feD1NYXRoLmF0YW4yKGwsXyksdGhpcy5fej0wKSk6XCJZWFpcIj09PWk/KHRoaXMuX3g9TWF0aC5hc2luKC1uKGMsLTEsMSkpLE1hdGguYWJzKGMpPC45OTk5OT8odGhpcy5feT1NYXRoLmF0YW4yKGUsTSksdGhpcy5fej1NYXRoLmF0YW4yKG8sXykpOih0aGlzLl95PU1hdGguYXRhbjIoLXUscyksdGhpcy5fej0wKSk6XCJaWFlcIj09PWk/KHRoaXMuX3g9TWF0aC5hc2luKG4obCwtMSwxKSksTWF0aC5hYnMobCk8Ljk5OTk5Pyh0aGlzLl95PU1hdGguYXRhbjIoLXUsTSksdGhpcy5fej1NYXRoLmF0YW4yKC1yLF8pKToodGhpcy5feT0wLHRoaXMuX3o9TWF0aC5hdGFuMihvLHMpKSk6XCJaWVhcIj09PWk/KHRoaXMuX3k9TWF0aC5hc2luKC1uKHUsLTEsMSkpLE1hdGguYWJzKHUpPC45OTk5OT8odGhpcy5feD1NYXRoLmF0YW4yKGwsTSksdGhpcy5fej1NYXRoLmF0YW4yKG8scykpOih0aGlzLl94PTAsdGhpcy5fej1NYXRoLmF0YW4yKC1yLF8pKSk6XCJZWlhcIj09PWk/KHRoaXMuX3o9TWF0aC5hc2luKG4obywtMSwxKSksTWF0aC5hYnMobyk8Ljk5OTk5Pyh0aGlzLl94PU1hdGguYXRhbjIoLWMsXyksdGhpcy5feT1NYXRoLmF0YW4yKC11LHMpKToodGhpcy5feD0wLHRoaXMuX3k9TWF0aC5hdGFuMihlLE0pKSk6XCJYWllcIj09PWk/KHRoaXMuX3o9TWF0aC5hc2luKC1uKHIsLTEsMSkpLE1hdGguYWJzKHIpPC45OTk5OT8odGhpcy5feD1NYXRoLmF0YW4yKGwsXyksdGhpcy5feT1NYXRoLmF0YW4yKGUscykpOih0aGlzLl94PU1hdGguYXRhbjIoLWMsTSksdGhpcy5feT0wKSk6Y29uc29sZS53YXJuKFwiVEhSRUUuRXVsZXI6IC5zZXRGcm9tUm90YXRpb25NYXRyaXgoKSBnaXZlbiB1bnN1cHBvcnRlZCBvcmRlcjogXCIraSksdGhpcy5fb3JkZXI9aSxoIT09ITEmJnRoaXMub25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9LHNldEZyb21RdWF0ZXJuaW9uOmZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIGZ1bmN0aW9uKGksaCxuKXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9bmV3IFRIUkVFLk1hdHJpeDQpLHQubWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24oaSksdGhpcy5zZXRGcm9tUm90YXRpb25NYXRyaXgodCxoLG4pfX0oKSxzZXRGcm9tVmVjdG9yMzpmdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLnNldCh0LngsdC55LHQueixpfHx0aGlzLl9vcmRlcil9LHJlb3JkZXI6ZnVuY3Rpb24oKXt2YXIgdD1uZXcgVEhSRUUuUXVhdGVybmlvbjtyZXR1cm4gZnVuY3Rpb24oaSl7cmV0dXJuIHQuc2V0RnJvbUV1bGVyKHRoaXMpLHRoaXMuc2V0RnJvbVF1YXRlcm5pb24odCxpKX19KCksZXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0Ll94PT09dGhpcy5feCYmdC5feT09PXRoaXMuX3kmJnQuX3o9PT10aGlzLl96JiZ0Ll9vcmRlcj09PXRoaXMuX29yZGVyfSxmcm9tQXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3g9dFswXSx0aGlzLl95PXRbMV0sdGhpcy5fej10WzJdLHZvaWQgMCE9PXRbM10mJih0aGlzLl9vcmRlcj10WzNdKSx0aGlzLm9uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfSx0b0FycmF5OmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHZvaWQgMD09PXQmJih0PVtdKSx2b2lkIDA9PT1pJiYoaT0wKSx0W2ldPXRoaXMuX3gsdFtpKzFdPXRoaXMuX3ksdFtpKzJdPXRoaXMuX3osdFtpKzNdPXRoaXMuX29yZGVyLHR9LHRvVmVjdG9yMzpmdW5jdGlvbih0KXtyZXR1cm4gdD90LnNldCh0aGlzLl94LHRoaXMuX3ksdGhpcy5feik6bmV3IFRIUkVFLlZlY3RvcjModGhpcy5feCx0aGlzLl95LHRoaXMuX3opfSxvbkNoYW5nZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vbkNoYW5nZUNhbGxiYWNrPXQsdGhpc30sb25DaGFuZ2VDYWxsYmFjazpmdW5jdGlvbigpe319OyIsIi8qIWFydC10ZW1wbGF0ZSAtIFRlbXBsYXRlIEVuZ2luZSB8IGh0dHA6Ly9hdWkuZ2l0aHViLmNvbS9hcnRUZW1wbGF0ZS8qL1xuIWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gYS5yZXBsYWNlKHQsXCJcIikucmVwbGFjZSh1LFwiLFwiKS5yZXBsYWNlKHYsXCJcIikucmVwbGFjZSh3LFwiXCIpLnJlcGxhY2UoeCxcIlwiKS5zcGxpdCh5KX1mdW5jdGlvbiBiKGEpe3JldHVyblwiJ1wiK2EucmVwbGFjZSgvKCd8XFxcXCkvZyxcIlxcXFwkMVwiKS5yZXBsYWNlKC9cXHIvZyxcIlxcXFxyXCIpLnJlcGxhY2UoL1xcbi9nLFwiXFxcXG5cIikrXCInXCJ9ZnVuY3Rpb24gYyhjLGQpe2Z1bmN0aW9uIGUoYSl7cmV0dXJuIG0rPWEuc3BsaXQoL1xcbi8pLmxlbmd0aC0xLGsmJihhPWEucmVwbGFjZSgvXFxzKy9nLFwiIFwiKS5yZXBsYWNlKC88IS0tW1xcd1xcV10qPy0tPi9nLFwiXCIpKSxhJiYoYT1zWzFdK2IoYSkrc1syXStcIlxcblwiKSxhfWZ1bmN0aW9uIGYoYil7dmFyIGM9bTtpZihqP2I9aihiLGQpOmcmJihiPWIucmVwbGFjZSgvXFxuL2csZnVuY3Rpb24oKXtyZXR1cm4gbSsrLFwiJGxpbmU9XCIrbStcIjtcIn0pKSwwPT09Yi5pbmRleE9mKFwiPVwiKSl7dmFyIGU9bCYmIS9ePVs9I10vLnRlc3QoYik7aWYoYj1iLnJlcGxhY2UoL149Wz0jXT98W1xccztdKiQvZyxcIlwiKSxlKXt2YXIgZj1iLnJlcGxhY2UoL1xccypcXChbXlxcKV0rXFwpLyxcIlwiKTtuW2ZdfHwvXihpbmNsdWRlfHByaW50KSQvLnRlc3QoZil8fChiPVwiJGVzY2FwZShcIitiK1wiKVwiKX1lbHNlIGI9XCIkc3RyaW5nKFwiK2IrXCIpXCI7Yj1zWzFdK2Irc1syXX1yZXR1cm4gZyYmKGI9XCIkbGluZT1cIitjK1wiO1wiK2IpLHIoYShiKSxmdW5jdGlvbihhKXtpZihhJiYhcFthXSl7dmFyIGI7Yj1cInByaW50XCI9PT1hP3U6XCJpbmNsdWRlXCI9PT1hP3Y6blthXT9cIiR1dGlscy5cIithOm9bYV0/XCIkaGVscGVycy5cIithOlwiJGRhdGEuXCIrYSx3Kz1hK1wiPVwiK2IrXCIsXCIscFthXT0hMH19KSxiK1wiXFxuXCJ9dmFyIGc9ZC5kZWJ1ZyxoPWQub3BlblRhZyxpPWQuY2xvc2VUYWcsaj1kLnBhcnNlcixrPWQuY29tcHJlc3MsbD1kLmVzY2FwZSxtPTEscD17JGRhdGE6MSwkZmlsZW5hbWU6MSwkdXRpbHM6MSwkaGVscGVyczoxLCRvdXQ6MSwkbGluZToxfSxxPVwiXCIudHJpbSxzPXE/W1wiJG91dD0nJztcIixcIiRvdXQrPVwiLFwiO1wiLFwiJG91dFwiXTpbXCIkb3V0PVtdO1wiLFwiJG91dC5wdXNoKFwiLFwiKTtcIixcIiRvdXQuam9pbignJylcIl0sdD1xP1wiJG91dCs9dGV4dDtyZXR1cm4gJG91dDtcIjpcIiRvdXQucHVzaCh0ZXh0KTtcIix1PVwiZnVuY3Rpb24oKXt2YXIgdGV4dD0nJy5jb25jYXQuYXBwbHkoJycsYXJndW1lbnRzKTtcIit0K1wifVwiLHY9XCJmdW5jdGlvbihmaWxlbmFtZSxkYXRhKXtkYXRhPWRhdGF8fCRkYXRhO3ZhciB0ZXh0PSR1dGlscy4kaW5jbHVkZShmaWxlbmFtZSxkYXRhLCRmaWxlbmFtZSk7XCIrdCtcIn1cIix3PVwiJ3VzZSBzdHJpY3QnO3ZhciAkdXRpbHM9dGhpcywkaGVscGVycz0kdXRpbHMuJGhlbHBlcnMsXCIrKGc/XCIkbGluZT0wLFwiOlwiXCIpLHg9c1swXSx5PVwicmV0dXJuIG5ldyBTdHJpbmcoXCIrc1szXStcIik7XCI7cihjLnNwbGl0KGgpLGZ1bmN0aW9uKGEpe2E9YS5zcGxpdChpKTt2YXIgYj1hWzBdLGM9YVsxXTsxPT09YS5sZW5ndGg/eCs9ZShiKTooeCs9ZihiKSxjJiYoeCs9ZShjKSkpfSk7dmFyIHo9dyt4K3k7ZyYmKHo9XCJ0cnl7XCIreitcIn1jYXRjaChlKXt0aHJvdyB7ZmlsZW5hbWU6JGZpbGVuYW1lLG5hbWU6J1JlbmRlciBFcnJvcicsbWVzc2FnZTplLm1lc3NhZ2UsbGluZTokbGluZSxzb3VyY2U6XCIrYihjKStcIi5zcGxpdCgvXFxcXG4vKVskbGluZS0xXS5yZXBsYWNlKC9eXFxcXHMrLywnJyl9O31cIik7dHJ5e3ZhciBBPW5ldyBGdW5jdGlvbihcIiRkYXRhXCIsXCIkZmlsZW5hbWVcIix6KTtyZXR1cm4gQS5wcm90b3R5cGU9bixBfWNhdGNoKEIpe3Rocm93IEIudGVtcD1cImZ1bmN0aW9uIGFub255bW91cygkZGF0YSwkZmlsZW5hbWUpIHtcIit6K1wifVwiLEJ9fXZhciBkPWZ1bmN0aW9uKGEsYil7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGI/cShiLHtmaWxlbmFtZTphfSk6ZyhhLGIpfTtkLnZlcnNpb249XCIzLjAuMFwiLGQuY29uZmlnPWZ1bmN0aW9uKGEsYil7ZVthXT1ifTt2YXIgZT1kLmRlZmF1bHRzPXtvcGVuVGFnOlwiPCVcIixjbG9zZVRhZzpcIiU+XCIsZXNjYXBlOiEwLGNhY2hlOiEwLGNvbXByZXNzOiExLHBhcnNlcjpudWxsfSxmPWQuY2FjaGU9e307ZC5yZW5kZXI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gcShhLGIpfTt2YXIgZz1kLnJlbmRlckZpbGU9ZnVuY3Rpb24oYSxiKXt2YXIgYz1kLmdldChhKXx8cCh7ZmlsZW5hbWU6YSxuYW1lOlwiUmVuZGVyIEVycm9yXCIsbWVzc2FnZTpcIlRlbXBsYXRlIG5vdCBmb3VuZFwifSk7cmV0dXJuIGI/YyhiKTpjfTtkLmdldD1mdW5jdGlvbihhKXt2YXIgYjtpZihmW2FdKWI9ZlthXTtlbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBkb2N1bWVudCl7dmFyIGM9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSk7aWYoYyl7dmFyIGQ9KGMudmFsdWV8fGMuaW5uZXJIVE1MKS5yZXBsYWNlKC9eXFxzKnxcXHMqJC9nLFwiXCIpO2I9cShkLHtmaWxlbmFtZTphfSl9fXJldHVybiBifTt2YXIgaD1mdW5jdGlvbihhLGIpe3JldHVyblwic3RyaW5nXCIhPXR5cGVvZiBhJiYoYj10eXBlb2YgYSxcIm51bWJlclwiPT09Yj9hKz1cIlwiOmE9XCJmdW5jdGlvblwiPT09Yj9oKGEuY2FsbChhKSk6XCJcIiksYX0saT17XCI8XCI6XCImIzYwO1wiLFwiPlwiOlwiJiM2MjtcIiwnXCInOlwiJiMzNDtcIixcIidcIjpcIiYjMzk7XCIsXCImXCI6XCImIzM4O1wifSxqPWZ1bmN0aW9uKGEpe3JldHVybiBpW2FdfSxrPWZ1bmN0aW9uKGEpe3JldHVybiBoKGEpLnJlcGxhY2UoLyYoPyFbXFx3I10rOyl8Wzw+XCInXS9nLGopfSxsPUFycmF5LmlzQXJyYXl8fGZ1bmN0aW9uKGEpe3JldHVyblwiW29iamVjdCBBcnJheV1cIj09PXt9LnRvU3RyaW5nLmNhbGwoYSl9LG09ZnVuY3Rpb24oYSxiKXt2YXIgYyxkO2lmKGwoYSkpZm9yKGM9MCxkPWEubGVuZ3RoO2Q+YztjKyspYi5jYWxsKGEsYVtjXSxjLGEpO2Vsc2UgZm9yKGMgaW4gYSliLmNhbGwoYSxhW2NdLGMpfSxuPWQudXRpbHM9eyRoZWxwZXJzOnt9LCRpbmNsdWRlOmcsJHN0cmluZzpoLCRlc2NhcGU6aywkZWFjaDptfTtkLmhlbHBlcj1mdW5jdGlvbihhLGIpe29bYV09Yn07dmFyIG89ZC5oZWxwZXJzPW4uJGhlbHBlcnM7ZC5vbmVycm9yPWZ1bmN0aW9uKGEpe3ZhciBiPVwiVGVtcGxhdGUgRXJyb3JcXG5cXG5cIjtmb3IodmFyIGMgaW4gYSliKz1cIjxcIitjK1wiPlxcblwiK2FbY10rXCJcXG5cXG5cIjtcIm9iamVjdFwiPT10eXBlb2YgY29uc29sZSYmY29uc29sZS5lcnJvcihiKX07dmFyIHA9ZnVuY3Rpb24oYSl7cmV0dXJuIGQub25lcnJvcihhKSxmdW5jdGlvbigpe3JldHVyblwie1RlbXBsYXRlIEVycm9yfVwifX0scT1kLmNvbXBpbGU9ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBkKGMpe3RyeXtyZXR1cm4gbmV3IGkoYyxoKStcIlwifWNhdGNoKGQpe3JldHVybiBiLmRlYnVnP3AoZCkoKTooYi5kZWJ1Zz0hMCxxKGEsYikoYykpfX1iPWJ8fHt9O2Zvcih2YXIgZyBpbiBlKXZvaWQgMD09PWJbZ10mJihiW2ddPWVbZ10pO3ZhciBoPWIuZmlsZW5hbWU7dHJ5e3ZhciBpPWMoYSxiKX1jYXRjaChqKXtyZXR1cm4gai5maWxlbmFtZT1ofHxcImFub255bW91c1wiLGoubmFtZT1cIlN5bnRheCBFcnJvclwiLHAoail9cmV0dXJuIGQucHJvdG90eXBlPWkucHJvdG90eXBlLGQudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gaS50b1N0cmluZygpfSxoJiZiLmNhY2hlJiYoZltoXT1kKSxkfSxyPW4uJGVhY2gscz1cImJyZWFrLGNhc2UsY2F0Y2gsY29udGludWUsZGVidWdnZXIsZGVmYXVsdCxkZWxldGUsZG8sZWxzZSxmYWxzZSxmaW5hbGx5LGZvcixmdW5jdGlvbixpZixpbixpbnN0YW5jZW9mLG5ldyxudWxsLHJldHVybixzd2l0Y2gsdGhpcyx0aHJvdyx0cnVlLHRyeSx0eXBlb2YsdmFyLHZvaWQsd2hpbGUsd2l0aCxhYnN0cmFjdCxib29sZWFuLGJ5dGUsY2hhcixjbGFzcyxjb25zdCxkb3VibGUsZW51bSxleHBvcnQsZXh0ZW5kcyxmaW5hbCxmbG9hdCxnb3RvLGltcGxlbWVudHMsaW1wb3J0LGludCxpbnRlcmZhY2UsbG9uZyxuYXRpdmUscGFja2FnZSxwcml2YXRlLHByb3RlY3RlZCxwdWJsaWMsc2hvcnQsc3RhdGljLHN1cGVyLHN5bmNocm9uaXplZCx0aHJvd3MsdHJhbnNpZW50LHZvbGF0aWxlLGFyZ3VtZW50cyxsZXQseWllbGQsdW5kZWZpbmVkXCIsdD0vXFwvXFwqW1xcd1xcV10qP1xcKlxcL3xcXC9cXC9bXlxcbl0qXFxufFxcL1xcL1teXFxuXSokfFwiKD86W15cIlxcXFxdfFxcXFxbXFx3XFxXXSkqXCJ8Jyg/OlteJ1xcXFxdfFxcXFxbXFx3XFxXXSkqJ3xcXHMqXFwuXFxzKlskXFx3XFwuXSsvZyx1PS9bXlxcdyRdKy9nLHY9bmV3IFJlZ0V4cChbXCJcXFxcYlwiK3MucmVwbGFjZSgvLC9nLFwiXFxcXGJ8XFxcXGJcIikrXCJcXFxcYlwiXS5qb2luKFwifFwiKSxcImdcIiksdz0vXlxcZFteLF0qfCxcXGRbXixdKi9nLHg9L14sK3wsKyQvZyx5PS9eJHwsKy87XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lP2RlZmluZShmdW5jdGlvbigpe3JldHVybiBkfSk6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZDp0aGlzLnRlbXBsYXRlPWR9KCk7IiwiIWZ1bmN0aW9uKGdsb2JhbCkge1xuXG4gIGlmIChnbG9iYWwudGVtcGxhdGUpIHtcbiAgICBnbG9iYWwudGVtcGxhdGUuY29uZmlnKCdvcGVuVGFnJywnPCMnKTtcbiAgICBnbG9iYWwudGVtcGxhdGUuY29uZmlnKCdjbG9zZVRhZycsJyM+Jyk7XG4gIH1cblxuICBnbG9iYWwuc25vdCA9IHt9O1xuXG4gIGdsb2JhbC5zbm90LnV0aWwgPSB7XG4gICAgbGVmdF9wb3M6IGxlZnRfcG9zLFxuICAgIHRvcF9wb3M6IHRvcF9wb3MsXG4gICAgaXNfbW9iaWxlOiBpc19tb2JpbGUsXG4gICAgaXNfd2VjaGF0X2xvZ2luOiBpc193ZWNoYXRfbG9naW4sXG4gICAgZ2V0X3dpbmRvd193aWR0aDogZ2V0X3dpbmRvd193aWR0aCxcbiAgICBnZXRfd2luZG93X2hlaWdodDogZ2V0X3dpbmRvd19oZWlnaHQsXG4gICAgcG9zaXRpb25fdG9fcm90YXRpb246IHBvc2l0aW9uX3RvX3JvdGF0aW9uLFxuICAgIGRpc3RhbmNlMkQ6IGRpc3RhbmNlMkQsXG4gICAgZGlzdGFuY2UzRDogZGlzdGFuY2UzRCxcbiAgICBlcHNpbG9uOiBlcHNpbG9uLFxuICAgIGNzc190ZXh0X3RvX21hdHJpeDogY3NzX3RleHRfdG9fbWF0cml4LFxuICAgIG1hdHJpeF90b19jc3NfdGV4dDogbWF0cml4X3RvX2Nzc190ZXh0LFxuICAgIHdlYmdsX2NoZWNrOiB3ZWJnbF9jaGVjayxcbiAgICBsb2FkX2pzOiBsb2FkX2pzLFxuICAgIHJvdGF0aW9uX3RvX3Bvc2l0aW9uOiByb3RhdGlvbl90b19wb3NpdGlvblxuICB9O1xuXG4gIGZ1bmN0aW9uIHRvcF9wb3MoZWxlbSkge1xuICAgIHZhciBjdXJ0b3AgPSAwO1xuICAgIGlmIChlbGVtLm9mZnNldFBhcmVudCkge1xuICAgICAgZG8geyBcbiAgICAgICAgICBjdXJ0b3AgKz0gZWxlbS5vZmZzZXRUb3A7IFxuICAgICAgfSB3aGlsZSAoZWxlbSA9IGVsZW0ub2Zmc2V0UGFyZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIGN1cnRvcDtcbiAgfTtcblxuICBmdW5jdGlvbiBsZWZ0X3BvcyhlbGVtKSB7XG4gICAgdmFyIGN1cmxlZnQgPSAwO1xuICAgIGlmIChlbGVtLm9mZnNldFBhcmVudCkge1xuICAgICAgICBkbyB7IFxuICAgICAgICAgICAgY3VybGVmdCArPSBlbGVtLm9mZnNldExlZnQ7IFxuICAgICAgICB9IHdoaWxlIChlbGVtID0gZWxlbS5vZmZzZXRQYXJlbnQpO1xuICAgIH1cbiAgICByZXR1cm4gY3VybGVmdDtcbiAgfTtcbiAgXG4gIGZ1bmN0aW9uIGlzX21vYmlsZSgpIHtcbiAgICByZXR1cm4gZ2V0X3dpbmRvd193aWR0aCgpIDwgNTAwO1xuICB9XG4gIFxuICBmdW5jdGlvbiBpc193ZWNoYXRfbG9naW4oKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ01pY3JvTWVzc2VuZ2VyJykgPj0gMCA/IHRydWUgOiBmYWxzZTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2V0X3dpbmRvd193aWR0aCgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZXRfd2luZG93X2hlaWdodCgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcbiAgfVxuICBcbiAgZnVuY3Rpb24gcG9zaXRpb25fdG9fcm90YXRpb24oeCwgeSwgeikge1xuICAgIHZhciByID0gZGlzdGFuY2UzRCh4LCB5LCB6LCAwLCAwLCAwKTtcbiAgICB2YXIgcnggPSBNYXRoLmFzaW4oeiAvIHIpO1xuICAgIHZhciByeSA9IE1hdGguYXNpbih5IC8gciAvIE1hdGguY29zKHJ4KSk7XG4gICAgaWYgKHggPCAwKSB7XG4gICAgICAgIHJ5ID0gcnkgPiAwID8gTWF0aC5QSSAtIHJ5IDogLSBNYXRoLlBJIC0gcnk7XG4gICAgfVxuICBcbiAgICByZXR1cm4ge1xuICAgICAgcng6IC0gcnggKiAxODAgLyBNYXRoLlBJLFxuICAgICAgcnk6IChyeSA8IDAgPyByeSArIE1hdGguUEkgKiAyIDogcnkpICogMTgwIC8gTWF0aC5QSVxuICAgIH07XG4gIH1cbiAgXG4gIGZ1bmN0aW9uIGRpc3RhbmNlMkQoYSwgYiwgYywgZCkge1xuICAgIHJldHVybiBNYXRoLnBvdygoYSAtIGMpICogKGEgLSBjKSArIChiIC0gZCkgKiAoYiAtIGQpLCAwLjUpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBkaXN0YW5jZTNEKGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgICByZXR1cm4gTWF0aC5wb3coKGEgLSBkKSAqIChhIC0gZCkgKyAoYiAtIGUpICogKGIgLSBlKSArIChjIC0gZikgKiAoYyAtIGYpLCAwLjUpO1xuICB9XG4gIFxuICBmdW5jdGlvbiBlcHNpbG9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIE1hdGguYWJzKHZhbHVlKSA8IDAuMDAwMDAxID8gMCA6IHZhbHVlLnRvRml4ZWQoNSk7XG4gIH07XG4gIFxuICBmdW5jdGlvbiBjc3NfdGV4dF90b19tYXRyaXgodCkge1xuICAgIHZhciBtID0gbmV3IFdlYktpdENTU01hdHJpeCh0KTtcbiAgICByZXR1cm4gW1xuICAgICAgZXBzaWxvbihtLm0xMSksIGVwc2lsb24obS5tMTIpLCBlcHNpbG9uKG0ubTEzKSwgZXBzaWxvbihtLm0xNCksXG4gICAgICBlcHNpbG9uKG0ubTIxKSwgZXBzaWxvbihtLm0yMiksIGVwc2lsb24obS5tMjMpLCBlcHNpbG9uKG0ubTI0KSxcbiAgICAgIGVwc2lsb24obS5tMzEpLCBlcHNpbG9uKG0ubTMyKSwgZXBzaWxvbihtLm0zMyksIGVwc2lsb24obS5tMzQpLFxuICAgICAgZXBzaWxvbihtLm00MSksIGVwc2lsb24obS5tNDIpLCBlcHNpbG9uKG0ubTQzKSwgZXBzaWxvbihtLm00NClcbiAgICBdO1xuICB9XG4gIFxuICBmdW5jdGlvbiBtYXRyaXhfdG9fY3NzX3RleHQoYSwgYiwgYywgZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUsIGYsIGcsIGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLCBqLCBrLCBsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbSwgbiwgbywgcCkge1xuICAgICAgaWYgKHR5cGVvZihhKSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHJldHVybiAnbWF0cml4M2QoJyArIChhLmpvaW4oJywnKSkgKyAnKSc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ21hdHJpeDNkKCcgKyBhICsgJywnICsgYiArICcsJyArIGMgKyAnLCcgKyBkKycsJyArIGUgKyAnLCcgKyBmICsgJywnICsgZyArICcsJyArIGggKyAnLCcgKyBpICsgJywnICsgaiArICcsJyArIGsgKyAnLCcgKyBsICsgJywnICsgbSArICcsJyArIG4gKyAnLCcgKyBvKyAnLCcgKyBwICsgJyknO1xuICB9XG4gIFxuICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lPSAoZnVuY3Rpb24gKCkgeyBcbiAgICByZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCBcbiAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IFxuICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgXG4gICAgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgXG4gICAgLy8gaWYgYWxsIGVsc2UgZmFpbHMsIHVzZSBzZXRUaW1lb3V0IFxuICAgIGZ1bmN0aW9uIChjYWxsYmFjaykgeyBcbiAgICAgIHJldHVybiB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgMTAwMCAvIDYwKTsgLy8gc2hvb3QgZm9yIDYwIGZwcyBcbiAgICB9OyBcbiAgfSkoKTsgXG4gIFxuICBmdW5jdGlvbiB3ZWJnbF9jaGVjayhyZXR1cm5fY29udGV4dCkge1xuICAgIGlmICghIXdpbmRvdy5XZWJHTFJlbmRlcmluZ0NvbnRleHQpIHtcbiAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgdmFyIG5hbWVzID0gWyd3ZWJnbCcsICdleHBlcmltZW50YWwtd2ViZ2wnLCAnbW96LXdlYmdsJywgJ3dlYmtpdC0zZCddO1xuICAgICAgdmFyIGNvbnRleHQgPSBmYWxzZTtcbiAgXG4gICAgICBmb3IgKHZhciBpID0gMDtpIDwgNDsgaSsrKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KG5hbWVzW2ldKTtcbiAgICAgICAgICBpZiAoY29udGV4dCAmJiB0eXBlb2YgY29udGV4dC5nZXRQYXJhbWV0ZXIgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgLy8gV2ViR0wgaXMgZW5hYmxlZFxuICAgICAgICAgICAgaWYgKHJldHVybl9jb250ZXh0KSB7XG4gICAgICAgICAgICAgIC8vIHJldHVybiBXZWJHTCBvYmplY3QgaWYgdGhlIGZ1bmN0aW9uJ3MgYXJndW1lbnQgaXMgcHJlc2VudFxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVzW2ldLFxuICAgICAgICAgICAgICAgIGdsOiBjb250ZXh0XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBlbHNlLCByZXR1cm4ganVzdCB0cnVlXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgIH1cbiAgXG4gICAgICAvLyBXZWJHTCBpcyBzdXBwb3J0ZWQsIGJ1dCBkaXNhYmxlZFxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgXG4gICAgLy8gV2ViR0wgbm90IHN1cHBvcnRlZFxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBcbiAgZnVuY3Rpb24gbG9hZF9qcyhmaWxlLCBjYWxsYmFjaykge1xuICAgIHZhciBfZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcbiAgICB2YXIganMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICBqcy5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9qYXZhc2NyaXB0Jyk7XG4gICAganMuc2V0QXR0cmlidXRlKCdzcmMnLCBmaWxlKTtcbiAgICBfZG9jLmFwcGVuZENoaWxkKGpzKTtcbiAgICBpZiAoIS8qQGNjX29uIUAqLzApIHsgLy9pZiBub3QgaWVcbiAgICAgIC8vZmlyZWZveDLjgIFmaXJlZm94M+OAgXNhZmFyaTMuMSvjgIFvcGVyYTkuNisgc3VwcG9ydCBqcy5vbmxvYWRcbiAgICAgIGpzLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy9pZTbjgIFpZTcgc3VwcG9ydCBqcy5vbnJlYWR5c3RhdGVjaGFuZ2VcbiAgICAgIGpzLm9uUmVhZHlTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGpzLnJlYWR5U3RhdGUgPT0gJ2xvYWRlZCcgfHwganMucmVhZHlTdGF0ZSA9PSAnY29tcGxldGUnKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgZnVuY3Rpb24gcm90YXRpb25fdG9fcG9zaXRpb24oeiwgcngsIHJ5LCByeikge1xuICAgIHogPSAtIHo7XG4gICAgcnggPSAtIHJ4O1xuICBcbiAgICB2YXIgeCA9IHNub3QuYmdfc2l6ZSAvIDI7XG4gICAgdmFyIHkgPSBzbm90LmJnX3NpemUgLyAyO1xuICBcbiAgICB2YXIgdHJhbnNmb3JtID0gY3NzX3RleHRfdG9fbWF0cml4KCd0cmFuc2xhdGUzZCgnICsgeCArICdweCwnICsgeSArICdweCwwKSByb3RhdGVZKCcgKyAoMCkgKyAnZGVnKSByb3RhdGVYKCcgKyAoMCkgKyAnZGVnKSByb3RhdGVZKCcgKyAocnkgPyAtIHJ5IDogMCkgKyAnZGVnKSByb3RhdGVYKCcgKyAocnggPyAtIHJ4IDogMCkgKyAnZGVnKSByb3RhdGVaKCcgKyAocnogPyByeiA6IDApICsnZGVnKSB0cmFuc2xhdGVaKCcgKyB6ICsgJ3B4KScgKTtcbiAgICByZXR1cm4gWyAtIHRyYW5zZm9ybVsxMl0gKyBzbm90LmJnX3NpemUgLyAyLCB0cmFuc2Zvcm1bMTNdIC0gc25vdC5iZ19zaXplIC8gMiwgLSB0cmFuc2Zvcm1bMTRdXTtcbiAgfVxufSh3aW5kb3cpO1xuIiwiIWZ1bmN0aW9uKGdsb2JhbCkge1xuXG4gIHZhciBkb21fb2Zmc2V0X3RvcDtcbiAgdmFyIGRvbV9vZmZzZXRfbGVmdDtcbiAgdmFyIHNub3QgPSB7XG5cbiAgICBjYW1lcmFfbG9va19hdDoge1xuICAgICAgeDogMCxcbiAgICAgIHk6IDAsXG4gICAgICB6OiAxLFxuICAgIH0sXG4gICAgbW91c2Vfc2Vuc2l0aXZpdHk6IDAuMyxcbiAgICBhdXRvX3JvdGF0aW9uOiAwLFxuICAgIGZyYW1lczogMCxcbiAgICBiZ19yb3RhdGlvbjogWzAsIDAsIDAsIDAsIDAsIDBdLFxuXG4gICAgcGF1c2VfYW5pbWF0aW9uOiBmYWxzZSxcblxuICAgIGRvbSAgICAgIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nub3Qtd3JhcCcpLFxuICAgIGNhbWVyYSAgIDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nub3QtY2FtZXJhJyksXG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25vdC1jb250YWluZXInKSxcblxuICAgIGJnX3NpemU6IDEwMjQsXG5cbiAgICBnZW5lcmF0b3I6IHt9LFxuICAgIGd5cm86IGZhbHNlLFxuICAgIHJ5OiAwLCAgICAgICAgLy8gUm90YXRlICogZGVncmVlIGFyb3VuZCB5IGF4aXNcbiAgICByeDogMCwgICAgICAgIC8vIFJvdGF0ZSAqIGRlZ3JlZSBhcm91bmQgeCBheGlzXG4gICAgbWF4X2ZvdjogMTIwLCAvLyBNYXggZmllbGQgb2YgdmlldyAoZGVncmVlKVxuICAgIG1pbl9mb3Y6IDYwLCAgIC8vIE1pbiBmaWVsZCBvZiB2aWV3IChkZWdyZWUpXG4gICAgZm92OiA5MCwgICAgICAvLyBEZWZhdWx0IGZpZWxkIG9mIHZpZXdcbiAgICBzbW9vdGg6IDAuMTcsXG4gICAgbWluX2RldGVjdF9kaXN0YW5jZTogMjAsXG4gICAgb25fY2xpY2s6IGZ1bmN0aW9uKCkge30sXG4gICAgb25fc3ByaXRlX2NsaWNrOiBmdW5jdGlvbigpIHt9LFxuICB9XG4gIHZhciBwcmV2X2d5cm87XG5cbiAgdmFyIFBJID0gTWF0aC5QSTtcbiAgdmFyIHNpbiA9IE1hdGguc2luO1xuICB2YXIgY29zID0gTWF0aC5jb3M7XG4gIHZhciB0YW4gPSBNYXRoLnRhbjtcbiAgdmFyIGFjb3MgPSBNYXRoLmFjb3M7XG4gIHZhciBhdGFuID0gTWF0aC5hdGFuO1xuICB2YXIgcG93ID0gTWF0aC5wb3c7XG4gIHZhciBmbG9vciA9IE1hdGguZmxvb3I7XG4gIHZhciBzcXJ0ID0gTWF0aC5zcXJ0O1xuXG4gIHZhciBkaXN0X3J4O1xuICB2YXIgZGlzdF9yeTtcbiAgdmFyIHByZXZpb3VzX3F1YXQgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpO1xuICB2YXIgc2NyZWVuX29yaWVudGF0aW9uID0gMDtcbiAgdmFyIHZhcnMgPSB7XG4gICAgYWxwaGE6IDAsXG4gICAgYmV0YTogOTAgKiBQSSAvIDE4MCxcbiAgICBnYW1tYTogMFxuICB9O1xuXG4gIHZhciB2YXJzRGVzdCA9IHtcbiAgICBhbHBoYTogMCxcbiAgICBiZXRhOiAwLFxuICAgIGdhbW1hOiAwXG4gIH07XG5cblxuICBmdW5jdGlvbiBfcG9pbnRTdGFuZGFyZGxpemF0aW9uKHgsIHksIHopIHtcbiAgICB2YXIgcmF0aW8gPSAyMDAgLyBkaXN0YW5jZTNEKHgsIHksIHosIDAsIDAsIDApO1xuICAgIHJldHVybiBbeCAqIHJhdGlvLCB5ICogcmF0aW8sIHogKiByYXRpb107XG4gIH1cblxuICBpZiAoZ2xvYmFsLnNub3QpIHtcbiAgICBmb3IgKHZhciBpIGluIHNub3QpIHtcbiAgICAgIGdsb2JhbC5zbm90W2ldID0gc25vdFtpXTtcbiAgICB9XG4gICAgc25vdCA9IGdsb2JhbC5zbm90O1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoJ3Nub3QtdXRpbHMuanMgaXMgbWlzc2luZycpO1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgdXRpbCA9IGdsb2JhbC5zbm90LnV0aWw7XG4gIHZhciBlcHNpbG9uID0gdXRpbC5lcHNpbG9uO1xuICB2YXIgZGlzdGFuY2UzRCA9IHV0aWwuZGlzdGFuY2UzRDtcbiAgdmFyIGRpc3RhbmNlMkQgPSB1dGlsLmRpc3RhbmNlMkQ7XG5cbiAgdmFyIHNldF9mb3YgPSBmdW5jdGlvbiAoZGVncmVlKSB7XG4gICAgaWYgKGRlZ3JlZSA8IHNub3QubWluX2ZvdiB8fCBkZWdyZWUgPiBzbm90Lm1heF9mb3YpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc25vdC5mb3YgPSBkZWdyZWU7XG4gICAgc25vdC5jb250YWluZXIuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSAnc2NhbGUoJyArIHRhbihzbm90Lm1heF9mb3YgLyAyICogUEkgLyAxODApIC8gdGFuKHNub3QuZm92IC8gMiAqIFBJIC8gMTgwKSArICcpJztcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgIHZhciBzcHJpdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3ByaXRlJyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcHJpdGVzLmxlbmd0aDsgKysgaSkge1xuICAgICAgc3ByaXRlc1tpXS5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICB2YXIgX2luaXQgPSBmdW5jdGlvbihjb25maWcsIGFqYXgpIHtcbiAgICByZXNldCgpO1xuXG4gICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoc25vdC5fYW5pbWF0ZUlkKTtcblxuICAgIGZvciAodmFyIGkgaW4gY29uZmlnKSB7XG4gICAgICBpZiAoaSA9PSAnZ2VuZXJhdG9yJykge1xuICAgICAgICBtZXJnZV9qc29uKHNub3QuZ2VuZXJhdG9yLCBjb25maWcuZ2VuZXJhdG9yKTtcbiAgICAgIH1cbiAgICAgIHNub3RbaV0gPSBjb25maWdbaV07XG4gICAgfVxuICAgIHByZXZfZ3lybyA9IHNub3QuZ3lybztcblxuICAgIGRvbV9vZmZzZXRfbGVmdCA9IHV0aWwubGVmdF9wb3Moc25vdC5kb20pO1xuICAgIGRvbV9vZmZzZXRfdG9wID0gdXRpbC50b3BfcG9zKHNub3QuZG9tKTtcblxuICAgIGRpc3RfcnggPSBzbm90LnJ4ICsgMC4xOyAvL3Vua25vd24gYnVnIGZvciBtb2JpbGUgc2FmYXJpXG4gICAgZGlzdF9yeSA9IHNub3Qucnk7XG5cbiAgICAvL0ZpcnN0IGluaXRcbiAgICBpZiAoIWFqYXgpIHtcblxuICAgICAgc25vdC53aWR0aCA9IHNub3QuZG9tLm9mZnNldFdpZHRoO1xuICAgICAgc25vdC5oZWlnaHQgPSBzbm90LmRvbS5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgIC8vY29tcHV0ZSB0aGUgbWF4IEhvcml6b250YWwgRmllbGQgb2Ygdmlld1xuICAgICAgLy9wZXJzcGVjdGl2ZT0gcHJvamVjdGl2ZVNjcmVlbldpZHRoLzJcbiAgICAgIC8vICAgICAgICAgICA9IHdpZHRoLzIvdGFuKG1heF9mb3YvMilcbiAgICAgIHNub3QucGVyc3BlY3RpdmUgPSBzbm90LndpZHRoIC8gMiAvIHRhbihzbm90Lm1heF9mb3YgLyAyICogUEkgLyAxODApO1xuXG4gICAgICBzbm90LmNvbnRhaW5lci5zdHlsZVsnLXdlYmtpdC1wZXJzcGVjdGl2ZSddID0gc25vdC5wZXJzcGVjdGl2ZSArICdweCc7XG5cbiAgICAgIC8vY2FtZXJhIG9mZnNldFxuICAgICAgLy8gWiBpcyBkZXB0aChmcm9udCkgWSBpcyBoZWlnaHQgWCBpcyByaWdodFxuICAgICAgLy9cbiAgICAgIC8vIHRyYW5zbGF0ZVogc2V0Rk9WXG4gICAgICAvLyByb3RhdGVYIHJvdGF0ZSBhcm91bmQgWCBheGlzXG4gICAgICAvLyByb3RhdGVZIHJvdGF0ZSBhcm91bmQgWSBheGlzXG4gICAgICAvLyB0cmFuc2xhdGVYIHRyYW5zbGF0ZSB0aGUgQ2FtZXJhIHRvIGNlbnRlclxuICAgICAgLy8gdHJhbnNsYXRlWVxuICAgICAgc25vdC5jYW1lcmFCYXNlVHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoJyArIGVwc2lsb24oLSAoc25vdC5iZ19zaXplIC0gc25vdC53aWR0aCkgLyAyKSArICdweCkgdHJhbnNsYXRlWSgnICsgZXBzaWxvbigtIChzbm90LmJnX3NpemUgLSBzbm90LmhlaWdodCkgLyAyKSArICdweCknO1xuICAgICAgc25vdC5jYW1lcmEuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSAndHJhbnNsYXRlWigtJyArIHNub3QucGVyc3BlY3RpdmUgKyAncHgpIHJvdGF0ZVgoJyArIHNub3QucnggKyAnZGVnKSByb3RhdGVZKCcgKyBzbm90LnJ5ICsgJ2RlZyknICsgc25vdC5jYW1lcmFCYXNlVHJhbnNmb3JtO1xuICAgIH1cbiAgICBzZXRfZm92KHNub3QuZm92KTtcblxuICAgIGlmIChjb25maWcuYmdfaW1ncykge1xuICAgICAgbG9hZF9iZ19pbWdzKGNvbmZpZy5iZ19pbWdzLCBjb25maWcuYmdfcm90YXRpb24gfHwgc25vdC5iZ19yb3RhdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZykge1xuICAgICAgX2xvYWRfc3ByaXRlcyhjb25maWcuc3ByaXRlcyk7XG4gICAgfVxuXG4gICAgaWYgKHV0aWwuaXNfbW9iaWxlKCkpIHtcbiAgICAgIHNub3QuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBtb3VzZURvd24sIGZhbHNlKTtcbiAgICAgIHNub3QuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScgLCBtb3VzZU1vdmUsIGZhbHNlKTtcbiAgICAgIHNub3QuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJyAgLCBtb3VzZVVwICAsIGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc25vdC5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJyAsIG1vdXNlRG93biAsIGZhbHNlKTtcbiAgICAgIHNub3QuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScgLCBtb3VzZU1vdmUgLCBmYWxzZSk7XG4gICAgICBzbm90LmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJyAgICwgbW91c2VVcCAgICwgZmFsc2UpO1xuICAgICAgc25vdC5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V3aGVlbCcsIG1vdXNlV2hlZWwsIGZhbHNlKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmNhbGxiYWNrKSB7XG4gICAgICBjb25maWcuY2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkX2JnX2ltZ3MoYmdfaW1ncywgYmdfcm90YXRpb24pIHtcbiAgICB2YXIgYmdfY29uZmlnID0ge1xuICAgICAgZnJvbnQgOiAncm90YXRlWSg5MGRlZyknICsgJyAgICAgICAgICAgICAgICByb3RhdGVaKCcgKyBiZ19yb3RhdGlvblswXSArICdkZWcpICB0cmFuc2xhdGVaKC0nICsgKHNub3QuYmdfc2l6ZSAvIDIpICsgJ3B4KScsXG4gICAgICBib3R0b206ICdyb3RhdGVZKDkwZGVnKScgKyAncm90YXRlWCg5MGRlZykgIHJvdGF0ZVooJyArIGJnX3JvdGF0aW9uWzFdICsgJ2RlZykgIHRyYW5zbGF0ZVooLScgKyAoc25vdC5iZ19zaXplIC8gMikgKyAncHgpIHJvdGF0ZVooOTBkZWcpJyxcbiAgICAgIGxlZnQgIDogJ3JvdGF0ZVkoOTBkZWcpJyArICdyb3RhdGVZKDkwZGVnKSAgcm90YXRlWignICsgYmdfcm90YXRpb25bMl0gKyAnZGVnKSAgdHJhbnNsYXRlWigtJyArIChzbm90LmJnX3NpemUgLyAyKSArICdweCknLFxuICAgICAgYmFjayAgOiAncm90YXRlWSg5MGRlZyknICsgJ3JvdGF0ZVkoMTgwZGVnKSByb3RhdGVaKCcgKyBiZ19yb3RhdGlvblszXSArICdkZWcpICB0cmFuc2xhdGVaKC0nICsgKHNub3QuYmdfc2l6ZSAvIDIpICsgJ3B4KScsXG4gICAgICB0b3AgICA6ICdyb3RhdGVZKDkwZGVnKScgKyAncm90YXRlWCgtOTBkZWcpIHJvdGF0ZVooJyArIGJnX3JvdGF0aW9uWzRdICsgJ2RlZykgIHRyYW5zbGF0ZVooLScgKyAoc25vdC5iZ19zaXplIC8gMikgKyAncHgpIHJvdGF0ZVooLTkwZGVnKScsXG4gICAgICByaWdodCA6ICdyb3RhdGVZKDkwZGVnKScgKyAncm90YXRlWSgtOTBkZWcpIHJvdGF0ZVooJyArIGJnX3JvdGF0aW9uWzVdICsgJ2RlZykgIHRyYW5zbGF0ZVooLScgKyAoc25vdC5iZ19zaXplIC8gMikgKyAncHgpJ1xuICAgIH07XG5cbiAgICB2YXIgYmdfZG9tO1xuICAgIHZhciBjb3VudCA9IDA7XG4gICAgZm9yICh2YXIgaSBpbiBiZ19jb25maWcpIHtcbiAgICAgIGJnX2RvbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Nub3QtYmcgJyArIGkpWzBdO1xuICAgICAgYmdfZG9tLnN0eWxlWyctd2Via2l0LXRyYW5zZm9ybSddID0gYmdfY29uZmlnW2ldO1xuICAgICAgYmdfZG9tLnN0eWxlWyd3aWR0aCddID0gc25vdC5iZ19zaXplICsgMiArICdweCc7ICAgICAgICAvLyAyIG1vcmUgcGl4ZWxzIGZvciBvdmVybGFwcGluZyBnYXBzICggY2hyb21lJ3MgYnVnIClcbiAgICAgIGJnX2RvbS5zdHlsZVsnaGVpZ2h0J10gPSBzbm90LmJnX3NpemUgKyAyICsgJ3B4JzsgICAgICAgIC8vIDIgbW9yZSBwaXhlbHMgZm9yIG92ZXJsYXBwaW5nIGdhcHMgKCBjaHJvbWUncyBidWcgKVxuXG4gICAgICBiZ19kb20uc2V0QXR0cmlidXRlKCdzcmMnLCBiZ19pbWdzW2NvdW50XSk7XG4gICAgICBiZ19kb20uc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgY291bnQpO1xuICAgICAgKytjb3VudDtcbiAgICB9XG4gIH1cblxuICB2YXIgdG91Y2hlcyA9IHtcbiAgICBmeDowLCAgIC8vIEZpcnN0ICBmaW5nZXIgeFxuICAgIGZ5OjAsICAgLy8gRmlyc3QgIGZpbmdlciB5XG4gICAgc3g6MCwgICAvLyBTZWNvbmQgZmluZ2VyIHhcbiAgICBzeTowICAgIC8vIFNlY29uZCBmaW5nZXIgeVxuICB9O1xuXG4gIHZhciBfbG9hZF9zcHJpdGVzID0gZnVuY3Rpb24oc3ByaXRlcykge1xuICAgIGZvciAodmFyIGkgaW4gc3ByaXRlcykge1xuICAgICAgdmFyIHQgPSBzcHJpdGVzW2ldO1xuICAgICAgaWYgKHQuc3RhbmRhcmRsaXphdGlvbikge1xuICAgICAgICB2YXIgc3RhbmRhcmQgPSBfcG9pbnRTdGFuZGFyZGxpemF0aW9uKHQueCx0LnksdC56KTtcbiAgICAgICAgdC54PXN0YW5kYXJkWzBdO1xuICAgICAgICB0Lnk9c3RhbmRhcmRbMV07XG4gICAgICAgIHQuej1zdGFuZGFyZFsyXTtcbiAgICAgIH1cblxuICAgICAgdmFyIHRlbXBfd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGVtcF93cmFwcGVyLmlubmVySFRNTCA9IHRlbXBsYXRlKHNub3QuZ2VuZXJhdG9yW3QuZ2VuZXJhdG9yXSwgdCk7XG4gICAgICB2YXIgZWxlbWVudCA9IHRlbXBfd3JhcHBlci5maXJzdENoaWxkO1xuICAgICAgZWxlbWVudC5kYXRhID0gc3ByaXRlc1tpXTtcbiAgICAgIGFkZF9zcHJpdGVfYnlfcG9zaXRpb24oZWxlbWVudCwgdCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbV9tYWtlX3JvdGF0aW9uX2F4aXMocG9pbnQsIHJvdGF0aW9uKSB7XG4gICAgcmV0dXJuIG5ldyBUSFJFRS5NYXRyaXg0KCkubWFrZVJvdGF0aW9uQXhpcyhwb2ludCwgcm90YXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gbV9tdWx0aXBseSgpIHtcbiAgICB2YXIgbWF0cyA9IGFyZ3VtZW50cztcblxuICAgIHZhciBsID0gbWF0cy5sZW5ndGg7XG4gICAgd2hpbGUgKGwgPiAxKSB7XG4gICAgICB2YXIgbGFzdDIgPSBtYXRzW2wgLSAyXTtcbiAgICAgIHZhciBsYXN0MSA9IG1hdHNbbCAtIDFdO1xuICAgICAgbWF0c1tsIC0gMl0gPSBuZXcgVEhSRUUuTWF0cml4NCgpLm11bHRpcGx5TWF0cmljZXMoXG4gICAgICAgIGxhc3QyLFxuICAgICAgICBsYXN0MVxuICAgICAgKTtcbiAgICAgIGwtLTtcbiAgICB9XG4gICAgcmV0dXJuIG1hdHNbMF07XG4gIH1cblxuICBmdW5jdGlvbiB2X3NldF9mcm9tX21hdHJpeF9wb3NpdGlvbihtYXQ0KSB7XG4gICAgcmV0dXJuIG5ldyBUSFJFRS5WZWN0b3IzKCkuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKG1hdDQpO1xuICB9XG5cbiAgZnVuY3Rpb24gbV9zZXRfcG9zaXRpb24ocCkge1xuICAgIHJldHVybiBuZXcgVEhSRUUuTWF0cml4NCgpLnNldFBvc2l0aW9uKHApO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkX3Nwcml0ZV9ieV9wb3NpdGlvbihlbGVtZW50LCBwKSB7XG5cbiAgICB2YXIgeCA9IHAueDtcbiAgICB2YXIgeiA9IC0gcC56O1xuICAgIHZhciB5ID0gLSBwLnk7XG5cbiAgICB2YXIgc3ByaXRlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgc3ByaXRlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICBzcHJpdGVDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIHNwcml0ZUNvbnRhaW5lci5jbGFzc05hbWUgPSAnc3ByaXRlLWNvbnRhaW5lcic7XG4gICAgc3ByaXRlQ29udGFpbmVyLmlkID0gZWxlbWVudC5kYXRhLmlkO1xuXG4gICAgc3ByaXRlQ29udGFpbmVyLnN0eWxlWyctd2Via2l0LXRyYW5zZm9ybS1vcmlnaW4teCddID0gJzAnO1xuICAgIHNwcml0ZUNvbnRhaW5lci5zdHlsZVsnLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luLXknXSA9ICcwJztcblxuICAgIHZhciBhcmMgPSB4ID09IDAgJiYgeiA9PSAwID8gMCA6IGFjb3MoIHogLyBwb3coeCAqIHggKyB6ICogeiwgMC41KSk7XG5cbiAgICBhcmMgPSB4IDwgMCA/IDIgKiBQSSAtIGFyYyA6IGFyYztcbiAgICBhcmMgPSBhcmMgKiAxODAgLyBQSTtcblxuICAgIHZhciByID0gZGlzdGFuY2UzRCh4LCB5LCB6LCAwLCAwLCAwKTtcbiAgICB4ICs9IHNub3QuYmdfc2l6ZSAvIDI7XG4gICAgeSArPSBzbm90LmJnX3NpemUgLyAyO1xuXG4gICAgc3ByaXRlQ29udGFpbmVyLnN0eWxlWyctd2Via2l0LXRyYW5zZm9ybSddID0gJ3RyYW5zbGF0ZTNkKCcgKyBlcHNpbG9uKHgpICsgJ3B4LCcgKyBlcHNpbG9uKHkpICsgJ3B4LCcgKyBlcHNpbG9uKHopICsgJ3B4KSByb3RhdGVZKCcgKyBlcHNpbG9uKGFyYykgKyAnZGVnKSByb3RhdGVYKCcgKyBlcHNpbG9uKC0gKHkgLSBzbm90LmJnX3NpemUgLyAyKSAvIHIgKiA5MCkrJ2RlZykgcm90YXRlWSgxODBkZWcpJztcblxuICAgIHZhciBzcHJpdGVXcmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgc3ByaXRlV3JhcC5jbGFzc05hbWU9J3Nwcml0ZS13cmFwJztcbiAgICBzcHJpdGVXcmFwLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgIHNwcml0ZVdyYXAuc2V0QXR0cmlidXRlKCdkYXRhLXZpc2libGUnLCBlbGVtZW50LmRhdGEudmlzaWJsZSA9PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZSk7XG5cbiAgICBzcHJpdGVDb250YWluZXIuYXBwZW5kQ2hpbGQoc3ByaXRlV3JhcCk7XG4gICAgc25vdC5jYW1lcmEuYXBwZW5kQ2hpbGQoc3ByaXRlQ29udGFpbmVyKTtcbiAgfVxuXG4gIHZhciB1cGRhdGVfc3ByaXRlX3Zpc2liaWxpdHkgPSBmdW5jdGlvbihpZCkge1xuICAgIHZhciB2aXNpYmxlID0gc25vdC5zcHJpdGVzW2lkXS52aXNpYmxlO1xuICAgIHZhciBzcHJpdGVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgc3ByaXRlQ29udGFpbmVyLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCdkYXRhLXZpc2libGUnLCB2aXNpYmxlID8gdHJ1ZSA6IGZhbHNlKTtcbiAgfVxuXG4gIHZhciB1cGRhdGVfc3ByaXRlX3Bvc2l0aW9uID0gZnVuY3Rpb24oaWQpIHtcbiAgICB2YXIgeCA9IHNub3Quc3ByaXRlc1tpZF0ueDtcbiAgICB2YXIgeSA9IHNub3Quc3ByaXRlc1tpZF0ueTtcbiAgICB2YXIgeiA9IHNub3Quc3ByaXRlc1tpZF0uejtcbiAgICB6PS16O1xuICAgIHk9LXk7XG4gICAgdmFyIGFyYyA9IHggPT0gMCAmJiB6ID09IDAgPyAwIDogYWNvcyggeiAvIHBvdyh4ICogeCArIHogKiB6LCAwLjUpKTtcblxuICAgIGFyYyA9IHggPCAwID8gMiAqIFBJIC0gYXJjIDogYXJjO1xuICAgIGFyYyA9IGFyYyAqIDE4MC8gUEk7XG5cbiAgICB2YXIgciA9IGRpc3RhbmNlM0QoeCwgeSwgeiwgMCwgMCwgMCk7XG4gICAgeCArPSBzbm90LmJnX3NpemUgLyAyO1xuICAgIHkgKz0gc25vdC5iZ19zaXplIC8gMjtcblxuICAgIHZhciBzcHJpdGVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG5cbiAgICBzcHJpdGVDb250YWluZXIuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSAndHJhbnNsYXRlM2QoJyArIGVwc2lsb24oeCkgKyAncHgsJyArIGVwc2lsb24oeSkgKyAncHgsJyArIGVwc2lsb24oeikgKyAncHgpIHJvdGF0ZVkoJyArIGVwc2lsb24oYXJjKSArICdkZWcpIHJvdGF0ZVgoJyArIGVwc2lsb24oLSAoeSAtIHNub3QuYmdfc2l6ZSAvIDIpIC8gciAqIDkwKSArICdkZWcpIHJvdGF0ZVkoMTgwZGVnKSc7XG4gIH1cblxuICB2YXIgbW91c2VNb3ZlID0gZnVuY3Rpb24oZXZlbnQpIHtcblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICB2YXIgeCA9IE1hdGguZmxvb3IoZXZlbnQuY2xpZW50WCA+PSAwID8gZXZlbnQuY2xpZW50WCA6IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVgpO1xuICAgIHZhciB5ID0gTWF0aC5mbG9vcihldmVudC5jbGllbnRZID49IDAgPyBldmVudC5jbGllbnRZIDogZXZlbnQudG91Y2hlc1swXS5wYWdlWSk7XG4gICAgeCAtPSBkb21fb2Zmc2V0X2xlZnQ7XG4gICAgeSAtPSBkb21fb2Zmc2V0X3RvcDtcblxuICAgIHRvdWNoZXMuY2xpY2sgPSBmYWxzZTtcblxuICAgIGlmICghdG91Y2hlcy5vblRvdWNoaW5nKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LnRvdWNoZXMgJiYgZXZlbnQudG91Y2hlcy5sZW5ndGggPiAxKSB7XG5cbiAgICAgIHZhciBjZnggPSB4OyAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VycmVudCBmcmlzdCAgZmluZ2VyIHhcbiAgICAgIHZhciBjZnkgPSB5OyAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3VycmVudCBmaXJzdCAgZmluZ2VyIHlcbiAgICAgIHZhciBjc3ggPSBldmVudC50b3VjaGVzWzFdLnBhZ2VYOyAgICAgLy8gQ3VycmVudCBzZWNvbmQgZmluZ2VyIHhcbiAgICAgIHZhciBjc3kgPSBldmVudC50b3VjaGVzWzFdLnBhZ2VZOyAgICAgLy8gQ3VycmVudCBzZWNvbmQgZmluZ2VyIHlcblxuICAgICAgdmFyIGRpcyA9IGRpc3RhbmNlMkQodG91Y2hlcy5meCwgdG91Y2hlcy5meSwgdG91Y2hlcy5zeCwgdG91Y2hlcy5zeSkgLSBkaXN0YW5jZTJEKGNmeCwgY2Z5LCBjc3gsIGNzeSk7XG5cbiAgICAgIHZhciByYXRpbyA9IDAuMTI7XG4gICAgICBzbm90LnNldEZvdihzbm90LmZvdiArIGRpcyAqIHJhdGlvKTtcblxuICAgICAgdG91Y2hlcy5meCA9IGNmeDtcbiAgICAgIHRvdWNoZXMuZnkgPSBjZnk7XG4gICAgICB0b3VjaGVzLnN4ID0gY3N4O1xuICAgICAgdG91Y2hlcy5zeSA9IGNzeTtcblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciByYXRpbyA9IHNub3QubW91c2Vfc2Vuc2l0aXZpdHk7XG5cbiAgICBkaXN0X3J5ID0gZGlzdF9yeSArICh0b3VjaGVzLmZ4IC0geCkgKiByYXRpbztcbiAgICBkaXN0X3J4ID0gZGlzdF9yeCAtICh0b3VjaGVzLmZ5IC0geSkgKiByYXRpbztcblxuICAgIHRvdWNoZXMuZnggPSB4O1xuICAgIHRvdWNoZXMuZnkgPSB5O1xuXG4gICAgZGlzdF9yeCA9IGRpc3RfcnggPiA5MCA/IDkwIDogZGlzdF9yeDtcbiAgICBkaXN0X3J4ID0gZGlzdF9yeCA8IC05MCA/IC05MCA6IGRpc3Rfcng7XG5cbiAgfTtcblxuICB2YXIgbW91c2VEb3duWDtcbiAgdmFyIG1vdXNlRG93blk7XG4gIHZhciBtb3VzZURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcblxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICB2YXIgeCA9IGZsb29yKGV2ZW50LmNsaWVudFggPj0gMCA/IGV2ZW50LmNsaWVudFggOiBldmVudC50b3VjaGVzWzBdLmNsaWVudFgpO1xuICAgIHZhciB5ID0gZmxvb3IoZXZlbnQuY2xpZW50WSA+PSAwID8gZXZlbnQuY2xpZW50WSA6IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WSk7XG4gICAgeCAtPSBkb21fb2Zmc2V0X2xlZnQ7XG4gICAgeSAtPSBkb21fb2Zmc2V0X3RvcDtcblxuICAgIG1vdXNlRG93blggPSB4O1xuICAgIG1vdXNlRG93blkgPSB5O1xuXG4gICAgdG91Y2hlcy5meCA9IHg7XG4gICAgdG91Y2hlcy5meSA9IHk7XG4gICAgdG91Y2hlcy5jbGljayA9IHRydWU7XG5cbiAgICBpZiAoZXZlbnQudG91Y2hlcyAmJiBldmVudC50b3VjaGVzLmxlbmd0aCA+IDEpIHtcblxuICAgICAgdG91Y2hlcy5zeCA9IGV2ZW50LnRvdWNoZXNbMV0ucGFnZVg7XG4gICAgICB0b3VjaGVzLnN5ID0gZXZlbnQudG91Y2hlc1sxXS5wYWdlWTtcblxuICAgIH1cblxuICAgIHRvdWNoZXMub25Ub3VjaGluZyA9IHRydWU7XG4gIH1cblxuICB2YXIgbW91c2VXaGVlbCA9IGZ1bmN0aW9uIChldmVudCkge1xuXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIHZhciBvZmZzZXQgPSBldmVudC5kZWx0YVk7XG4gICAgc25vdC5zZXRGb3Yoc25vdC5mb3YgKyBvZmZzZXQgKiAwLjA2KTtcblxuICB9XG5cbiAgZnVuY3Rpb24gb25fY2xpY2soeCwgeSkge1xuICAgIHZhciBSID0gMTAwO1xuICAgIHZhciBmb3YgPSBzbm90LmZvdjtcbiAgICB2YXIgYmdfc2l6ZSA9IHNub3QuYmdfc2l6ZTtcbiAgICB2YXIgYXJjRmFjdG9yID0gTWF0aC5QSSAvIDE4MDtcbiAgICB2YXIgcnogPSBzbm90LnJ6ICogYXJjRmFjdG9yO1xuICAgIHZhciB3aWR0aCA9IHNub3Qud2lkdGg7XG4gICAgdmFyIGhlaWdodCA9IHNub3QuaGVpZ2h0O1xuXG4gICAgdmFyIHJ5ID0gKHggLyB3aWR0aCAtIDAuNSkgKiBmb3Y7XG4gICAgdmFyIHJ4ID0gKHkgLyBoZWlnaHQtMC41KSAqIGZvdiAqIGhlaWdodCAvIHdpZHRoO1xuICAgIHZhciByID0gY29zKGZvdiAvIDIgKiBhcmNGYWN0b3IpICogYmdfc2l6ZTtcbiAgICB2YXIgcmF0aW94ID0gKHggLSB3aWR0aCAvIDIpIC8gd2lkdGggKiAyO1xuICAgIHZhciByYXRpb3kgPSAoeSAtIGhlaWdodCAvIDIpIC8gd2lkdGggKiAyO1xuICAgIHZhciBQID0gc2luKGZvdiAvIDIgKiBhcmNGYWN0b3IpICogYmdfc2l6ZTtcblxuICAgIHJ5ID0gYXRhbihyYXRpb3ggKiBQIC8gcik7XG4gICAgcnggPSBhdGFuKHJhdGlveSAqIFAgLyByKTtcblxuICAgIHJ5ICo9IDE4MCAvIFBJO1xuICAgIHJ4ICo9IDE4MCAvIFBJO1xuXG4gICAgdmFyIHh5ejIgPSB1dGlsLnJvdGF0aW9uX3RvX3Bvc2l0aW9uKFIsIHJ4LCAwKTtcblxuICAgIHZhciByciA9IGRpc3RhbmNlM0QoLSB0YW4ocnkgKiBhcmNGYWN0b3IpICogeHl6MlsyXSwgLSB4eXoyWzFdLCB4eXoyWzJdLCAwLCAwLCAwKTtcbiAgICB2YXIgcmF0aW8gPSBSIC8gcnI7XG5cbiAgICB2YXIgbmV3X3ggPSAtIHRhbihyeSAqIFBJIC8gMTgwKSAqIHh5ejJbMl0gKiByYXRpbztcbiAgICB2YXIgbmV3X3kgPSAtIHh5ejJbMV0gKiByYXRpbztcbiAgICB2YXIgbmV3X3ogPSB4eXoyWzJdICogcmF0aW87XG5cbiAgICB2YXIgcG9zID0gdl9zZXRfZnJvbV9tYXRyaXhfcG9zaXRpb24obV9tdWx0aXBseShcbiAgICAgIG1fbWFrZV9yb3RhdGlvbl9heGlzKHt4OiAwLCB5OiAxLCB6OiAwfSwgLSBzbm90LnJ5ICogUEkgLyAxODApLFxuICAgICAgbV9tYWtlX3JvdGF0aW9uX2F4aXMoe3g6IDAsIHk6IDAsIHo6IDF9LCAtIHNub3QucnogKiBQSSAvIDE4MCksXG4gICAgICBtX21ha2Vfcm90YXRpb25fYXhpcyh7eDogMSwgeTogMCwgejogMH0sIC0gc25vdC5yeCAqIFBJIC8gMTgwKSxcbiAgICAgIG1fc2V0X3Bvc2l0aW9uKHt4OiBuZXdfeCwgeTogbmV3X3ksIHo6IG5ld196fSlcbiAgICApKTtcblxuICAgIGF4ID0gLSBwb3MueDtcbiAgICBheSA9IHBvcy55O1xuICAgIGF6ID0gcG9zLno7XG5cbiAgICB2YXIgbWluX29mZnNldCA9IDAuNDtcbiAgICB2YXIgbWluX2Rpc3RhbmNlID0gc25vdC5taW5fZGV0ZWN0X2Rpc3RhbmNlO1xuICAgIHZhciBuZWFyZXN0O1xuXG4gICAgdmFyIHNwcml0ZUNvbnRhaW5lcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzcHJpdGUtY29udGFpbmVyJyk7XG4gICAgZm9yICh2YXIgaSA9IDAgO2kgPCBzcHJpdGVDb250YWluZXJzLmxlbmd0aDsgKytpKSB7XG4gICAgICB2YXIgc2VsZiA9IHNwcml0ZUNvbnRhaW5lcnNbaV07XG4gICAgICB2YXIgbWF0cml4ID0gdXRpbC5jc3NfdGV4dF90b19tYXRyaXgoc2VsZi5zdHlsZS53ZWJraXRUcmFuc2Zvcm0pO1xuICAgICAgdmFyIHJhdGVfID0gMTAwIC8gZGlzdGFuY2UzRCgwLCAwLCAwLCBzbm90LmJnX3NpemUgLyAyIC0gbWF0cml4WzEyXSwgbWF0cml4WzEzXSAtIHNub3QuYmdfc2l6ZSAvIDIsIC0gbWF0cml4WzE0XSk7XG5cbiAgICAgIHZhciBkaXN0YW5jZSA9IGRpc3RhbmNlM0QoLSBheCwgLSBheSwgYXosIChzbm90LmJnX3NpemUgLyAyIC0gbWF0cml4WzEyXSkgKiByYXRlXywgcmF0ZV8gKiAobWF0cml4WzEzXSAtIHNub3QuYmdfc2l6ZSAvIDIpLCByYXRlXyAqICggLSBtYXRyaXhbMTRdKSk7XG4gICAgICBpZiAoZGlzdGFuY2UgPCBtaW5fZGlzdGFuY2UpIHtcbiAgICAgICAgbWluX2Rpc3RhbmNlID0gZGlzdGFuY2U7XG4gICAgICAgIG5lYXJlc3QgPSBzZWxmLmNoaWxkcmVuWzBdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciByb3RhdGlvbiA9IHV0aWwucG9zaXRpb25fdG9fcm90YXRpb24oYXgsIGF6LCBheSk7XG4gICAgaWYgKG5lYXJlc3QpIHtcbiAgICAgIHNub3Qub25fc3ByaXRlX2NsaWNrKHNub3Quc3ByaXRlc1tuZWFyZXN0LnBhcmVudEVsZW1lbnQuaWRdLCBuZWFyZXN0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc25vdC5vbl9jbGljayhheCwgYXksIGF6LCByb3RhdGlvblswXSwgcm90YXRpb25bMV0pO1xuICAgIH1cbiAgfVxuXG4gIHZhciBtb3VzZVVwID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgIHZhciB4ID0gZmxvb3IoZXZlbnQuY2xpZW50WCA+PSAwID8gZXZlbnQuY2xpZW50WCA6IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYKTtcbiAgICB2YXIgeSA9IGZsb29yKGV2ZW50LmNsaWVudFkgPj0gMCA/IGV2ZW50LmNsaWVudFkgOiBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSk7XG4gICAgeCAtPSBkb21fb2Zmc2V0X2xlZnQ7XG4gICAgeSAtPSBkb21fb2Zmc2V0X3RvcDtcblxuICAgIC8vU2NyZWVuIGNvb3JkaW5hdGUgdG8gU3BoZXJlIDNkIGNvb3JkaW5hdGVcbiAgICBpZiAoZGlzdGFuY2UyRChtb3VzZURvd25YLCBtb3VzZURvd25ZLCB4LCB5KSA8IDUpIHtcbiAgICAgIG9uX2NsaWNrKHgsIHkpO1xuICAgIH1cbiAgICB0b3VjaGVzLm9uVG91Y2hpbmcgPSBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9ydW4oKSB7XG4gICAgc25vdC5fYW5pbWF0ZUlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKF9ydW4pO1xuICAgIGlmICghc25vdC5wYXVzZV9hbmltYXRpb24pIHtcbiAgICAgIF91cGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBtX21ha2Vfcm90YXRpb25fZnJvbV9xdWF0ZXJuaW9uKHEpIHtcbiAgICByZXR1cm4gbmV3IFRIUkVFLk1hdHJpeDQoKS5tYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbihxKTtcbiAgfVxuXG4gIHZhciBjYW1lcmFfZXVsZXIgPSBuZXcgVEhSRUUuRXVsZXIoKTtcbiAgdmFyIHRhcmdldF9xdWF0ID0gbmV3IFRIUkVFLlF1YXRlcm5pb24oKTtcbiAgdmFyIHJvdGF0ZV85MF9xdWF0ID0gbmV3IFRIUkVFLlF1YXRlcm5pb24oLSBzcXJ0KCAwLjUgKSwgMCwgMCwgc3FydCggMC41ICkpXG4gIHZhciBhZGp1c3Rfc2NyZWVuX3F1YXRzID0ge1xuICAgIDA6IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKCkuc2V0RnJvbUF4aXNBbmdsZShuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAxKSwgMCksXG4gICAgOTA6IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKCkuc2V0RnJvbUF4aXNBbmdsZShuZXcgVEhSRUUuVmVjdG9yMygwLCAwLCAxKSwgLSA5MCksXG4gICAgMTgwOiBuZXcgVEhSRUUuUXVhdGVybmlvbigpLnNldEZyb21BeGlzQW5nbGUobmV3IFRIUkVFLlZlY3RvcjMoMCwgMCwgMSksIC0gMTgwKSxcbiAgICAnLTkwJzogbmV3IFRIUkVFLlF1YXRlcm5pb24oKS5zZXRGcm9tQXhpc0FuZ2xlKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDEpLCA5MCksXG4gIH07XG4gIHZhciBsb29rX2F0X2V1bGVyID0gbmV3IFRIUkVFLkV1bGVyKCk7XG5cbiAgZnVuY3Rpb24gdXBkYXRlX2NhbWVyYSh4LCB5LCB6KSB7XG5cbiAgICBjYW1lcmFfZXVsZXIuc2V0KHksIHgsIHosICdZWFonKTsgLy8gJ1pYWScgZm9yIHRoZSBkZXZpY2UsIGJ1dCAnWVhaJyBmb3IgdXNcblxuICAgIHRhcmdldF9xdWF0LnNldEZyb21FdWxlcihjYW1lcmFfZXVsZXIpOyAvLyBvcmllbnQgdGhlIGRldmljZVxuXG4gICAgdGFyZ2V0X3F1YXQubXVsdGlwbHkocm90YXRlXzkwX3F1YXQpOyAvLyBjYW1lcmEgbG9va3Mgb3V0IHRoZSBiYWNrIG9mIHRoZSBkZXZpY2UsIG5vdCB0aGUgdG9wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAtIFBJLzIgYXJvdW5kIHRoZSB4LWF4aXNcbiAgICB0YXJnZXRfcXVhdC5tdWx0aXBseShhZGp1c3Rfc2NyZWVuX3F1YXRzW3NjcmVlbl9vcmllbnRhdGlvbl0pOyAvLyBhZGp1c3QgZm9yIHNjcmVlbiBvcmllbnRhdGlvblxuXG4gICAgdmFyIHNsZXJwX3F1YXQgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpO1xuICAgIFRIUkVFLlF1YXRlcm5pb24uc2xlcnAodGFyZ2V0X3F1YXQsIHByZXZpb3VzX3F1YXQsIHNsZXJwX3F1YXQsIDEgLSBzbm90LnNtb290aCk7XG4gICAgcHJldmlvdXNfcXVhdCA9IHNsZXJwX3F1YXQ7XG4gICAgdmFyIGxvb2tfYXRfcXVhdCA9IHNsZXJwX3F1YXQuY2xvbmUoKTtcbiAgICBsb29rX2F0X3F1YXQueCAqPSAtMTtcbiAgICBsb29rX2F0X3F1YXQueiAqPSAtMTtcbiAgICB2YXIgbG9va19hdF9tYXQgPSBtX21ha2Vfcm90YXRpb25fZnJvbV9xdWF0ZXJuaW9uKGxvb2tfYXRfcXVhdC5ub3JtYWxpemUoKSkudHJhbnNwb3NlKCk7XG4gICAgdmFyIGxvb2tfYXRfcm90ID0gbG9va19hdF9ldWxlci5zZXRGcm9tUm90YXRpb25NYXRyaXgobG9va19hdF9tYXQsICdYWlknKTtcblxuICAgIHNub3QucnggPSBsb29rX2F0X3JvdC5feCAqIDE4MCAvIFBJO1xuICAgIHNub3QucnkgPSBsb29rX2F0X3JvdC5feSAqIDE4MCAvIFBJO1xuICAgIHNub3QucnogPSBsb29rX2F0X3JvdC5feiAqIDE4MCAvIFBJO1xuXG4gICAgc25vdC5jYW1lcmFfbG9va19hdCA9IHZfc2V0X2Zyb21fbWF0cml4X3Bvc2l0aW9uKG1fbXVsdGlwbHkoXG4gICAgICBtX21ha2Vfcm90YXRpb25fYXhpcyh7eDogMCwgeTogMSwgejogMH0sIGxvb2tfYXRfcm90Ll95KSxcbiAgICAgIG1fbWFrZV9yb3RhdGlvbl9heGlzKHt4OiAwLCB5OiAwLCB6OiAxfSwgbG9va19hdF9yb3QuX3opLFxuICAgICAgbV9tYWtlX3JvdGF0aW9uX2F4aXMoe3g6IDEsIHk6IDAsIHo6IDB9LCAtIGxvb2tfYXRfcm90Ll94KSxcbiAgICAgIG1fc2V0X3Bvc2l0aW9uKHt4OiAwLCB5OiAwLCB6OiAxfSlcbiAgICApKTsgLy8gYmFkIHBlcmZvcm1hbmNlIGhlcmVcblxuICAgIHNub3QuY2FtZXJhLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVaKCcgKyBlcHNpbG9uKHNub3QucGVyc3BlY3RpdmUpICsgJ3B4KScgKyBcIiBtYXRyaXgzZChcIiArIGxvb2tfYXRfbWF0LmVsZW1lbnRzICsgXCIpXCIrIHNub3QuY2FtZXJhQmFzZVRyYW5zZm9ybTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF91cGRhdGUoKSB7XG4gICAgc25vdC5mcmFtZXMrKztcblxuICAgIGlmIChzbm90Lmd5cm8pIHtcbiAgICAgIGlmICh2YXJzLmFscGhhID09PSAtMSAmJiB2YXJzLmJldGEgPT09IC0xICYmIHZhcnMuZ2FtbWEgPT09IC0gMSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZV9jYW1lcmEodmFycy5hbHBoYSwgdmFycy5iZXRhLCAtIHZhcnMuZ2FtbWEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocHJldl9neXJvKSB7XG4gICAgICAgIGRpc3RfcnggPSAwO1xuICAgICAgICBkaXN0X3J5ID0gMDtcbiAgICAgIH1cbiAgICAgIGRpc3RfcnkgKz0gc25vdC5hdXRvX3JvdGF0aW9uO1xuICAgICAgdXBkYXRlX2NhbWVyYSggLSBkaXN0X3J5ICogUEkgLyAxODAsIGRpc3RfcnggKiBQSSAvIDE4MCArIFBJIC8gMiwgMCk7XG4gICAgfVxuICAgIHByZXZfZ3lybyA9IHNub3QuZ3lybztcblxuICAgIGZvciAodmFyIGkgaW4gc25vdC5zcHJpdGVzKSB7XG4gICAgICB2YXIgc3ByaXRlID0gc25vdC5zcHJpdGVzW2ldO1xuICAgICAgaWYgKHNwcml0ZS5uZWVkX3VwZGF0ZV9wb3NpdGlvbikge1xuICAgICAgICBzcHJpdGUubmVlZF91cGRhdGVfcG9zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgdXBkYXRlX3Nwcml0ZV9wb3NpdGlvbihzcHJpdGUuaWQpO1xuICAgICAgfVxuICAgICAgaWYgKHNwcml0ZS5uZWVkX3VwZGF0ZV92aXNpYmlsaXR5KSB7XG4gICAgICAgIHNwcml0ZS5uZWVkX3VwZGF0ZV92aXNpYmlsaXR5ID0gZmFsc2U7XG4gICAgICAgIHVwZGF0ZV9zcHJpdGVfdmlzaWJpbGl0eShzcHJpdGUuaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIGZ1bmN0aW9uKGV2KSB7XG4gICAgc2NyZWVuX29yaWVudGF0aW9uID0gd2luZG93Lm9yaWVudGF0aW9uIHx8IDA7XG4gIH0sIGZhbHNlICk7XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RldmljZW9yaWVudGF0aW9uJywgZnVuY3Rpb24oZXYpIHtcbiAgICBpZiAoZXYuYWxwaGEgIT09IG51bGwpIHtcbiAgICAgIHZhcnMuYmV0YSA9IGV2LmJldGEgICogTWF0aC5QSSAvIDE4MCA7XG4gICAgICB2YXJzLmdhbW1hID0gZXYuZ2FtbWEgICogTWF0aC5QSSAvIDE4MDtcbiAgICAgIHZhcnMuYWxwaGEgPSBldi5hbHBoYSAgKiBNYXRoLlBJIC8gMTgwO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXJzLmJldGEgPSB2YXJzLmdhbW1hID0gdmFycy5hbHBoYSA9IC0xO1xuICAgIH1cbiAgfSwgdHJ1ZSk7XG5cblxuICB2YXIgX3NldFJ4ID0gZnVuY3Rpb24ocngsIHNtb290aCkge1xuICAgIC8vVE9ET1xuICB9XG5cbiAgdmFyIF9zZXRSeT1mdW5jdGlvbihyeSxzbW9vdGgpe1xuICAgIC8vVE9ET1xuICB9XG5cbiAgZnVuY3Rpb24gbWVyZ2VfanNvbihvYmosIGpzb24pIHtcbiAgICBmb3IgKHZhciBpIGluIGpzb24pIHtcbiAgICAgIGlmIChvYmpbaV0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG9ialtpXSA9IGpzb25baV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbWVyZ2VfanNvbihzbm90LCB7XG4gICAgc2V0Rm92OiBzZXRfZm92LFxuICAgIHNldFJ4OiBfc2V0UngsXG4gICAgc2V0Unk6IF9zZXRSeSxcbiAgICBpbml0OiBfaW5pdCxcbiAgICBydW46IF9ydW4sXG4gICAgdXBkYXRlOiBfdXBkYXRlLFxuICAgIGxvYWRfc3ByaXRlczogX2xvYWRfc3ByaXRlcyxcbiAgfSk7XG59KHdpbmRvdyk7XG4iXX0=
