THREE={},THREE.Math={clamp:function(t,i,s){return t>s?s:t<i?i:t}},THREE.Vector3=function(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(){var t;return function(i){return i instanceof THREE.Euler==0&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromEuler(i))}}(),applyAxisAngle:function(){var t;return function(i,s){return void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromAxisAngle(i,s))}}(),applyMatrix3:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[3]*s+r[6]*n,this.y=r[1]*i+r[4]*s+r[7]*n,this.z=r[2]*i+r[5]*s+r[8]*n,this},applyMatrix4:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n+r[12],this.y=r[1]*i+r[5]*s+r[9]*n+r[13],this.z=r[2]*i+r[6]*s+r[10]*n+r[14],this},applyProjection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements,e=1/(r[3]*i+r[7]*s+r[11]*n+r[15]);return this.x=(r[0]*i+r[4]*s+r[8]*n+r[12])*e,this.y=(r[1]*i+r[5]*s+r[9]*n+r[13])*e,this.z=(r[2]*i+r[6]*s+r[10]*n+r[14])*e,this},applyQuaternion:function(t){var i=this.x,s=this.y,n=this.z,r=t.x,e=t.y,h=t.z,o=t.w,a=o*i+e*n-h*s,u=o*s+h*i-r*n,c=o*n+r*s-e*i,l=-r*i-e*s-h*n;return this.x=a*o+l*-r+u*-h-c*-e,this.y=u*o+l*-e+c*-r-a*-h,this.z=c*o+l*-h+a*-e-u*-r,this},project:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.projectionMatrix,t.getInverse(i.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.matrixWorld,t.getInverse(i.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n,this.y=r[1]*i+r[5]*s+r[9]*n,this.z=r[2]*i+r[6]*s+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},clampScalar:function(){var t,i;return function(s,n){return void 0===t&&(t=new THREE.Vector3,i=new THREE.Vector3),t.set(s,s,s),i.set(n,n,n),this.clamp(t,i)}}(),clampLength:function(t,i){var s=this.length();return this.multiplyScalar(Math.max(t,Math.min(i,s))/s)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t)},cross:function(t,i){if(void 0!==i)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i);var s=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-s*t.z,this.z=s*t.y-n*t.x,this},crossVectors:function(t,i){var s=t.x,n=t.y,r=t.z,e=i.x,h=i.y,o=i.z;return this.x=n*o-r*h,this.y=r*e-s*o,this.z=s*h-n*e,this},projectOnVector:function(t){var i=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(i)},projectOnPlane:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),t.copy(this).projectOnVector(i),this.sub(t)}}(),reflect:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),this.sub(t.copy(i).multiplyScalar(2*this.dot(i)))}}(),angleTo:function(t){var i=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(THREE.Math.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y,n=this.z-t.z;return i*i+s*s+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var i=Math.sin(t.phi)*t.radius;return this.x=i*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=i*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var i=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=s,this.z=n,this},setFromMatrixColumn:function(t,i){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var s=t;t=i,i=s}return this.fromArray(t.elements,4*i)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromAttribute:function(t,i,s){return void 0===s&&(s=0),i=i*t.itemSize+s,this.x=t.array[i],this.y=t.array[i+1],this.z=t.array[i+2],this}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,i,s,n,r,e,h,o,a,u,c,l,y,_,x,f){var m=this.elements;return m[0]=t,m[4]=i,m[8]=s,m[12]=n,m[1]=r,m[5]=e,m[9]=h,m[13]=o,m[2]=a,m[6]=u,m[10]=c,m[14]=l,m[3]=y,m[7]=_,m[11]=x,m[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var i=this.elements,s=t.elements;return i[12]=s[12],i[13]=s[13],i[14]=s[14],this},extractBasis:function(t,i,s){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this},makeBasis:function(t,i,s){return this.set(t.x,i.x,s.x,0,t.y,i.y,s.y,0,t.z,i.z,s.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(i){void 0===t&&(t=new THREE.Vector3);var s=this.elements,n=i.elements,r=1/t.setFromMatrixColumn(i,0).length(),e=1/t.setFromMatrixColumn(i,1).length(),h=1/t.setFromMatrixColumn(i,2).length();return s[0]=n[0]*r,s[1]=n[1]*r,s[2]=n[2]*r,s[4]=n[4]*e,s[5]=n[5]*e,s[6]=n[6]*e,s[8]=n[8]*h,s[9]=n[9]*h,s[10]=n[10]*h,this}}(),makeRotationFromEuler:function(t){t instanceof THREE.Euler==0&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=this.elements,s=t.x,n=t.y,r=t.z,e=Math.cos(s),h=Math.sin(s),o=Math.cos(n),a=Math.sin(n),u=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){var l=e*u,y=e*c,_=h*u,x=h*c;i[0]=o*u,i[4]=-o*c,i[8]=a,i[1]=y+_*a,i[5]=l-x*a,i[9]=-h*o,i[2]=x-l*a,i[6]=_+y*a,i[10]=e*o}else if("YXZ"===t.order){var f=o*u,m=o*c,z=a*u,M=a*c;i[0]=f+M*h,i[4]=z*h-m,i[8]=e*a,i[1]=e*c,i[5]=e*u,i[9]=-h,i[2]=m*h-z,i[6]=M+f*h,i[10]=e*o}else if("ZXY"===t.order){var f=o*u,m=o*c,z=a*u,M=a*c;i[0]=f-M*h,i[4]=-e*c,i[8]=z+m*h,i[1]=m+z*h,i[5]=e*u,i[9]=M-f*h,i[2]=-e*a,i[6]=h,i[10]=e*o}else if("ZYX"===t.order){var l=e*u,y=e*c,_=h*u,x=h*c;i[0]=o*u,i[4]=_*a-y,i[8]=l*a+x,i[1]=o*c,i[5]=x*a+l,i[9]=y*a-_,i[2]=-a,i[6]=h*o,i[10]=e*o}else if("YZX"===t.order){var E=e*o,d=e*a,v=h*o,p=h*a;i[0]=o*u,i[4]=p-E*c,i[8]=v*c+d,i[1]=c,i[5]=e*u,i[9]=-h*u,i[2]=-a*u,i[6]=d*c+v,i[10]=E-p*c}else if("XZY"===t.order){var E=e*o,d=e*a,v=h*o,p=h*a;i[0]=o*u,i[4]=-c,i[8]=a*u,i[1]=E*c+p,i[5]=e*u,i[9]=d*c-v,i[2]=v*c-d,i[6]=h*u,i[10]=p*c+E}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){var i=this.elements,s=t.x,n=t.y,r=t.z,e=t.w,h=s+s,o=n+n,a=r+r,u=s*h,c=s*o,l=s*a,y=n*o,_=n*a,x=r*a,f=e*h,m=e*o,z=e*a;return i[0]=1-(y+x),i[4]=c-z,i[8]=l+m,i[1]=c+z,i[5]=1-(u+x),i[9]=_-f,i[2]=l-m,i[6]=_+f,i[10]=1-(u+y),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},lookAt:function(){var t,i,s;return function(n,r,e){void 0===t&&(t=new THREE.Vector3,i=new THREE.Vector3,s=new THREE.Vector3);var h=this.elements;return s.subVectors(n,r).normalize(),0===s.lengthSq()&&(s.z=1),t.crossVectors(e,s).normalize(),0===t.lengthSq()&&(s.z+=1e-4,t.crossVectors(e,s).normalize()),i.crossVectors(s,t),h[0]=t.x,h[4]=i.x,h[8]=s.x,h[1]=t.y,h[5]=i.y,h[9]=s.y,h[2]=t.z,h[6]=i.z,h[10]=s.z,this}}(),multiply:function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var s=t.elements,n=i.elements,r=this.elements,e=s[0],h=s[4],o=s[8],a=s[12],u=s[1],c=s[5],l=s[9],y=s[13],_=s[2],x=s[6],f=s[10],m=s[14],z=s[3],M=s[7],E=s[11],d=s[15],v=n[0],p=n[4],w=n[8],b=n[12],g=n[1],R=n[5],T=n[9],C=n[13],H=n[2],V=n[6],j=n[10],k=n[14],F=n[3],S=n[7],A=n[11],Z=n[15];return r[0]=e*v+h*g+o*H+a*F,r[4]=e*p+h*R+o*V+a*S,r[8]=e*w+h*T+o*j+a*A,r[12]=e*b+h*C+o*k+a*Z,r[1]=u*v+c*g+l*H+y*F,r[5]=u*p+c*R+l*V+y*S,r[9]=u*w+c*T+l*j+y*A,r[13]=u*b+c*C+l*k+y*Z,r[2]=_*v+x*g+f*H+m*F,r[6]=_*p+x*R+f*V+m*S,r[10]=_*w+x*T+f*j+m*A,r[14]=_*b+x*C+f*k+m*Z,r[3]=z*v+M*g+E*H+d*F,r[7]=z*p+M*R+E*V+d*S,r[11]=z*w+M*T+E*j+d*A,r[15]=z*b+M*C+E*k+d*Z,this},multiplyToArray:function(t,i,s){var n=this.elements;return this.multiplyMatrices(t,i),s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},applyToVector3Array:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length);for(var r=0,e=s;r<n;r+=3,e+=3)t.fromArray(i,e),t.applyMatrix4(this),t.toArray(i,e);return i}}(),applyToBuffer:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length/i.itemSize);for(var r=0,e=s;r<n;r++,e++)t.x=i.getX(e),t.y=i.getY(e),t.z=i.getZ(e),t.applyMatrix4(this),i.setXYZ(t.x,t.y,t.z);return i}}(),determinant:function(){var t=this.elements,i=t[0],s=t[4],n=t[8],r=t[12],e=t[1],h=t[5],o=t[9],a=t[13],u=t[2],c=t[6],l=t[10],y=t[14],_=t[3],x=t[7],f=t[11],m=t[15];return _*(+r*o*c-n*a*c-r*h*l+s*a*l+n*h*y-s*o*y)+x*(+i*o*y-i*a*l+r*e*l-n*e*y+n*a*u-r*o*u)+f*(+i*a*c-i*h*y-r*e*c+s*e*y+r*h*u-s*a*u)+m*(-n*h*u-i*o*c+i*h*l+n*e*c-s*e*l+s*o*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},flattenToArrayOffset:function(t,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,i)},getPosition:function(){var t;return function(){return void 0===t&&(t=new THREE.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t,i){var s=this.elements,n=t.elements,r=n[0],e=n[1],h=n[2],o=n[3],a=n[4],u=n[5],c=n[6],l=n[7],y=n[8],_=n[9],x=n[10],f=n[11],m=n[12],z=n[13],M=n[14],E=n[15],d=_*M*l-z*x*l+z*c*f-u*M*f-_*c*E+u*x*E,v=m*x*l-y*M*l-m*c*f+a*M*f+y*c*E-a*x*E,p=y*z*l-m*_*l+m*u*f-a*z*f-y*u*E+a*_*E,w=m*_*c-y*z*c-m*u*x+a*z*x+y*u*M-a*_*M,b=r*d+e*v+h*p+o*w;if(0===b){var g="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(g);return console.warn(g),this.identity()}var R=1/b;return s[0]=d*R,s[1]=(z*x*o-_*M*o-z*h*f+e*M*f+_*h*E-e*x*E)*R,s[2]=(u*M*o-z*c*o+z*h*l-e*M*l-u*h*E+e*c*E)*R,s[3]=(_*c*o-u*x*o-_*h*l+e*x*l+u*h*f-e*c*f)*R,s[4]=v*R,s[5]=(y*M*o-m*x*o+m*h*f-r*M*f-y*h*E+r*x*E)*R,s[6]=(m*c*o-a*M*o-m*h*l+r*M*l+a*h*E-r*c*E)*R,s[7]=(a*x*o-y*c*o+y*h*l-r*x*l-a*h*f+r*c*f)*R,s[8]=p*R,s[9]=(m*_*o-y*z*o-m*e*f+r*z*f+y*e*E-r*_*E)*R,s[10]=(a*z*o-m*u*o+m*e*l-r*z*l-a*e*E+r*u*E)*R,s[11]=(y*u*o-a*_*o-y*e*l+r*_*l+a*e*f-r*u*f)*R,s[12]=w*R,s[13]=(y*z*h-m*_*h+m*e*x-r*z*x-y*e*M+r*_*M)*R,s[14]=(m*u*h-a*z*h-m*e*c+r*z*c+a*e*M-r*u*M)*R,s[15]=(a*_*h-y*u*h+y*e*c-r*_*c-a*e*x+r*u*x)*R,this},scale:function(t){var i=this.elements,s=t.x,n=t.y,r=t.z;return i[0]*=s,i[4]*=n,i[8]*=r,i[1]*=s,i[5]*=n,i[9]*=r,i[2]*=s,i[6]*=n,i[10]*=r,i[3]*=s,i[7]*=n,i[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,s,n))},makeTranslation:function(t,i,s){return this.set(1,0,0,t,0,1,0,i,0,0,1,s,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,i,-s,0,0,s,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,0,s,0,0,1,0,0,-s,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,-s,0,0,s,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var s=Math.cos(i),n=Math.sin(i),r=1-s,e=t.x,h=t.y,o=t.z,a=r*e,u=r*h;return this.set(a*e+s,a*h-n*o,a*o+n*h,0,a*h+n*o,u*h+s,u*o-n*e,0,a*o-n*h,u*o+n*e,r*o*o+s,0,0,0,0,1),this},makeScale:function(t,i,s){return this.set(t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1),this},compose:function(t,i,s){return this.makeRotationFromQuaternion(i),this.scale(s),this.setPosition(t),this},decompose:function(){var t,i;return function(s,n,r){void 0===t&&(t=new THREE.Vector3,i=new THREE.Matrix4);var e=this.elements,h=t.set(e[0],e[1],e[2]).length(),o=t.set(e[4],e[5],e[6]).length(),a=t.set(e[8],e[9],e[10]).length(),u=this.determinant();u<0&&(h=-h),s.x=e[12],s.y=e[13],s.z=e[14],i.elements.set(this.elements);var c=1/h,l=1/o,y=1/a;return i.elements[0]*=c,i.elements[1]*=c,i.elements[2]*=c,i.elements[4]*=l,i.elements[5]*=l,i.elements[6]*=l,i.elements[8]*=y,i.elements[9]*=y,i.elements[10]*=y,n.setFromRotationMatrix(i),r.x=h,r.y=o,r.z=a,this}}(),makeFrustum:function(t,i,s,n,r,e){var h=this.elements,o=2*r/(i-t),a=2*r/(n-s),u=(i+t)/(i-t),c=(n+s)/(n-s),l=-(e+r)/(e-r),y=-2*e*r/(e-r);return h[0]=o,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=a,h[9]=c,h[13]=0,h[2]=0,h[6]=0,h[10]=l,h[14]=y,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makePerspective:function(t,i,s,n){var r=s*Math.tan(THREE.Math.DEG2RAD*t*.5),e=-r,h=e*i,o=r*i;return this.makeFrustum(h,o,e,r,s,n)},makeOrthographic:function(t,i,s,n,r,e){var h=this.elements,o=1/(i-t),a=1/(s-n),u=1/(e-r),c=(i+t)*o,l=(s+n)*a,y=(e+r)*u;return h[0]=2*o,h[4]=0,h[8]=0,h[12]=-c,h[1]=0,h[5]=2*a,h[9]=0,h[13]=-l,h[2]=0,h[6]=0,h[10]=-2*u,h[14]=-y,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},equals:function(t){for(var i=this.elements,s=t.elements,n=0;n<16;n++)if(i[n]!==s[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var s=this.elements;return t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=s[3],t[i+4]=s[4],t[i+5]=s[5],t[i+6]=s[6],t[i+7]=s[7],t[i+8]=s[8],t[i+9]=s[9],t[i+10]=s[10],t[i+11]=s[11],t[i+12]=s[12],t[i+13]=s[13],t[i+14]=s[14],t[i+15]=s[15],t}},THREE.Quaternion=function(t,i,s,n){this._x=t||0,this._y=i||0,this._z=s||0,this._w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,i,s,n){return this._x=t,this._y=i,this._z=s,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,i){if(t instanceof THREE.Euler==0)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var s=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),e=Math.sin(t._x/2),h=Math.sin(t._y/2),o=Math.sin(t._z/2),a=t.order;return"XYZ"===a?(this._x=e*n*r+s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r-e*h*o):"YXZ"===a?(this._x=e*n*r+s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r+e*h*o):"ZXY"===a?(this._x=e*n*r-s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r-e*h*o):"ZYX"===a?(this._x=e*n*r-s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r+e*h*o):"YZX"===a?(this._x=e*n*r+s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r-e*h*o):"XZY"===a&&(this._x=e*n*r-s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r+e*h*o),i!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,i){var s=i/2,n=Math.sin(s);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(s),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var i,s=t.elements,n=s[0],r=s[4],e=s[8],h=s[1],o=s[5],a=s[9],u=s[2],c=s[6],l=s[10],y=n+o+l;return y>0?(i=.5/Math.sqrt(y+1),this._w=.25/i,this._x=(c-a)*i,this._y=(e-u)*i,this._z=(h-r)*i):n>o&&n>l?(i=2*Math.sqrt(1+n-o-l),this._w=(c-a)/i,this._x=.25*i,this._y=(r+h)/i,this._z=(e+u)/i):o>l?(i=2*Math.sqrt(1+o-n-l),this._w=(e-u)/i,this._x=(r+h)/i,this._y=.25*i,this._z=(a+c)/i):(i=2*Math.sqrt(1+l-n-o),this._w=(h-r)/i,this._x=(e+u)/i,this._y=(a+c)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,i,s=1e-6;return function(n,r){return void 0===t&&(t=new THREE.Vector3),i=n.dot(r)+1,i<s?(i=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=i,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,i){var s=t._x,n=t._y,r=t._z,e=t._w,h=i._x,o=i._y,a=i._z,u=i._w;return this._x=s*u+e*h+n*a-r*o,this._y=n*u+e*o+r*h-s*a,this._z=r*u+e*a+s*o-n*h,this._w=e*u-s*h-n*o-r*a,this.onChangeCallback(),this},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var s=this._x,n=this._y,r=this._z,e=this._w,h=e*t._w+s*t._x+n*t._y+r*t._z;if(h<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=e,this._x=s,this._y=n,this._z=r,this;var o=Math.sqrt(1-h*h);if(Math.abs(o)<.001)return this._w=.5*(e+this._w),this._x=.5*(s+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var a=Math.atan2(o,h),u=Math.sin((1-i)*a)/o,c=Math.sin(i*a)/o;return this._w=e*u+this._w*c,this._x=s*u+this._x*c,this._y=n*u+this._y*c,this._z=r*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(THREE.Quaternion,{slerp:function(t,i,s,n){return s.copy(t).slerp(i,n)},slerpFlat:function(t,i,s,n,r,e,h){var o=s[n+0],a=s[n+1],u=s[n+2],c=s[n+3],l=r[e+0],y=r[e+1],_=r[e+2],x=r[e+3];if(c!==x||o!==l||a!==y||u!==_){var f=1-h,m=o*l+a*y+u*_+c*x,z=m>=0?1:-1,M=1-m*m;if(M>Number.EPSILON){var E=Math.sqrt(M),d=Math.atan2(E,m*z);f=Math.sin(f*d)/E,h=Math.sin(h*d)/E}var v=h*z;if(o=o*f+l*v,a=a*f+y*v,u=u*f+_*v,c=c*f+x*v,f===1-h){var p=1/Math.sqrt(o*o+a*a+u*u+c*c);o*=p,a*=p,u*=p,c*=p}}t[i]=o,t[i+1]=a,t[i+2]=u,t[i+3]=c}}),THREE.Euler=function(t,i,s,n){this._x=t||0,this._y=i||0,this._z=s||0,this._order=n||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,i,s,n){return this._x=t,this._y=i,this._z=s,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,i,s){var n=THREE.Math.clamp,r=t.elements,e=r[0],h=r[4],o=r[8],a=r[1],u=r[5],c=r[9],l=r[2],y=r[6],_=r[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-c,_),this._z=Math.atan2(-h,e)):(this._x=Math.atan2(y,u),this._z=0)):"YXZ"===i?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(o,_),this._z=Math.atan2(a,u)):(this._y=Math.atan2(-l,e),this._z=0)):"ZXY"===i?(this._x=Math.asin(n(y,-1,1)),Math.abs(y)<.99999?(this._y=Math.atan2(-l,_),this._z=Math.atan2(-h,u)):(this._y=0,this._z=Math.atan2(a,e))):"ZYX"===i?(this._y=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(y,_),this._z=Math.atan2(a,e)):(this._x=0,this._z=Math.atan2(-h,u))):"YZX"===i?(this._z=Math.asin(n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,e)):(this._x=0,this._y=Math.atan2(o,_))):"XZY"===i?(this._z=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(y,u),this._y=Math.atan2(o,e)):(this._x=Math.atan2(-c,_),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,s!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(i,s,n){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationFromQuaternion(i),this.setFromRotationMatrix(t,s,n)}}(),setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(){var t=new THREE.Quaternion;return function(i){return t.setFromEuler(this),this.setFromQuaternion(t,i)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}};
!function(){function e(e){return e.replace(y,"").replace(w,",").replace(b,"").replace(x,"").replace(T,"").split(E)}function n(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function t(t,r){function a(e){return p+=e.split(/\n/).length-1,s&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=v[1]+n(e)+v[2]+"\n"),e}function i(n){var t=p;if(u?n=u(n,r):o&&(n=n.replace(/\n/g,function(){return p++,"$line="+p+";"})),0===n.indexOf("=")){var a=f&&!/^=[=#]/.test(n);if(n=n.replace(/^=[=#]?|[\s;]*$/g,""),a){var i=n.replace(/\s*\([^\)]+\)/,"");$[i]||/^(include|print)$/.test(i)||(n="$escape("+n+")")}else n="$string("+n+")";n=v[1]+n+v[2]}return o&&(n="$line="+t+";"+n),h(e(n),function(e){if(e&&!d[e]){var n;n="print"===e?w:"include"===e?b:$[e]?"$utils."+e:g[e]?"$helpers."+e:"$data."+e,x+=e+"="+n+",",d[e]=!0}}),n+"\n"}var o=r.debug,c=r.openTag,l=r.closeTag,u=r.parser,s=r.compress,f=r.escape,p=1,d={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},m="".trim,v=m?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=m?"$out+=text;return $out;":"$out.push(text);",w="function(){var text=''.concat.apply('',arguments);"+y+"}",b="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",x="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(o?"$line=0,":""),T=v[0],E="return new String("+v[3]+");";h(t.split(c),function(e){e=e.split(l);var n=e[0],t=e[1];1===e.length?T+=a(n):(T+=i(n),t&&(T+=a(t)))});var j=x+T+E;o&&(j="try{"+j+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+n(t)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var S=new Function("$data","$filename",j);return S.prototype=$,S}catch(W){throw W.temp="function anonymous($data,$filename) {"+j+"}",W}}var r=function(e,n){return"string"==typeof n?m(n,{filename:e}):o(e,n)};r.version="3.0.0",r.config=function(e,n){a[e]=n};var a=r.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},i=r.cache={};r.render=function(e,n){return m(e,n)};var o=r.renderFile=function(e,n){var t=r.get(e)||d({filename:e,name:"Render Error",message:"Template not found"});return n?t(n):t};r.get=function(e){var n;if(i[e])n=i[e];else if("object"==typeof document){var t=document.getElementById(e);if(t){var r=(t.value||t.innerHTML).replace(/^\s*|\s*$/g,"");n=m(r,{filename:e})}}return n};var c=function(e,n){return"string"!=typeof e&&(n=typeof e,"number"===n?e+="":e="function"===n?c(e.call(e)):""),e},l={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},u=function(e){return l[e]},s=function(e){return c(e).replace(/&(?![\w#]+;)|[<>"']/g,u)},f=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=function(e,n){var t,r;if(f(e))for(t=0,r=e.length;r>t;t++)n.call(e,e[t],t,e);else for(t in e)n.call(e,e[t],t)},$=r.utils={$helpers:{},$include:o,$string:c,$escape:s,$each:p};r.helper=function(e,n){g[e]=n};var g=r.helpers=$.$helpers;r.onerror=function(e){var n="Template Error\n\n";for(var t in e)n+="<"+t+">\n"+e[t]+"\n\n";"object"==typeof console&&console.error(n)};var d=function(e){return r.onerror(e),function(){return"{Template Error}"}},m=r.compile=function(e,n){function r(t){try{return new l(t,c)+""}catch(r){return n.debug?d(r)():(n.debug=!0,m(e,n)(t))}}n=n||{};for(var o in a)void 0===n[o]&&(n[o]=a[o]);var c=n.filename;try{var l=t(e,n)}catch(u){return u.filename=c||"anonymous",u.name="Syntax Error",d(u)}return r.prototype=l.prototype,r.toString=function(){return l.toString()},c&&n.cache&&(i[c]=r),r},h=$.$each,v="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,w=/[^\w$]+/g,b=new RegExp(["\\b"+v.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),x=/^\d[^,]*|,\d[^,]*/g,T=/^,+|,+$/g,E=/^$|,+/;"function"==typeof define?define(function(){return r}):"undefined"!=typeof exports?module.exports=r:this.template=r}();
!function(t){function e(t){var e=0;if(t.offsetParent)do e+=t.offsetTop;while(t=t.offsetParent);return e}function n(t){var e=0;if(t.offsetParent)do e+=t.offsetLeft;while(t=t.offsetParent);return e}function o(){return r()<500}function i(){return window.navigator.userAgent.indexOf("MicroMessenger")>=0}function r(){return document.documentElement.clientWidth}function a(){return document.documentElement.clientHeight}function u(t,e,n){var o=s(t,e,n,0,0,0),i=Math.asin(n/o),r=Math.asin(e/o/Math.cos(i));return t<0&&(r=r>0?Math.PI-r:-Math.PI-r),{rx:180*-i/Math.PI,ry:180*(r<0?r+2*Math.PI:r)/Math.PI}}function m(t,e,n,o){return Math.pow((t-n)*(t-n)+(e-o)*(e-o),.5)}function s(t,e,n,o,i,r){return Math.pow((t-o)*(t-o)+(e-i)*(e-i)+(n-r)*(n-r),.5)}function c(t){return Math.abs(t)<1e-6?0:t.toFixed(5)}function f(t){var e=new WebKitCSSMatrix(t);return[c(e.m11),c(e.m12),c(e.m13),c(e.m14),c(e.m21),c(e.m22),c(e.m23),c(e.m24),c(e.m31),c(e.m32),c(e.m33),c(e.m34),c(e.m41),c(e.m42),c(e.m43),c(e.m44)]}function d(t,e,n,o,i,r,a,u,m,s,c,f,d,w,_,l){return"object"==typeof t?"matrix3d("+t.join(",")+")":"matrix3d("+t+","+e+","+n+","+o+","+i+","+r+","+a+","+u+","+m+","+s+","+c+","+f+","+d+","+w+","+_+","+l+")"}function w(t){if(window.WebGLRenderingContext){for(var e=document.createElement("canvas"),n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],o=!1,i=0;i<4;i++)try{if(o=e.getContext(n[i]),o&&"function"==typeof o.getParameter)return!t||{name:n[i],gl:o}}catch(r){}return!1}return!1}function _(t,e){var n=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",t),n.appendChild(o),o.onload=function(){e()}}function l(t,e,n,o){t=-t,e=-e;var i=snot.bg_size/2,r=snot.bg_size/2,a=f("translate3d("+i+"px,"+r+"px,0) rotateY(0deg) rotateX(0deg) rotateY("+(n?-n:0)+"deg) rotateX("+(e?-e:0)+"deg) rotateZ("+(o?o:0)+"deg) translateZ("+t+"px)");return[-a[12]+snot.bg_size/2,a[13]-snot.bg_size/2,-a[14]]}function g(t,e){return(new THREE.Matrix4).makeRotationAxis(t,e)}function p(){for(var t=arguments,e=t.length;e>1;){var n=t[e-2],o=t[e-1];t[e-2]=(new THREE.Matrix4).multiplyMatrices(n,o),e--}return t[0]}function x(t){return(new THREE.Vector3).setFromMatrixPosition(t)}function h(t){return(new THREE.Matrix4).setPosition(t)}function M(t){return(new THREE.Matrix4).makeRotationFromQuaternion(t)}function b(t,e){for(var n in e)void 0==t[n]&&(t[n]=e[n])}t.template&&(t.template.config("openTag","<#"),t.template.config("closeTag","#>")),t.snot={},t.snot.util={left_pos:n,top_pos:e,is_mobile:o,is_wechat_login:i,get_window_width:r,get_window_height:a,position_to_rotation:u,distance2D:m,distance3D:s,epsilon:c,css_text_to_matrix:f,matrix_to_css_text:d,webgl_detect:w,webgl_enabled:w(),load_js:_,rotation_to_position:l,v_set_from_matrix_position:x,m_make_rotation_axis:g,m_multiply:p,m_set_position:h,m_make_rotation_from_quaternion:M,merge_json:b},window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}()}(window);
!function(t){function e(t,e,a){var r=200/Z(t,e,a,0,0,0);return[t*r,e*r,a*r]}function a(){for(var t=document.getElementsByClassName("sprite"),e=0;e<t.length;++e)t[e].remove()}function r(t,e){var a,r={front:"rotateY(90deg)                rotateZ("+e[0]+"deg)  translateZ(-"+x.bg_size/2+"px)",bottom:"rotateY(90deg)rotateX(90deg)  rotateZ("+e[1]+"deg)  translateZ(-"+x.bg_size/2+"px) rotateZ(90deg)",left:"rotateY(90deg)rotateY(90deg)  rotateZ("+e[2]+"deg)  translateZ(-"+x.bg_size/2+"px)",back:"rotateY(90deg)rotateY(180deg) rotateZ("+e[3]+"deg)  translateZ(-"+x.bg_size/2+"px)",top:"rotateY(90deg)rotateX(-90deg) rotateZ("+e[4]+"deg)  translateZ(-"+x.bg_size/2+"px) rotateZ(-90deg)",right:"rotateY(90deg)rotateY(-90deg) rotateZ("+e[5]+"deg)  translateZ(-"+x.bg_size/2+"px)"},o=0;for(var n in r)a=document.getElementsByClassName("snot-bg "+n)[0],a.style["-webkit-transform"]=r[n],a.style.width=x.bg_size+2+"px",a.style.height=x.bg_size+2+"px",a.setAttribute("src",t[o]),a.setAttribute("data-index",o),++o}function o(t,e){var a=e.x,r=-e.z,o=-e.y,n=document.createElement("div");n.style.display="inline-block",n.style.position="absolute",n.className="sprite-container",n.id=t.data.id,n.style["-webkit-transform-origin-x"]="0",n.style["-webkit-transform-origin-y"]="0";var i=0==a&&0==r?0:g(r/u(a*a+r*r,.5));i=a<0?2*l-i:i,i=180*i/l;var s=Z(a,o,r,0,0,0);a+=x.bg_size/2,o+=x.bg_size/2,n.style["-webkit-transform"]="translate3d("+T(a)+"px,"+T(o)+"px,"+T(r)+"px) rotateY("+T(i)+"deg) rotateX("+T(-(o-x.bg_size/2)/s*90)+"deg) rotateY(180deg)";var d=document.createElement("div");d.className="sprite-wrap",d.appendChild(t),d.setAttribute("data-visible",0!=t.data.visible),n.appendChild(d),x.camera.appendChild(n)}function n(){x._animateId=requestAnimationFrame(n),x.pause_animation||s()}function i(t,e,a){B.set(e,t,a,"YXZ"),F.setFromEuler(B),F.multiply(I),F.multiply(Q[x.controls.screen_orientation]);var r=new THREE.Quaternion;THREE.Quaternion.slerp(F,f,r,1-x.smooth),f=r;var o=r.clone();o.x*=-1,o.z*=-1;var n=h(o.normalize()).transpose(),i=C.setFromRotationMatrix(n,"XZY");x.rx=180*i._x/l,x.ry=180*i._y/l,x.rz=180*i._z/l,x.camera_look_at=w(z(b({x:0,y:1,z:0},i._y),b({x:0,y:0,z:1},i._z),b({x:1,y:0,z:0},-i._x),E({x:0,y:0,z:1}))),x.camera.style.transform="translateZ("+T(x.perspective)+"px) matrix3d("+n.elements+")"+x.cameraBaseTransform}function s(){if(x.frames++,x.gyro){if(x.controls.gyro_data.alpha===-1&&x.controls.gyro_data.beta===-1&&x.controls.gyro_data.gamma===-1)return;i(gyro_data.alpha,x.controls.gyro_data.beta,-x.controls.gyro_data.gamma)}else d&&(x.dest_rx=0,x.dest_ry=0),x.dest_ry+=x.auto_rotation,i(-x.dest_ry*l/180,x.dest_rx*l/180+l/2,0);d=x.gyro;for(var t in x.sprites){var e=x.sprites[t];e.need_update_position&&(e.need_update_position=!1,M(e.id)),e.need_update_visibility&&(e.need_update_visibility=!1,A(e.id))}}var d,l=Math.PI,_=Math.sin,m=Math.cos,c=Math.tan,g=Math.acos,p=Math.atan,u=Math.pow,y=(Math.floor,Math.sqrt),x={camera_look_at:{x:0,y:0,z:1},controls:{screen_orientation:0,gyro_data:{alpha:0,beta:90*l/180,gamma:0}},mouse_sensitivity:.3,auto_rotation:0,frames:0,bg_rotation:[0,0,0,0,0,0],pause_animation:!1,dom:document.getElementById("snot-wrap"),camera:document.getElementById("snot-camera"),container:document.getElementById("snot-container"),bg_size:1024,generator:{},gyro:!1,ry:0,rx:0,dest_rx:0,dest_ry:0,dest_rz:0,max_fov:120,min_fov:60,fov:90,smooth:.17,min_detect_distance:20,on_click:function(){},on_sprite_click:function(){}},f=new THREE.Quaternion;if(!t.snot)return void console.error("snot-utils.js is missing");for(var v in x)t.snot[v]=x[v];x=t.snot;var b=x.util.m_make_rotation_axis,z=x.util.m_multiply,E=x.util.m_set_position,h=x.util.m_make_rotation_from_quaternion,w=x.util.v_set_from_matrix_position,k=t.snot.util,T=k.epsilon,Z=k.distance3D,H=(k.distance2D,function(t){t<x.min_fov||t>x.max_fov||(x.fov=t,x.container.style["-webkit-transform"]="scale("+c(x.max_fov/2*l/180)/c(x.fov/2*l/180)+")")}),Y=function(t,e){a(),cancelAnimationFrame(x._animateId);for(var o in t)"generator"==o&&k.merge_json(x.generator,t.generator),x[o]=t[o];d=x.gyro,x.dest_rx=x.rx+.1,x.dest_ry=x.ry,e||(x.width=x.dom.offsetWidth,x.height=x.dom.offsetHeight,x.perspective=x.width/2/c(x.max_fov/2*l/180),x.container.style["-webkit-perspective"]=x.perspective+"px",x.cameraBaseTransform="translateX("+T(-(x.bg_size-x.width)/2)+"px) translateY("+T(-(x.bg_size-x.height)/2)+"px)",x.camera.style["-webkit-transform"]="translateZ(-"+x.perspective+"px) rotateX("+x.rx+"deg) rotateY("+x.ry+"deg)"+x.cameraBaseTransform),H(x.fov),t.bg_imgs&&r(t.bg_imgs,t.bg_rotation||x.bg_rotation),t&&R(t.sprites),k.is_mobile(),t.callback&&t.callback(),x.init_controls(),s()},R=function(t){for(var a in t){var r=t[a];if(r.standardlization){var n=e(r.x,r.y,r.z);r.x=n[0],r.y=n[1],r.z=n[2]}var i=document.createElement("div");i.innerHTML=template(x.generator[r.generator],r);var s=i.firstChild;s.data=t[a],o(s,r)}},A=function(t){var e=x.sprites[t].visible,a=document.getElementById(t);a.firstChild.setAttribute("data-visible",!!e)},M=function(t){var e=x.sprites[t].x,a=x.sprites[t].y,r=x.sprites[t].z;r=-r,a=-a;var o=0==e&&0==r?0:g(r/u(e*e+r*r,.5));o=e<0?2*l-o:o,o=180*o/l;var n=Z(e,a,r,0,0,0);e+=x.bg_size/2,a+=x.bg_size/2;var i=document.getElementById(t);i.style["-webkit-transform"]="translate3d("+T(e)+"px,"+T(a)+"px,"+T(r)+"px) rotateY("+T(o)+"deg) rotateX("+T(-(a-x.bg_size/2)/n*90)+"deg) rotateY(180deg)"},B=new THREE.Euler,F=new THREE.Quaternion,I=new THREE.Quaternion((-y(.5)),0,0,y(.5)),Q={0:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1),0),90:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1),-90),180:(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1),-180),"-90":(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1),90)},C=new THREE.Euler,X=function(t,e){},N=function(t,e){};x.controls.mouse_click=function(t,e){var a=100,r=x.fov,o=x.bg_size,n=Math.PI/180,i=(x.rz*n,x.width),s=x.height,d=(t/i-.5)*r,g=(e/s-.5)*r*s/i,u=m(r/2*n)*o,y=(t-i/2)/i*2,f=(e-s/2)/i*2,v=_(r/2*n)*o;d=p(y*v/u),g=p(f*v/u),d*=180/l,g*=180/l;var h=k.rotation_to_position(a,g,0),T=Z(-c(d*n)*h[2],-h[1],h[2],0,0,0),H=a/T,Y=-c(d*l/180)*h[2]*H,R=-h[1]*H,A=h[2]*H,M=w(z(b({x:0,y:1,z:0},-x.ry*l/180),b({x:0,y:0,z:1},-x.rz*l/180),b({x:1,y:0,z:0},-x.rx*l/180),E({x:Y,y:R,z:A})));ax=-M.x,ay=M.y,az=M.z;for(var B,F=x.min_detect_distance,I=document.getElementsByClassName("sprite-container"),Q=0;Q<I.length;++Q){var C=I[Q],X=k.css_text_to_matrix(C.style.webkitTransform),N=100/Z(0,0,0,x.bg_size/2-X[12],X[13]-x.bg_size/2,-X[14]),V=Z(-ax,-ay,az,(x.bg_size/2-X[12])*N,N*(X[13]-x.bg_size/2),N*-X[14]);V<F&&(F=V,B=C.children[0])}var j=k.position_to_rotation(ax,az,ay);B?x.on_sprite_click(x.sprites[B.parentElement.id],B):x.on_click(ax,ay,az,j[0],j[1])},k.merge_json(x,{setFov:H,set_rx:X,set_ry:N,init:Y,run:n,update:s,load_sprites:R})}(window);
!function(t){var o,n;snot.init_controls=function(){n=e.left_pos(snot.dom),o=e.top_pos(snot.dom),snot.container.addEventListener("touchstart",c,!1),snot.container.addEventListener("touchmove",r,!1),snot.container.addEventListener("touchend",d,!1),snot.container.addEventListener("mousedown",c,!1),snot.container.addEventListener("mousemove",r,!1),snot.container.addEventListener("mouseup",d,!1),snot.container.addEventListener("mousewheel",u,!1),window.addEventListener("orientationchange",function(t){snot.controls.screen_orientation=window.orientation||0},!1),window.addEventListener("deviceorientation",function(t){null!==t.alpha?(snot.controls.gyro_data.beta=t.beta*Math.PI/180,snot.controls.gyro_data.gamma=t.gamma*Math.PI/180,snot.controls.gyro_data.alpha=t.alpha*Math.PI/180):snot.controls.gyro_data.beta=gyro_data.gamma=gyro_data.alpha=-1},!0)};var e=snot.util,s=(e.distance3D,e.distance2D),a=Math.floor,i=(Math.cos,Math.sin,Math.atan,Math.tan,Math.PI,snot.util.m_make_rotation_axis,snot.util.m_multiply,snot.util.m_set_position,snot.util.m_make_rotation_from_quaternion,snot.util.v_set_from_matrix_position,{fx:0,fy:0,sx:0,sy:0}),r=function(t){t.preventDefault(),t.stopPropagation();var e=Math.floor(t.clientX>=0?t.clientX:t.touches[0].pageX),a=Math.floor(t.clientY>=0?t.clientY:t.touches[0].pageY);if(e-=n,a-=o,i.click=!1,!i.is_touching)return!1;if(t.touches&&t.touches.length>1){var r=e,c=a,u=t.touches[1].pageX,d=t.touches[1].pageY,l=s(i.fx,i.fy,i.sx,i.sy)-s(r,c,u,d),_=.12;return snot.setFov(snot.fov+l*_),i.fx=r,i.fy=c,i.sx=u,i.sy=d,!1}var _=snot.mouse_sensitivity;snot.dest_ry=snot.dest_ry+(i.fx-e)*_,snot.dest_rx=snot.dest_rx-(i.fy-a)*_,i.fx=e,i.fy=a,snot.dest_rx=snot.dest_rx>90?90:snot.dest_rx,snot.dest_rx=snot.dest_rx<-90?-90:snot.dest_rx},c=function(t){t.preventDefault(),t.stopPropagation();var e=a(t.clientX>=0?t.clientX:t.touches[0].clientX),s=a(t.clientY>=0?t.clientY:t.touches[0].clientY);e-=n,s-=o,i.mouse_down_x=e,i.mouse_down_y=s,i.fx=e,i.fy=s,i.click=!0,t.touches&&t.touches.length>1&&(i.sx=t.touches[1].pageX,i.sy=t.touches[1].pageY),i.is_touching=!0},u=function(t){t.preventDefault(),t.stopPropagation();var o=t.deltaY;snot.setFov(snot.fov+.06*o)},d=function(t){t.preventDefault(),t.stopPropagation();var e=a(t.clientX>=0?t.clientX:t.changedTouches[0].pageX),r=a(t.clientY>=0?t.clientY:t.changedTouches[0].pageY);e-=n,r-=o,s(i.mouse_down_x,i.mouse_down_y,e,r)<5&&snot.controls.mouse_click(e,r),i.is_touching=!1}}(window);